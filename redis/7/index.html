<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis å…¨ç¬”è®° | DK&#39;s Notes</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/my-notes/img/logo.jpg">
    <link rel="stylesheet" href="/my-notes//at.alicdn.com/t/font_3334662_k54hl9700p.css">
    <link rel="stylesheet" href="/my-notes//at.alicdn.com/t/font_3334662_k54hl9700p.css">
    <link rel="stylesheet" href="/my-notes//at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <link rel="stylesheet" href="/my-notes//at.alicdn.com/t/font_3334691_b03dsaqrwck.css">
    <meta name="description" content="æ—¶ä¸æˆ‘å¾…ï¼Œèˆæˆ‘å…¶è°">
    <meta name="keywords" content="Java">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/my-notes/assets/css/0.styles.565c6041.css" as="style"><link rel="preload" href="/my-notes/assets/js/app.7f931ee0.js" as="script"><link rel="preload" href="/my-notes/assets/js/2.e52a17f8.js" as="script"><link rel="preload" href="/my-notes/assets/js/77.61eb4f51.js" as="script"><link rel="preload" href="/my-notes/assets/js/8.c2fa6f68.js" as="script"><link rel="preload" href="/my-notes/assets/js/6.bcc16901.js" as="script"><link rel="prefetch" href="/my-notes/assets/js/10.fee8f7ec.js"><link rel="prefetch" href="/my-notes/assets/js/100.9be19fac.js"><link rel="prefetch" href="/my-notes/assets/js/101.9aaae740.js"><link rel="prefetch" href="/my-notes/assets/js/102.a72c0165.js"><link rel="prefetch" href="/my-notes/assets/js/103.d47527c3.js"><link rel="prefetch" href="/my-notes/assets/js/104.d5bae560.js"><link rel="prefetch" href="/my-notes/assets/js/105.fdb07f67.js"><link rel="prefetch" href="/my-notes/assets/js/106.b89b7d37.js"><link rel="prefetch" href="/my-notes/assets/js/107.a9d142eb.js"><link rel="prefetch" href="/my-notes/assets/js/108.1b8c8817.js"><link rel="prefetch" href="/my-notes/assets/js/109.0cd465a0.js"><link rel="prefetch" href="/my-notes/assets/js/11.75b40e53.js"><link rel="prefetch" href="/my-notes/assets/js/110.4c56723c.js"><link rel="prefetch" href="/my-notes/assets/js/111.12b9cb85.js"><link rel="prefetch" href="/my-notes/assets/js/112.3f791546.js"><link rel="prefetch" href="/my-notes/assets/js/113.d9998b70.js"><link rel="prefetch" href="/my-notes/assets/js/114.faf0da70.js"><link rel="prefetch" href="/my-notes/assets/js/115.35d9b5f6.js"><link rel="prefetch" href="/my-notes/assets/js/116.13fbe1ab.js"><link rel="prefetch" href="/my-notes/assets/js/117.bffe4459.js"><link rel="prefetch" href="/my-notes/assets/js/118.eabefad3.js"><link rel="prefetch" href="/my-notes/assets/js/119.8593c8a5.js"><link rel="prefetch" href="/my-notes/assets/js/12.34db197a.js"><link rel="prefetch" href="/my-notes/assets/js/120.f5b73620.js"><link rel="prefetch" href="/my-notes/assets/js/121.d3137f51.js"><link rel="prefetch" href="/my-notes/assets/js/122.f47bca90.js"><link rel="prefetch" href="/my-notes/assets/js/123.6d846b88.js"><link rel="prefetch" href="/my-notes/assets/js/124.49825ebc.js"><link rel="prefetch" href="/my-notes/assets/js/125.6d3a9ce5.js"><link rel="prefetch" href="/my-notes/assets/js/126.eeef761b.js"><link rel="prefetch" href="/my-notes/assets/js/127.0f7e28c1.js"><link rel="prefetch" href="/my-notes/assets/js/128.4a35f42a.js"><link rel="prefetch" href="/my-notes/assets/js/129.e364bc33.js"><link rel="prefetch" href="/my-notes/assets/js/13.ab02aa59.js"><link rel="prefetch" href="/my-notes/assets/js/130.1299fc06.js"><link rel="prefetch" href="/my-notes/assets/js/131.61faa498.js"><link rel="prefetch" href="/my-notes/assets/js/132.9e46a3c4.js"><link rel="prefetch" href="/my-notes/assets/js/133.0b6e6f7f.js"><link rel="prefetch" href="/my-notes/assets/js/134.6724b7a7.js"><link rel="prefetch" href="/my-notes/assets/js/135.1d3daca0.js"><link rel="prefetch" href="/my-notes/assets/js/136.190f2a28.js"><link rel="prefetch" href="/my-notes/assets/js/137.5ce96397.js"><link rel="prefetch" href="/my-notes/assets/js/138.c0b55b02.js"><link rel="prefetch" href="/my-notes/assets/js/139.068ed7d7.js"><link rel="prefetch" href="/my-notes/assets/js/14.721e1994.js"><link rel="prefetch" href="/my-notes/assets/js/140.5226be4f.js"><link rel="prefetch" href="/my-notes/assets/js/141.196d1aa6.js"><link rel="prefetch" href="/my-notes/assets/js/142.11cbb52f.js"><link rel="prefetch" href="/my-notes/assets/js/143.509f8300.js"><link rel="prefetch" href="/my-notes/assets/js/144.436415bf.js"><link rel="prefetch" href="/my-notes/assets/js/145.a25cd8bc.js"><link rel="prefetch" href="/my-notes/assets/js/146.a2d1d780.js"><link rel="prefetch" href="/my-notes/assets/js/147.1cac4e0a.js"><link rel="prefetch" href="/my-notes/assets/js/148.5c361eba.js"><link rel="prefetch" href="/my-notes/assets/js/149.f62eacfa.js"><link rel="prefetch" href="/my-notes/assets/js/15.35ef567c.js"><link rel="prefetch" href="/my-notes/assets/js/150.80b0aa20.js"><link rel="prefetch" href="/my-notes/assets/js/151.6f0e31d8.js"><link rel="prefetch" href="/my-notes/assets/js/152.86efa86d.js"><link rel="prefetch" href="/my-notes/assets/js/153.d6605e26.js"><link rel="prefetch" href="/my-notes/assets/js/154.e5b33cc7.js"><link rel="prefetch" href="/my-notes/assets/js/155.5d3cf278.js"><link rel="prefetch" href="/my-notes/assets/js/156.bcb9784f.js"><link rel="prefetch" href="/my-notes/assets/js/157.ca3b8e8c.js"><link rel="prefetch" href="/my-notes/assets/js/158.eb0116b8.js"><link rel="prefetch" href="/my-notes/assets/js/159.309a26da.js"><link rel="prefetch" href="/my-notes/assets/js/16.ca698d39.js"><link rel="prefetch" href="/my-notes/assets/js/160.ce6e9321.js"><link rel="prefetch" href="/my-notes/assets/js/161.ac24f13a.js"><link rel="prefetch" href="/my-notes/assets/js/162.c3390211.js"><link rel="prefetch" href="/my-notes/assets/js/163.8267154f.js"><link rel="prefetch" href="/my-notes/assets/js/164.3ce822f9.js"><link rel="prefetch" href="/my-notes/assets/js/165.80836bd1.js"><link rel="prefetch" href="/my-notes/assets/js/166.7346e59a.js"><link rel="prefetch" href="/my-notes/assets/js/167.5577b6af.js"><link rel="prefetch" href="/my-notes/assets/js/168.23aca72c.js"><link rel="prefetch" href="/my-notes/assets/js/169.ce891665.js"><link rel="prefetch" href="/my-notes/assets/js/17.549cfc80.js"><link rel="prefetch" href="/my-notes/assets/js/170.b4aebdaf.js"><link rel="prefetch" href="/my-notes/assets/js/171.39cdd90b.js"><link rel="prefetch" href="/my-notes/assets/js/172.06cd5671.js"><link rel="prefetch" href="/my-notes/assets/js/173.44c7c161.js"><link rel="prefetch" href="/my-notes/assets/js/174.62d8a34f.js"><link rel="prefetch" href="/my-notes/assets/js/175.baa645ac.js"><link rel="prefetch" href="/my-notes/assets/js/176.8361f852.js"><link rel="prefetch" href="/my-notes/assets/js/177.4a8f2fec.js"><link rel="prefetch" href="/my-notes/assets/js/178.f594def6.js"><link rel="prefetch" href="/my-notes/assets/js/179.2338f129.js"><link rel="prefetch" href="/my-notes/assets/js/18.a8b4f826.js"><link rel="prefetch" href="/my-notes/assets/js/180.1b2f62df.js"><link rel="prefetch" href="/my-notes/assets/js/181.10759f41.js"><link rel="prefetch" href="/my-notes/assets/js/182.c0e1c3c5.js"><link rel="prefetch" href="/my-notes/assets/js/183.bdc8283f.js"><link rel="prefetch" href="/my-notes/assets/js/184.30a6f685.js"><link rel="prefetch" href="/my-notes/assets/js/185.1949079b.js"><link rel="prefetch" href="/my-notes/assets/js/186.bb7c7093.js"><link rel="prefetch" href="/my-notes/assets/js/187.1d02d132.js"><link rel="prefetch" href="/my-notes/assets/js/188.5230fbeb.js"><link rel="prefetch" href="/my-notes/assets/js/189.2931d469.js"><link rel="prefetch" href="/my-notes/assets/js/19.16e1a44c.js"><link rel="prefetch" href="/my-notes/assets/js/190.9bd3b616.js"><link rel="prefetch" href="/my-notes/assets/js/191.d75de9d3.js"><link rel="prefetch" href="/my-notes/assets/js/192.dacb160e.js"><link rel="prefetch" href="/my-notes/assets/js/193.660b4fce.js"><link rel="prefetch" href="/my-notes/assets/js/194.45f8499e.js"><link rel="prefetch" href="/my-notes/assets/js/195.e91d4663.js"><link rel="prefetch" href="/my-notes/assets/js/196.e94176ac.js"><link rel="prefetch" href="/my-notes/assets/js/197.5acbb43f.js"><link rel="prefetch" href="/my-notes/assets/js/198.dc1a1207.js"><link rel="prefetch" href="/my-notes/assets/js/199.288adcec.js"><link rel="prefetch" href="/my-notes/assets/js/20.b19ef4b2.js"><link rel="prefetch" href="/my-notes/assets/js/200.3d318d2e.js"><link rel="prefetch" href="/my-notes/assets/js/21.e3682738.js"><link rel="prefetch" href="/my-notes/assets/js/22.fafa8b54.js"><link rel="prefetch" href="/my-notes/assets/js/23.9d683b40.js"><link rel="prefetch" href="/my-notes/assets/js/24.02c0c08c.js"><link rel="prefetch" href="/my-notes/assets/js/25.af427f02.js"><link rel="prefetch" href="/my-notes/assets/js/26.50a41828.js"><link rel="prefetch" href="/my-notes/assets/js/27.8f1d2fe6.js"><link rel="prefetch" href="/my-notes/assets/js/28.7f820229.js"><link rel="prefetch" href="/my-notes/assets/js/29.208cdce3.js"><link rel="prefetch" href="/my-notes/assets/js/3.32ea0d41.js"><link rel="prefetch" href="/my-notes/assets/js/30.e7a171d3.js"><link rel="prefetch" href="/my-notes/assets/js/31.8ee9f363.js"><link rel="prefetch" href="/my-notes/assets/js/32.b33ae00e.js"><link rel="prefetch" href="/my-notes/assets/js/33.3a961845.js"><link rel="prefetch" href="/my-notes/assets/js/34.46f30eb6.js"><link rel="prefetch" href="/my-notes/assets/js/35.dedda1f7.js"><link rel="prefetch" href="/my-notes/assets/js/36.fb63ded5.js"><link rel="prefetch" href="/my-notes/assets/js/37.321340a9.js"><link rel="prefetch" href="/my-notes/assets/js/38.c21281dd.js"><link rel="prefetch" href="/my-notes/assets/js/39.01776b7e.js"><link rel="prefetch" href="/my-notes/assets/js/4.2466bf2a.js"><link rel="prefetch" href="/my-notes/assets/js/40.c6763f18.js"><link rel="prefetch" href="/my-notes/assets/js/41.afa4c2f3.js"><link rel="prefetch" href="/my-notes/assets/js/42.187357b5.js"><link rel="prefetch" href="/my-notes/assets/js/43.90030eae.js"><link rel="prefetch" href="/my-notes/assets/js/44.e11eff59.js"><link rel="prefetch" href="/my-notes/assets/js/45.760e3e3f.js"><link rel="prefetch" href="/my-notes/assets/js/46.0eccc1a4.js"><link rel="prefetch" href="/my-notes/assets/js/47.30e063f8.js"><link rel="prefetch" href="/my-notes/assets/js/48.5ab681d2.js"><link rel="prefetch" href="/my-notes/assets/js/49.5921c987.js"><link rel="prefetch" href="/my-notes/assets/js/5.56264475.js"><link rel="prefetch" href="/my-notes/assets/js/50.a53fa873.js"><link rel="prefetch" href="/my-notes/assets/js/51.5cded08c.js"><link rel="prefetch" href="/my-notes/assets/js/52.8960c473.js"><link rel="prefetch" href="/my-notes/assets/js/53.2ac21c0e.js"><link rel="prefetch" href="/my-notes/assets/js/54.361bc2f3.js"><link rel="prefetch" href="/my-notes/assets/js/55.3853b7f3.js"><link rel="prefetch" href="/my-notes/assets/js/56.754a3b4c.js"><link rel="prefetch" href="/my-notes/assets/js/57.1d9684e7.js"><link rel="prefetch" href="/my-notes/assets/js/58.0e7f2b60.js"><link rel="prefetch" href="/my-notes/assets/js/59.b37ab2f4.js"><link rel="prefetch" href="/my-notes/assets/js/60.f31d0aea.js"><link rel="prefetch" href="/my-notes/assets/js/61.5aebeb50.js"><link rel="prefetch" href="/my-notes/assets/js/62.cebf26d6.js"><link rel="prefetch" href="/my-notes/assets/js/63.6c7932ca.js"><link rel="prefetch" href="/my-notes/assets/js/64.cad8a013.js"><link rel="prefetch" href="/my-notes/assets/js/65.25e4c14e.js"><link rel="prefetch" href="/my-notes/assets/js/66.e9c81af6.js"><link rel="prefetch" href="/my-notes/assets/js/67.31cbef00.js"><link rel="prefetch" href="/my-notes/assets/js/68.edc93332.js"><link rel="prefetch" href="/my-notes/assets/js/69.5eaf1e4f.js"><link rel="prefetch" href="/my-notes/assets/js/7.5a6eeb6c.js"><link rel="prefetch" href="/my-notes/assets/js/70.7114cd64.js"><link rel="prefetch" href="/my-notes/assets/js/71.2066867c.js"><link rel="prefetch" href="/my-notes/assets/js/72.0f93cb73.js"><link rel="prefetch" href="/my-notes/assets/js/73.6c4d69ec.js"><link rel="prefetch" href="/my-notes/assets/js/74.0a91fc3c.js"><link rel="prefetch" href="/my-notes/assets/js/75.47e45f38.js"><link rel="prefetch" href="/my-notes/assets/js/76.99886a8d.js"><link rel="prefetch" href="/my-notes/assets/js/78.eff53df7.js"><link rel="prefetch" href="/my-notes/assets/js/79.e5d77573.js"><link rel="prefetch" href="/my-notes/assets/js/80.8ac4e931.js"><link rel="prefetch" href="/my-notes/assets/js/81.82416621.js"><link rel="prefetch" href="/my-notes/assets/js/82.b7cea701.js"><link rel="prefetch" href="/my-notes/assets/js/83.eb0065f7.js"><link rel="prefetch" href="/my-notes/assets/js/84.45596ac9.js"><link rel="prefetch" href="/my-notes/assets/js/85.73902eef.js"><link rel="prefetch" href="/my-notes/assets/js/86.05a157f2.js"><link rel="prefetch" href="/my-notes/assets/js/87.83218f21.js"><link rel="prefetch" href="/my-notes/assets/js/88.bf05ee49.js"><link rel="prefetch" href="/my-notes/assets/js/89.089b5c96.js"><link rel="prefetch" href="/my-notes/assets/js/9.4a5b4024.js"><link rel="prefetch" href="/my-notes/assets/js/90.dc0b55a6.js"><link rel="prefetch" href="/my-notes/assets/js/91.ddc7da4f.js"><link rel="prefetch" href="/my-notes/assets/js/92.2b5c7d5f.js"><link rel="prefetch" href="/my-notes/assets/js/93.934a02e9.js"><link rel="prefetch" href="/my-notes/assets/js/94.3a6ede23.js"><link rel="prefetch" href="/my-notes/assets/js/95.0e946220.js"><link rel="prefetch" href="/my-notes/assets/js/96.3861fb05.js"><link rel="prefetch" href="/my-notes/assets/js/97.8627cefa.js"><link rel="prefetch" href="/my-notes/assets/js/98.6e0ee750.js"><link rel="prefetch" href="/my-notes/assets/js/99.5df99b25.js">
    <link rel="stylesheet" href="/my-notes/assets/css/0.styles.565c6041.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-notes/" class="home-link router-link-active"><img src="/my-notes/img/logo.jpg" alt="DK's Notes" class="logo"> <span class="site-name can-hide">DK's Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-notes/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/my-notes/about/website/tools/" class="nav-link">å¯¼èˆªç«™</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/my-notes/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java-Se</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/java/se/base/" class="nav-link">JavaåŸºç¡€</a></li></ul></li><li class="dropdown-item"><h4>Java-Seè¿›é˜¶-å¤šçº¿ç¨‹</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/java/se/thread/" class="nav-link">å¤šçº¿ç¨‹</a></li></ul></li><li class="dropdown-item"><h4>Java-Seè¿›é˜¶-java8æ–°ç‰¹æ€§</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/java/se/java8/" class="nav-link">java8æ–°ç‰¹æ€§</a></li></ul></li><li class="dropdown-item"><h4>Java-ee</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/javaweb/" class="nav-link">JavaWeb</a></li></ul></li><li class="dropdown-item"><h4>Javaè™šæ‹Ÿæœº</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/JVM/" class="nav-link">JVM</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ•°æ®åº“" class="dropdown-title"><a href="/my-notes/mysql/" class="link-title">æ•°æ®åº“</a> <span class="title" style="display:none;">æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>SQL æ•°æ®åº“</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/mysql/" class="nav-link">MySQL</a></li></ul></li><li class="dropdown-item"><h4>NoSQL æ•°æ®åº“</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/redis/" class="nav-link router-link-active">Redis</a></li><li class="dropdown-subitem"><a href="/my-notes/es/" class="nav-link">ElasticSearch</a></li><li class="dropdown-subitem"><a href="/my-notes/mongodb/" class="nav-link">MongoDB</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ¡†æ¶" class="dropdown-title"><a href="/my-notes/mybatis/study-note/" class="link-title">æ¡†æ¶</a> <span class="title" style="display:none;">æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>ORM</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/mybatis/study-note/" class="nav-link">MyBatis</a></li><li class="dropdown-subitem"><a href="/my-notes/mybatis-plus/study-note/" class="nav-link">MyBatis-Plus</a></li></ul></li><li class="dropdown-item"><h4>Spring</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/Spring/study-note/" class="nav-link">Spring</a></li></ul></li><li class="dropdown-item"><h4>SpringMVC</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/SpringMvc/study-note/1/" class="nav-link">SpringMVC1</a></li><li class="dropdown-subitem"><a href="/my-notes/SpringMvc/study-note/2/" class="nav-link">SpringMVC2</a></li></ul></li><li class="dropdown-item"><h4>SpringCloud</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/SpringCloud/" class="nav-link">SpringCloud</a></li></ul></li><li class="dropdown-item"><h4>ä¸­é—´ä»¶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/rabbitmq/" class="nav-link">RabbitMQ</a></li><li class="dropdown-subitem"><a href="/my-notes/dubbo/" class="nav-link">Dubbo</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¡¹ç›®" class="dropdown-title"><a href="/my-notes/project/seckill/" class="link-title">é¡¹ç›®</a> <span class="title" style="display:none;">é¡¹ç›®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-notes/project/seckill/" class="nav-link">ç§’æ€é¡¹ç›®</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å·¥å…·|éƒ¨ç½²" class="dropdown-title"><a href="/my-notes/git/" class="link-title">å·¥å…·|éƒ¨ç½²</a> <span class="title" style="display:none;">å·¥å…·|éƒ¨ç½²</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-notes/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/my-notes/Linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/my-notes/Docker/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/my-notes/JWT/note/" class="nav-link">JWT</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¢è¯•|åˆ·é¢˜" class="dropdown-title"><a href="/my-notes/work/interview/" class="link-title">é¢è¯•|åˆ·é¢˜</a> <span class="title" style="display:none;">é¢è¯•|åˆ·é¢˜</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-notes/work/interview/" class="nav-link">é¢è¯•</a></li><li class="dropdown-item"><!----> <a href="/my-notes/work/algorithm/" class="nav-link">åˆ·é¢˜</a></li></ul></div></div><div class="nav-item"><a href="/my-notes/dev/question/" class="nav-link">å¼€å‘é—®é¢˜ğŸ˜ˆ</a></div><div class="nav-item"><a href="/my-notes/designPattern/" class="nav-link">è®¾è®¡æ¨¡å¼</a></div><div class="nav-item"><a href="/my-notes/about/" class="nav-link">å…³äºğŸ’•</a></div><div class="nav-item"><a href="/my-notes/archives/" class="nav-link">å½’æ¡£ğŸ•›</a></div> <a href="https://github.com/hnistzdk/my-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.jpg"> <div class="blogger-info"><h3>é£</h3> <span>æ‘¸é±¼</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/my-notes/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/my-notes/about/website/tools/" class="nav-link">å¯¼èˆªç«™</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/my-notes/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java-Se</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/java/se/base/" class="nav-link">JavaåŸºç¡€</a></li></ul></li><li class="dropdown-item"><h4>Java-Seè¿›é˜¶-å¤šçº¿ç¨‹</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/java/se/thread/" class="nav-link">å¤šçº¿ç¨‹</a></li></ul></li><li class="dropdown-item"><h4>Java-Seè¿›é˜¶-java8æ–°ç‰¹æ€§</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/java/se/java8/" class="nav-link">java8æ–°ç‰¹æ€§</a></li></ul></li><li class="dropdown-item"><h4>Java-ee</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/javaweb/" class="nav-link">JavaWeb</a></li></ul></li><li class="dropdown-item"><h4>Javaè™šæ‹Ÿæœº</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/JVM/" class="nav-link">JVM</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ•°æ®åº“" class="dropdown-title"><a href="/my-notes/mysql/" class="link-title">æ•°æ®åº“</a> <span class="title" style="display:none;">æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>SQL æ•°æ®åº“</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/mysql/" class="nav-link">MySQL</a></li></ul></li><li class="dropdown-item"><h4>NoSQL æ•°æ®åº“</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/redis/" class="nav-link router-link-active">Redis</a></li><li class="dropdown-subitem"><a href="/my-notes/es/" class="nav-link">ElasticSearch</a></li><li class="dropdown-subitem"><a href="/my-notes/mongodb/" class="nav-link">MongoDB</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ¡†æ¶" class="dropdown-title"><a href="/my-notes/mybatis/study-note/" class="link-title">æ¡†æ¶</a> <span class="title" style="display:none;">æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>ORM</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/mybatis/study-note/" class="nav-link">MyBatis</a></li><li class="dropdown-subitem"><a href="/my-notes/mybatis-plus/study-note/" class="nav-link">MyBatis-Plus</a></li></ul></li><li class="dropdown-item"><h4>Spring</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/Spring/study-note/" class="nav-link">Spring</a></li></ul></li><li class="dropdown-item"><h4>SpringMVC</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/SpringMvc/study-note/1/" class="nav-link">SpringMVC1</a></li><li class="dropdown-subitem"><a href="/my-notes/SpringMvc/study-note/2/" class="nav-link">SpringMVC2</a></li></ul></li><li class="dropdown-item"><h4>SpringCloud</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/SpringCloud/" class="nav-link">SpringCloud</a></li></ul></li><li class="dropdown-item"><h4>ä¸­é—´ä»¶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/rabbitmq/" class="nav-link">RabbitMQ</a></li><li class="dropdown-subitem"><a href="/my-notes/dubbo/" class="nav-link">Dubbo</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¡¹ç›®" class="dropdown-title"><a href="/my-notes/project/seckill/" class="link-title">é¡¹ç›®</a> <span class="title" style="display:none;">é¡¹ç›®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-notes/project/seckill/" class="nav-link">ç§’æ€é¡¹ç›®</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å·¥å…·|éƒ¨ç½²" class="dropdown-title"><a href="/my-notes/git/" class="link-title">å·¥å…·|éƒ¨ç½²</a> <span class="title" style="display:none;">å·¥å…·|éƒ¨ç½²</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-notes/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/my-notes/Linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/my-notes/Docker/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/my-notes/JWT/note/" class="nav-link">JWT</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¢è¯•|åˆ·é¢˜" class="dropdown-title"><a href="/my-notes/work/interview/" class="link-title">é¢è¯•|åˆ·é¢˜</a> <span class="title" style="display:none;">é¢è¯•|åˆ·é¢˜</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-notes/work/interview/" class="nav-link">é¢è¯•</a></li><li class="dropdown-item"><!----> <a href="/my-notes/work/algorithm/" class="nav-link">åˆ·é¢˜</a></li></ul></div></div><div class="nav-item"><a href="/my-notes/dev/question/" class="nav-link">å¼€å‘é—®é¢˜ğŸ˜ˆ</a></div><div class="nav-item"><a href="/my-notes/designPattern/" class="nav-link">è®¾è®¡æ¨¡å¼</a></div><div class="nav-item"><a href="/my-notes/about/" class="nav-link">å…³äºğŸ’•</a></div><div class="nav-item"><a href="/my-notes/archives/" class="nav-link">å½’æ¡£ğŸ•›</a></div> <a href="https://github.com/hnistzdk/my-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MySQL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Redis</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-notes/redis/" aria-current="page" class="sidebar-link">Redis - çŸ¥è¯†ä½“ç³»</a></li><li><a href="/my-notes/redis/7/" aria-current="page" class="active sidebar-link">Redis å…¨ç¬”è®°</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/my-notes/redis/7/#redisè®°å½•" class="sidebar-link">Redisè®°å½•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#æ¦‚è¿°" class="sidebar-link">æ¦‚è¿°</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#å®‰è£…redis" class="sidebar-link">å®‰è£…Redis</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#redisé…ç½®å…è®¸è¿œç¨‹è®¿é—®" class="sidebar-link">Redisé…ç½®å…è®¸è¿œç¨‹è®¿é—®</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#å…¶ä»–çš„redisé…ç½®" class="sidebar-link">å…¶ä»–çš„Redisé…ç½®</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#è¿æ¥å®¢æˆ·ç«¯" class="sidebar-link">è¿æ¥å®¢æˆ·ç«¯</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#è®¾ç½®rediså¼€æœºå¯åŠ¨" class="sidebar-link">è®¾ç½®rediså¼€æœºå¯åŠ¨</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#ç”¨é€”ä¸¾ä¾‹" class="sidebar-link">ç”¨é€”ä¸¾ä¾‹</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#redisé”®-key" class="sidebar-link">Redisé”®(key)</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#åŸå­æ€§" class="sidebar-link">åŸå­æ€§</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#string" class="sidebar-link">String</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#åŸºæœ¬å‘½ä»¤" class="sidebar-link">åŸºæœ¬å‘½ä»¤</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#stringçš„æ•°æ®ç»“æ„" class="sidebar-link">Stringçš„æ•°æ®ç»“æ„</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#ç›¸å¯¹äºä½¿ç”¨cè¯­è¨€åŸæœ¬çš„char-çš„å­—ç¬¦ä¸²æœ‰ä»€ä¹ˆå¥½å¤„" class="sidebar-link">ç›¸å¯¹äºä½¿ç”¨Cè¯­è¨€åŸæœ¬çš„char[]çš„å­—ç¬¦ä¸²æœ‰ä»€ä¹ˆå¥½å¤„</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#list" class="sidebar-link">List</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#æ¦‚è¿°-2" class="sidebar-link">æ¦‚è¿°</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#å¸¸ç”¨å‘½ä»¤" class="sidebar-link">å¸¸ç”¨å‘½ä»¤</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#listçš„æ•°æ®ç»“æ„" class="sidebar-link">Listçš„æ•°æ®ç»“æ„</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#ä½œä¸ºliståº•å±‚å®ç°ä¹‹ä¸€çš„å‹ç¼©åˆ—è¡¨" class="sidebar-link">ä½œä¸ºListåº•å±‚å®ç°ä¹‹ä¸€çš„å‹ç¼©åˆ—è¡¨</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#set" class="sidebar-link">Set</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#æ¦‚è¿°-3" class="sidebar-link">æ¦‚è¿°</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#å¸¸ç”¨å‘½ä»¤-2" class="sidebar-link">å¸¸ç”¨å‘½ä»¤</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#setçš„æ•°æ®ç»“æ„" class="sidebar-link">setçš„æ•°æ®ç»“æ„</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#æœ‰åºé›†åˆzset" class="sidebar-link">æœ‰åºé›†åˆzset</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#æ¦‚è¿°-4" class="sidebar-link">æ¦‚è¿°</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#å¸¸ç”¨å‘½ä»¤-3" class="sidebar-link">å¸¸ç”¨å‘½ä»¤</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#æ•°æ®ç»“æ„" class="sidebar-link">æ•°æ®ç»“æ„</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#æœ‰åºé›†åˆzsetåº•å±‚å®ç°ä¹‹è·³è·ƒè¡¨" class="sidebar-link">æœ‰åºé›†åˆzsetåº•å±‚å®ç°ä¹‹è·³è·ƒè¡¨</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#hash" class="sidebar-link">hash</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#åº•å±‚ç»“æ„" class="sidebar-link">åº•å±‚ç»“æ„</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#redisé…ç½®æ–‡ä»¶è¯¦è§£" class="sidebar-link">Redisé…ç½®æ–‡ä»¶è¯¦è§£</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#redisæ–°æ•°æ®ç±»å‹" class="sidebar-link">Redisæ–°æ•°æ®ç±»å‹</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#bitmaps" class="sidebar-link">Bitmaps</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#hyperloglog" class="sidebar-link">HyperLogLog</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#geospatial" class="sidebar-link">Geospatial</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#jedisè®¿é—®redisæ­¥éª¤" class="sidebar-link">jedisè®¿é—®redisæ­¥éª¤</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#redisäº‹åŠ¡" class="sidebar-link">redisäº‹åŠ¡</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#äº‹åŠ¡ä¸æ‰§è¡Œçš„æƒ…å†µ" class="sidebar-link">äº‹åŠ¡ä¸æ‰§è¡Œçš„æƒ…å†µ</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#ä¹è§‚é”å®ç°ç§’æ€ç³»ç»Ÿ" class="sidebar-link">ä¹è§‚é”å®ç°ç§’æ€ç³»ç»Ÿ</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#rediså®ç°ä¹è§‚é”" class="sidebar-link">rediså®ç°ä¹è§‚é”</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#springbootæ•´åˆredis" class="sidebar-link">SpringBootæ•´åˆRedis</a></li><li class="sidebar-sub-header level5"><a href="/my-notes/redis/7/#ç¼–å†™redisé…ç½®ç±»-å¯¹key-valueè¿›è¡Œåºåˆ—åŒ–-å®ä½“ç±»éœ€å®ç°serializableæ¥å£" class="sidebar-link">ç¼–å†™redisé…ç½®ç±»,å¯¹key valueè¿›è¡Œåºåˆ—åŒ–(å®ä½“ç±»éœ€å®ç°Serializableæ¥å£)</a></li><li class="sidebar-sub-header level5"><a href="/my-notes/redis/7/#ç¼–å†™rediså¸¸ç”¨æ“ä½œå·¥å…·ç±»" class="sidebar-link">ç¼–å†™rediså¸¸ç”¨æ“ä½œå·¥å…·ç±»</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#rediså„ç§æ•°æ®ç»“æ„ä½¿ç”¨åœºæ™¯æ€»ç»“" class="sidebar-link">rediså„ç§æ•°æ®ç»“æ„ä½¿ç”¨åœºæ™¯æ€»ç»“</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#redisæŒä¹…åŒ–" class="sidebar-link">redisæŒä¹…åŒ–</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/7/#redisçš„å‘å¸ƒå’Œè®¢é˜…" class="sidebar-link">Redisçš„å‘å¸ƒå’Œè®¢é˜…</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#ä»€ä¹ˆæ˜¯å‘å¸ƒå’Œè®¢é˜…" class="sidebar-link">ä»€ä¹ˆæ˜¯å‘å¸ƒå’Œè®¢é˜…</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/7/#å‘å¸ƒè®¢é˜…å‘½ä»¤è¡Œå®ç°-å¹¿å‘ç”¨äºæ„å»ºå³æ—¶é€šä¿¡åº”ç”¨-å¦‚ç½‘ç»œèŠå¤©å®¤-chatroom-å’Œå®æ—¶å¹¿æ’­ã€å®æ—¶æé†’ç­‰" class="sidebar-link">å‘å¸ƒè®¢é˜…å‘½ä»¤è¡Œå®ç°(å¹¿å‘ç”¨äºæ„å»ºå³æ—¶é€šä¿¡åº”ç”¨ï¼Œå¦‚ç½‘ç»œèŠå¤©å®¤(chatroom)å’Œå®æ—¶å¹¿æ’­ã€å®æ—¶æé†’ç­‰)</a></li></ul></li></ul></li><li><a href="/my-notes/redis/1/" class="sidebar-link">Redis - æ¦‚å¿µå’ŒåŸºç¡€</a></li><li><a href="/my-notes/redis/2/" class="sidebar-link">Redis - äº”å¤§æ•°æ®ç±»å‹</a></li><li><a href="/my-notes/redis/3/" class="sidebar-link">Redis - ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹</a></li><li><a href="/my-notes/redis/4/" class="sidebar-link">Redis - äº‹åŠ¡</a></li><li><a href="/my-notes/redis/5/" class="sidebar-link">Redis - Java</a></li><li><a href="/my-notes/redis/6/" class="sidebar-link">Redis - é«˜çº§</a></li><li><a href="/my-notes/redis/persistence/" class="sidebar-link">RedisæŒä¹…åŒ–æœºåˆ¶</a></li><li><a href="/my-notes/redis/masterSlave/" class="sidebar-link">Redisé›†ç¾¤:ä¸»ä»æ¨¡å¼</a></li><li><a href="/my-notes/redis/sentinel/" class="sidebar-link">Redisé«˜å¯ç”¨-å“¨å…µæœºåˆ¶</a></li><li><a href="/my-notes/Redis/transaction/" class="sidebar-link">Redisäº‹åŠ¡æœºåˆ¶</a></li><li><a href="/my-notes/Redis/ttl-disuse-Strategy/" class="sidebar-link">Redisè¿‡æœŸæ¸…é™¤ç­–ç•¥å’Œå†…å­˜æ·˜æ±°æœºåˆ¶</a></li><li><a href="/my-notes/Redis/cacheConsistency/" class="sidebar-link">ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜</a></li><li><a href="/my-notes/Redis/distributedLock/" class="sidebar-link">rediså’Œzookeeperåˆ†å¸ƒå¼é”</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ElasticSearch</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MongoDB</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/my-notes/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/my-notes/categories/?category=%E6%95%B0%E6%8D%AE%E5%BA%93" title="åˆ†ç±»" data-v-06225672>æ•°æ®åº“</a></li><li data-v-06225672><a href="/my-notes/categories/?category=Redis" title="åˆ†ç±»" data-v-06225672>Redis</a></li></ul> <div class="info" data-v-06225672><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-06225672><a href="https://www.zaiolos.top/" target="_blank" title="ä½œè€…" class="beLink" data-v-06225672>zdk</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-01-06</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Redis å…¨ç¬”è®°<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p><strong>Table of Contents</strong> <em>generated with <a href="https://github.com/thlorenz/doctoc" target="_blank" rel="noopener noreferrer">DocToc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></em></p> <ul><li><a href="#redis%E8%AE%B0%E5%BD%95">Redisè®°å½•</a> <ul><li><a href="#%E6%A6%82%E8%BF%B0">æ¦‚è¿°</a></li> <li><a href="#%E5%AE%89%E8%A3%85redis">å®‰è£…Redis</a></li> <li><a href="#redis%E9%85%8D%E7%BD%AE%E5%85%81%E8%AE%B8%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE">Redisé…ç½®å…è®¸è¿œç¨‹è®¿é—®</a></li> <li><a href="#%E5%85%B6%E4%BB%96%E7%9A%84redis%E9%85%8D%E7%BD%AE">å…¶ä»–çš„Redisé…ç½®</a> <ul><li><a href="#%E8%BF%9E%E6%8E%A5%E5%AE%A2%E6%88%B7%E7%AB%AF">è¿æ¥å®¢æˆ·ç«¯</a></li> <li><a href="#%E8%AE%BE%E7%BD%AEredis%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8">è®¾ç½®rediså¼€æœºå¯åŠ¨</a></li> <li><a href="#%E7%94%A8%E9%80%94%E4%B8%BE%E4%BE%8B">ç”¨é€”ä¸¾ä¾‹</a></li></ul></li> <li><a href="#redis%E9%94%AEkey">Redisé”®(key)</a></li> <li><a href="#%E5%8E%9F%E5%AD%90%E6%80%A7">åŸå­æ€§</a></li> <li><a href="#string">String</a> <ul><li><a href="#%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4">åŸºæœ¬å‘½ä»¤</a></li> <li><a href="#string%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84">Stringçš„æ•°æ®ç»“æ„</a></li> <li><a href="#%E7%9B%B8%E5%AF%B9%E4%BA%8E%E4%BD%BF%E7%94%A8c%E8%AF%AD%E8%A8%80%E5%8E%9F%E6%9C%AC%E7%9A%84char%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9C%89%E4%BB%80%E4%B9%88%E5%A5%BD%E5%A4%84">ç›¸å¯¹äºä½¿ç”¨Cè¯­è¨€åŸæœ¬çš„char[]çš„å­—ç¬¦ä¸²æœ‰ä»€ä¹ˆå¥½å¤„</a></li></ul></li> <li><a href="#list">List</a> <ul><li><a href="#%E6%A6%82%E8%BF%B0-1">æ¦‚è¿°</a></li> <li><a href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4">å¸¸ç”¨å‘½ä»¤</a></li> <li><a href="#list%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84">Listçš„æ•°æ®ç»“æ„</a></li> <li><a href="#%E4%BD%9C%E4%B8%BAlist%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E4%B9%8B%E4%B8%80%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%88%97%E8%A1%A8">ä½œä¸ºListåº•å±‚å®ç°ä¹‹ä¸€çš„å‹ç¼©åˆ—è¡¨</a></li></ul></li> <li><a href="#set">Set</a> <ul><li><a href="#%E6%A6%82%E8%BF%B0-2">æ¦‚è¿°</a></li> <li><a href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4-1">å¸¸ç”¨å‘½ä»¤</a></li> <li><a href="#set%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84">setçš„æ•°æ®ç»“æ„</a></li></ul></li> <li><a href="#%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88zset">æœ‰åºé›†åˆzset</a> <ul><li><a href="#%E6%A6%82%E8%BF%B0-3">æ¦‚è¿°</a></li> <li><a href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4-2">å¸¸ç”¨å‘½ä»¤</a></li> <li><a href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84">æ•°æ®ç»“æ„</a></li> <li><a href="#%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88zset%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E4%B9%8B%E8%B7%B3%E8%B7%83%E8%A1%A8">æœ‰åºé›†åˆzsetåº•å±‚å®ç°ä¹‹è·³è·ƒè¡¨</a></li></ul></li> <li><a href="#hash">hash</a> <ul><li><a href="#%E5%BA%95%E5%B1%82%E7%BB%93%E6%9E%84">åº•å±‚ç»“æ„</a></li></ul></li> <li><a href="#redis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3">Redisé…ç½®æ–‡ä»¶è¯¦è§£</a></li> <li><a href="#redis%E6%96%B0%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">Redisæ–°æ•°æ®ç±»å‹</a> <ul><li><a href="#bitmaps">Bitmaps</a></li> <li><a href="#hyperloglog">HyperLogLog</a></li> <li><a href="#geospatial">Geospatial</a></li></ul></li> <li><a href="#jedis%E8%AE%BF%E9%97%AEredis%E6%AD%A5%E9%AA%A4">jedisè®¿é—®redisæ­¥éª¤</a></li> <li><a href="#redis%E4%BA%8B%E5%8A%A1">redisäº‹åŠ¡</a> <ul><li><a href="#%E4%BA%8B%E5%8A%A1%E4%B8%8D%E6%89%A7%E8%A1%8C%E7%9A%84%E6%83%85%E5%86%B5">äº‹åŠ¡ä¸æ‰§è¡Œçš„æƒ…å†µ</a></li> <li><a href="#%E4%B9%90%E8%A7%82%E9%94%81%E5%AE%9E%E7%8E%B0%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F">ä¹è§‚é”å®ç°ç§’æ€ç³»ç»Ÿ</a></li> <li><a href="#redis%E5%AE%9E%E7%8E%B0%E4%B9%90%E8%A7%82%E9%94%81">rediså®ç°ä¹è§‚é”</a></li> <li><a href="#springboot%E6%95%B4%E5%90%88redis">SpringBootæ•´åˆRedis</a> <ul><li><a href="#%E7%BC%96%E5%86%99redis%E9%85%8D%E7%BD%AE%E7%B1%BB%E5%AF%B9key-value%E8%BF%9B%E8%A1%8C%E5%BA%8F%E5%88%97%E5%8C%96%E5%AE%9E%E4%BD%93%E7%B1%BB%E9%9C%80%E5%AE%9E%E7%8E%B0serializable%E6%8E%A5%E5%8F%A3">ç¼–å†™redisé…ç½®ç±»,å¯¹key valueè¿›è¡Œåºåˆ—åŒ–(å®ä½“ç±»éœ€å®ç°Serializableæ¥å£)</a></li> <li><a href="#%E7%BC%96%E5%86%99redis%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E5%B7%A5%E5%85%B7%E7%B1%BB">ç¼–å†™rediså¸¸ç”¨æ“ä½œå·¥å…·ç±»</a></li></ul></li> <li><a href="#redis%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E6%80%BB%E7%BB%93">rediså„ç§æ•°æ®ç»“æ„ä½¿ç”¨åœºæ™¯æ€»ç»“</a></li> <li><a href="#redis%E6%8C%81%E4%B9%85%E5%8C%96">redisæŒä¹…åŒ–</a></li></ul></li> <li><a href="#redis%E7%9A%84%E5%8F%91%E5%B8%83%E5%92%8C%E8%AE%A2%E9%98%85">Redisçš„å‘å¸ƒå’Œè®¢é˜…</a> <ul><li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%8F%91%E5%B8%83%E5%92%8C%E8%AE%A2%E9%98%85">ä»€ä¹ˆæ˜¯å‘å¸ƒå’Œè®¢é˜…</a></li> <li><a href="#%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%AE%9E%E7%8E%B0%E5%B9%BF%E5%8F%91%E7%94%A8%E4%BA%8E%E6%9E%84%E5%BB%BA%E5%8D%B3%E6%97%B6%E9%80%9A%E4%BF%A1%E5%BA%94%E7%94%A8%E5%A6%82%E7%BD%91%E7%BB%9C%E8%81%8A%E5%A4%A9%E5%AE%A4chatroom%E5%92%8C%E5%AE%9E%E6%97%B6%E5%B9%BF%E6%92%AD%E5%AE%9E%E6%97%B6%E6%8F%90%E9%86%92%E7%AD%89">å‘å¸ƒè®¢é˜…å‘½ä»¤è¡Œå®ç°(å¹¿å‘ç”¨äºæ„å»ºå³æ—¶é€šä¿¡åº”ç”¨ï¼Œå¦‚ç½‘ç»œèŠå¤©å®¤(chatroom)å’Œå®æ—¶å¹¿æ’­ã€å®æ—¶æé†’ç­‰)</a></li></ul></li></ul></li></ul> <hr> <h2 id="redisè®°å½•"><a href="#redisè®°å½•" class="header-anchor">#</a> Redisè®°å½•</h2> <h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="header-anchor">#</a> æ¦‚è¿°</h3> <ol><li>Redisæ˜¯noSQL(not only SQL)æ•°æ®åº“ å³éå…³ç³»å‹æ•°æ®åº“</li> <li>ä»¥key-valueå½¢å¼ç¼“å­˜æ•°æ®åœ¨å†…å­˜ä¸­ï¼Œè¯»å–é€Ÿåº¦æå¿«æ”¯æŒå¤šç§æ•°æ®ç»“æ„å¦‚string,list,set,zset,hashç­‰</li> <li>è¿™äº›æ•°æ®éƒ½æ”¯æŒpush/pop,add/removeä»¥åŠå–äº¤é›†å¹¶é›†å·®é›†ç­‰æ“ä½œï¼Œä¸”è¿™äº›æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ä¹Ÿå¯è¿›è¡Œæ•°æ®æŒä¹…åŒ–ï¼Œ</li> <li>å°†æ•°æ®å­˜å‚¨åˆ°ç¡¬ç›˜ï¼šRDBå’ŒAOFæ–¹å¼</li> <li>Redisä¸memcachedåŒºåˆ«ï¼šRedisä¼šå‘¨æœŸæ€§çš„æŠŠæ›´æ–°çš„æ•°æ®å†™å…¥ç£ç›˜æˆ–è€…æŠŠä¿®æ”¹æ“ä½œå†™å…¥è¿½åŠ çš„è®°å½•æ–‡ä»¶,åœ¨æ­¤åŸºç¡€ä¸Šï¼ŒRediså®ç°äº†ä¸»ä»åŒæ­¥</li></ol> <h3 id="å®‰è£…redis"><a href="#å®‰è£…redis" class="header-anchor">#</a> å®‰è£…Redis</h3> <ul><li><p>å…ˆç»™Linuxå®‰è£…gccç¯å¢ƒ yum -y install gcc automake autoconf libtool make</p></li> <li><p>å°†gccå‡çº§åˆ°9</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># gcc -v                             # æŸ¥çœ‹gccç‰ˆæœ¬</span>
<span class="token comment"># yum -y install centos-release-scl  # å‡çº§åˆ°9.1ç‰ˆæœ¬</span>
<span class="token comment"># yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils</span>
<span class="token comment"># scl enable devtoolset-9 bash</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>åœ¨/ç›®å½•ä¸‹æ–°å»ºsoftæ–‡ä»¶å¤¹ï¼Œå°†redisçš„tar.gzåŒ…æ”¾å…¥ï¼Œä½¿ç”¨tar -zxvf redis-xxè§£å‹(å¦‚æœæ²¡å®‰è£…tarï¼Œå¯ä»¥ä½¿ç”¨ yum install tar -yå®‰è£…)</p></li> <li><p>åœ¨redisçš„è§£å‹ç›®å½•ä¸‹è¾“å…¥makeæŒ‡ä»¤</p></li> <li><p>åœ¨redisçš„è§£å‹ç›®å½•ä¸‹è¾“å…¥ make install PREFIX=/usr/local/redis(prefixè¡¨ç¤ºå®‰è£…çš„ç›®å½•ï¼Œä¸æŒ‡å®šçš„è¯é»˜è®¤å®‰è£…åˆ°/usr/local/biné‡Œé¢)</p></li> <li><p>è§‚å¯Ÿ/usr/local/redisä¸­çš„æ–‡ä»¶ç»“æ„ï¼Œéœ€è¦å®‰è£…treeå‘½ä»¤è½¯ä»¶(yum install tree -y)</p></li> <li><p>ç„¶åå¯åŠ¨redisæœåŠ¡ï¼š/usr/local/redis/bin/redis-server</p></li> <li><p>å†æ‰“å¼€ä¸€ä¸ªç»ˆç«¯çª—å£ä½¿ç”¨rediså®¢æˆ·ç«¯æ“ä½œï¼š/usr/local/redis/bin/redis-cli</p></li> <li><p>åœ¨redisæœåŠ¡å¯åŠ¨çš„çª—å£ä½¿ç”¨ctrl+cæˆ–shutdown(æ¨è)æˆ–ä½¿ç”¨kill -9 è¿›ç¨‹idæ€æ­»redisè¿›ç¨‹ã€‚shutdownå‘½ä»¤åçš„å‚æ•°å¯ä»¥æ˜¯save/nosaveï¼Œä¸€èˆ¬ç”¨saveè¿›è¡Œæœ¬åœ°ä¿å­˜ä»¥ä¾¿ä¸‹æ¬¡å¯åŠ¨æ—¶æ¢å¤æ•°æ®</p></li> <li><p>é€šè¿‡ps -aux|grep rediså¯æŸ¥çœ‹redisæœåŠ¡ç«¯çš„è¿›ç¨‹</p></li> <li><p>firewall-cmd --zone=public --add-port=6379/tcp --permanentï¼šå¼€å¯6379é˜²ç«å¢™</p></li> <li><p>firewall-cmd --reloadï¼šé‡æ–°åŠ è½½é˜²ç«å¢™</p></li></ul> <h3 id="redisé…ç½®å…è®¸è¿œç¨‹è®¿é—®"><a href="#redisé…ç½®å…è®¸è¿œç¨‹è®¿é—®" class="header-anchor">#</a> Redisé…ç½®å…è®¸è¿œç¨‹è®¿é—®</h3> <ol><li><p>é…ç½®redisè®¿é—®å¯†ç </p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>port <span class="token number">6500</span>
daemonize <span class="token function">yes</span>
pidfile /var/run/redis_6500.pid
 logfile <span class="token string">&quot;/usr/local/redis/bin/redis-6500.log&quot;</span>
dbfilename dump-6500.rdb
 requirepass <span class="token number">123456</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>æŒ‡å®šç›‘å¬çš„ipåœ°å€</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>port <span class="token number">6500</span>
daemonize <span class="token function">yes</span>
pidfile /var/run/redis_6500.pid
 logfile <span class="token string">&quot;/usr/local/redis/bin/redis-6500.log&quot;</span>
dbfilename dump-6500.rdb
 <span class="token builtin class-name">bind</span> <span class="token number">192.168</span>.3.42
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>ç›´æ¥ç¦ç”¨ä¿æŠ¤æ¨¡å¼(ä¸æ¨èã€å±é™©)</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>port <span class="token number">6500</span>
daemonize <span class="token function">yes</span>
pidfile /var/run/redis_6500.pid
 logfile <span class="token string">&quot;/usr/local/redis/bin/redis-6500.log&quot;</span>
dbfilename dump-6500.rdb
 protected-mode no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>æ¨èä½¿ç”¨è®¾ç½®å¯†ç +è®¾ç½®ç›‘å¬IPçš„æ–¹å¼</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>port <span class="token number">6500</span>
daemonize <span class="token function">yes</span>
pidfile /var/run/redis_6500.pid
logfile <span class="token string">&quot;/usr/local/redis/bin/redis-6500.log&quot;</span>
 dbfilename dump-6500.rdb
<span class="token builtin class-name">bind</span> <span class="token number">192.168</span>.3.42
 requirepass <span class="token number">123456</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ol> <h3 id="å…¶ä»–çš„redisé…ç½®"><a href="#å…¶ä»–çš„redisé…ç½®" class="header-anchor">#</a> å…¶ä»–çš„Redisé…ç½®</h3> <div class="custom-block note"><p class="custom-block-title">ç¬”è®°</p> <ol><li><p>loglevelï¼šredisçš„æ—¥å¿—è®°å½•ç­‰çº§ï¼Œé»˜è®¤ä¸ºnoticeï¼Œå…±æœ‰å››çº§(debug&lt;verbose&lt;notice&lt;warning)</p></li> <li><p>databasesï¼šredisæœåŠ¡ä¸­æ•°æ®åº“çš„æ•°é‡ï¼Œé€šè¿‡select+æ•°å­—åˆ‡æ¢ï¼Œé»˜è®¤ä¸º0</p></li> <li><p>timeoutï¼šè¶…æ—¶å…³é—­è¿æ¥çš„æ—¶é—´ï¼Œå½“è¿æ¥redisæœåŠ¡çš„å®¢æˆ·ç«¯timeoutç§’æ²¡æœ‰æ´»åŠ¨çš„æ—¶å€™å°±å…³é—­è¿™ä¸ªè¿æ¥ã€‚è‹¥è®¾ç½®ä¸º0åˆ™è¡¨ç¤ºæ°¸è¿œä¸å…³é—­</p></li> <li><p>saveï¼šæŒ‡å‡ºåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶</p></li> <li><p>rdbcompressionï¼šæŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸º yes</p></li></ol> <p>Redis é‡‡ç”¨ LZF å‹ç¼©ï¼Œå¦‚æœä¸ºäº†èŠ‚çœ CPU æ—¶é—´ï¼Œå¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶å˜çš„å·¨å¤§</p> <ol start="6"><li><p>dirï¼š æœ¬åœ°æ•°æ®åº“å­˜æ”¾è·¯å¾„ï¼Œé»˜è®¤å€¼ä¸º ./</p></li> <li><p>slaveofï¼š å½“æœ¬æœºä¸ºä»æœåŠ¡æ—¶ï¼Œè®¾ç½®ä¸»æœåŠ¡çš„IPåŠç«¯å£ï¼Œå¦‚ï¼š192.168.0.100:6500</p></li> <li><p>slave-read-onlyï¼š å½“æœ¬æœºä¸ºä»æœåŠ¡æ—¶ï¼Œæ˜¯å¦è®¾ç½®ä¸ºåªè¯»çŠ¶æ€</p></li> <li><p>masterauthï¼š å½“æœ¬æœºä¸ºä»æœåŠ¡æ—¶ï¼Œè®¾ç½®ä¸»æœåŠ¡çš„è¿æ¥å¯†ç ï¼Œå¦‚ï¼š123456</p></li> <li><p>maxclientsï¼š æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°ï¼Œé»˜è®¤10000ï¼Œå‚ç…§<code>/soft/redis-6.0.6/redis.conf</code>ä¸­çš„è¯´æ˜ã€‚å¯åœ¨å®¢æˆ·ç«¯ä¸­ä½¿ç”¨config get maxclientsæŸ¥çœ‹è¿™ä¸ªé…ç½®</p></li></ol></div> <ol start="11"><li><p>appendonlyï¼šæŒ‡å®šæ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ“ä½œåè¿›è¡Œæ—¥å¿—è®°å½•ï¼ˆæ³¨æ„æ˜¯è¿›è¡Œæ—¥å¿—è®°å½•ï¼Œè€Œä¸æ˜¯å­˜å‚¨æ•°æ®ï¼‰ï¼Œé»˜è®¤ä¸ºnoã€‚Redis åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼‚æ­¥çš„æŠŠæ•°æ®å†™å…¥ç£ç›˜ï¼Œå¦‚æœä¸å¼€å¯ï¼Œå¯èƒ½ä¼šåœ¨æ–­ç”µæ—¶å¯¼è‡´ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®ä¸¢å¤±ã€‚å› ä¸º redis æœ¬èº«åŒæ­¥æ•°æ®æ–‡ä»¶æ˜¯æŒ‰ä¸Šé¢ save æ¡ä»¶æ¥åŒæ­¥çš„ï¼Œæ‰€ä»¥æœ‰çš„æ•°æ®ä¼šåœ¨ä¸€æ®µæ—¶é—´å†…åªå­˜åœ¨äºå†…å­˜ä¸­</p></li> <li><p>appendfilenameï¼šæŒ‡å®šæ›´æ–°æ—¥å¿—æ–‡ä»¶åï¼Œé»˜è®¤ä¸º appendonly.aofï¼Œé»˜è®¤çš„å°±æ˜¯appendonly.aofæ–‡ä»¶</p></li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>
###å¯åŠ¨redis

```bash
/usr/local/redis/bin/redis.confæˆ–/usr/local/redis/bin/redis-server
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="è¿æ¥å®¢æˆ·ç«¯"><a href="#è¿æ¥å®¢æˆ·ç«¯" class="header-anchor">#</a> è¿æ¥å®¢æˆ·ç«¯</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>  <span class="token comment">#-hï¼šæŒ‡å®šip	-pï¼šæŒ‡å®šç«¯å£	  -aï¼šè‹¥å¼€å¯äº†éªŒè¯ï¼Œéœ€æŒ‡å®šéªŒè¯å¯†ç ç™»å½•</span>
/usr/local/redis/bin/redis-cli <span class="token parameter variable">-h</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">-p</span> <span class="token number">6379</span> <span class="token parameter variable">-a</span> <span class="token number">123</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="è®¾ç½®rediså¼€æœºå¯åŠ¨"><a href="#è®¾ç½®rediså¼€æœºå¯åŠ¨" class="header-anchor">#</a> è®¾ç½®rediså¼€æœºå¯åŠ¨</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token number">1</span>ï¼šç¼–è¾‘ /etcä¸‹çš„ rc.local æ–‡ä»¶,å°†redisçš„å¯åŠ¨å‘½ä»¤å†™å…¥æ–‡ä»¶
<span class="token function">vim</span> /etc/rc.local

<span class="token number">2</span>ï¼šç¼–è¾‘è„šæœ¬å†…å®¹
/usr/local/redis/redis-server /usr/local/redis/redis.conf

tipï¼šè‹¥å¼€æœºè„šæœ¬ä¸èµ·ä½œç”¨ï¼Œå¯èƒ½å› ä¸º rc.local çš„æ‰§è¡Œæƒé™é—®é¢˜ã€‚
<span class="token function">chmod</span> <span class="token number">755</span> /etc/rc.local 

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="ç”¨é€”ä¸¾ä¾‹"><a href="#ç”¨é€”ä¸¾ä¾‹" class="header-anchor">#</a> ç”¨é€”ä¸¾ä¾‹</h4> <ul><li>è·å–æœ€æ–°çš„Nä¸ªæ•°æ®ï¼šé€šè¿‡listå®ç°æŒ‰è‡ªç„¶æ—¶é—´æ’åºçš„æ•°æ®</li> <li>æ’è¡Œæ¦œtopNï¼šåˆ©ç”¨zset(æœ‰åºé›†åˆ)å®ç°</li> <li>æ—¶æ•ˆæ€§æ•°æ®ï¼Œå¦‚æ‰‹æœºã€é‚®ç®±éªŒè¯ç ï¼šåˆ©ç”¨Expireè¿‡æœŸ</li> <li>è®¡æ•°å™¨ï¼Œç§’æ€ï¼šåŸå­æ€§ï¼Œåˆ©ç”¨è‡ªå¢æ–¹æ³•INCRã€DECR</li> <li>å»é™¤å¤§é‡æ•°æ®ä¸­çš„é‡å¤æ•°æ®ï¼šåˆ©ç”¨Seté›†åˆ</li> <li>æ„å»ºé˜Ÿåˆ—ï¼šåˆ©ç”¨list</li> <li>å‘å¸ƒè®¢é˜…æ¶ˆæ¯ç³»ç»Ÿï¼špub/subæ¨¡å¼</li></ul> <h3 id="redisé”®-key"><a href="#redisé”®-key" class="header-anchor">#</a> Redisé”®(key)</h3> <ul><li>**keys <em>ï¼šæŸ¥çœ‹å½“å‰åº“ä¸­æ‰€æœ‰key (åŒ¹é…ï¼škeys <em>1)</em></em></li> <li><strong>exists keyï¼šåˆ¤æ–­æŸä¸ªkeyæ˜¯å¦å­˜åœ¨</strong></li> <li><strong>type keyï¼šæŸ¥çœ‹ä½ çš„keyæ˜¯ä»€ä¹ˆç±»å‹</strong></li> <li><strong>del keyï¼šåˆ é™¤æŒ‡å®šçš„keyçš„æ•°æ®</strong></li> <li><strong>unlink keyï¼šéé˜»å¡åˆ é™¤æ•°æ®(å¼‚æ­¥åˆ é™¤,ä¸æ˜¯ç«‹åˆ»åˆ é™¤)ï¼Œä»…å°†keyä»keyspaceå…ƒæ•°æ®ä¸­åˆ é™¤ï¼ŒçœŸæ­£çš„åˆ é™¤ä¼šåœ¨åç»­å¼‚æ­¥æ‰§è¡Œ</strong></li> <li><strong>expire key 10(å•ä½æ˜¯seconds)ï¼šä¸ºç»™å®šçš„keyè®¾ç½®è¿‡æœŸæ—¶é—´</strong></li> <li><strong>ttl keyï¼šæŸ¥çœ‹è¿˜æœ‰å¤šå°‘ç§’è¿‡æœŸï¼Œ-1è¡¨ç¤ºæ°¸ä¸è¿‡æœŸï¼Œ-2è¡¨ç¤ºå·²ç»è¿‡æœŸ</strong></li> <li><strong>select (æ•°å­—)ï¼šåˆ‡æ¢æ•°æ®åº“(0-15)ä¸€å…±16ä¸ªæ•°æ®åº“</strong></li> <li><strong>dbsizeï¼šæŸ¥çœ‹å½“å‰æ•°æ®åº“çš„keyçš„æ•°é‡</strong></li> <li><strong>flushdbï¼šæ¸…ç©ºå½“å‰åº“</strong></li> <li><strong>flushallï¼šæ¸…ç©ºæ‰€æœ‰åº“</strong></li></ul> <h3 id="åŸå­æ€§"><a href="#åŸå­æ€§" class="header-anchor">#</a> åŸå­æ€§</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>æ‰€è°“åŸå­æ“ä½œæ˜¯æŒ‡ä¸ä¼šè¢«çº¿ç¨‹è°ƒåº¦æœºåˆ¶æ‰“æ–­çš„æ“ä½œ<span class="token punctuation">;</span>
è¿™ç§æ“ä½œä¸€æ—¦å¼€å§‹ï¼Œå°±ä¼šä¸€ç›´è¿è¡Œåˆ°ç»“æŸï¼Œä¸­é—´ä¸ä¼šæœ‰ä»»ä½•context switch<span class="token punctuation">(</span>åˆ‡æ¢åˆ°å¦ä¸€çº¿ç¨‹<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>åœ¨å•çº¿ç¨‹ä¸­ï¼Œèƒ½å¤Ÿåœ¨å•æ¡æŒ‡ä»¤ä¸­å®Œæˆçš„æ“ä½œéƒ½å¯ä»¥è®¤ä¸ºæ˜¯<span class="token string">&quot;åŸå­æ“ä½œ&quot;</span>ï¼Œå› ä¸ºä¸­æ–­åªèƒ½å‘ç”Ÿåœ¨æŒ‡ä»¤ä¹‹é—´
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>åœ¨å¤šçº¿ç¨‹ä¸­ï¼Œä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹<span class="token punctuation">(</span>çº¿ç¨‹<span class="token punctuation">)</span>æ‰“æ–­çš„æ“ä½œå°±å«åŸå­æ“ä½œï¼Œrediså•å‘½ä»¤çš„åŸå­æ€§ä¸»è¦å¾—ç›Šäºredisæ˜¯å•çº¿ç¨‹
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="string"><a href="#string" class="header-anchor">#</a> String</h3> <blockquote><p>Stringæ˜¯Redisæœ€åŸºæœ¬çš„ç±»å‹ï¼Œä½ å¯ä»¥ç†è§£æˆä¸Memcachedä¸€æ¨¡ä¸€æ ·çš„ç±»å‹ï¼Œä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªvalueã€‚v
Stringç±»å‹æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ã€‚æ„å‘³ç€Redisçš„string å¯ä»¥åŒ…å«ä»»ä½•æ•°æ®ã€‚æ¯”å¦‚jpgå›¾ç‰‡æˆ–è€…åºåˆ—åŒ–çš„å¯¹è±¡ã€‚Â·
Stringç±»å‹æ˜¯Redisæœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œä¸€ä¸ªRedis ä¸­å­—ç¬¦ä¸²valueæœ€å¤šå¯ä»¥æ˜¯512M</p></blockquote> <h4 id="åŸºæœ¬å‘½ä»¤"><a href="#åŸºæœ¬å‘½ä»¤" class="header-anchor">#</a> åŸºæœ¬å‘½ä»¤</h4> <ul><li>set [key] [value] å­˜ä¸€ä¸ªï¼Œé‡å¤setåŒä¸€ä¸ªkey ï¼ŒåŸæ¥çš„å€¼ä¼šè¢«è¦†ç›–</li> <li>get [key] è·å–å¯¹åº”key çš„å€¼</li> <li>append [key] [value] åœ¨æŒ‡å®škey çš„å€¼åé¢è¿½åŠ valueå­—ç¬¦ä¸²</li> <li>strlen [key] è·å–å¯¹åº”keyå€¼çš„å­—ç¬¦ä¸²é•¿åº¦</li> <li>setnx [key] [value]ï¼šåªæœ‰åœ¨keyä¸å­˜åœ¨æ—¶è®¾ç½®keyçš„å€¼</li> <li>incr [key] å°†keyä¸­å‚¨å­˜çš„æ•°å­—å€¼åŠ 1ï¼Œåªèƒ½å¯¹æ•°å­—å€¼æ“ä½œï¼Œå¦‚æœä¸ºç©ºï¼Œæ–°å¢è¿™ä¸ªkeyï¼Œèµ‹å€¼ä¸º1</li> <li>decr [key] å°†keyä¸­å‚¨å­˜çš„æ•°å­—å€¼å‡1ï¼Œåªèƒ½å¯¹æ•°å­—å€¼æ“ä½œï¼Œå¦‚æœä¸ºç©ºï¼Œæ–°å¢è¿™ä¸ªkeyï¼Œèµ‹å€¼ä¸º-1</li> <li>incrby/decrby [key] [æ­¥é•¿]ï¼šå°†keyä¸­å‚¨å­˜çš„æ•°å­—è¿›è¡Œå¢å‡è‡ªå®šä¹‰æ­¥é•¿</li> <li>mset [key] [value] [key] [value] [key] [value]....åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªkey valueé”®å€¼å¯¹</li> <li>mget [key] [value] [key] [value] [key] [value]....åŒæ—¶è·å–ä¸€ä¸ªæˆ–å¤šä¸ªkeyçš„å€¼</li> <li>msetnx [key] [value] [key] [value]ï¼šå½“å…¶ä¸­æœ‰ä¸€ä¸ªkeyæ˜¯å·²å­˜åœ¨çš„ï¼Œæ•´ä¸ªmsetnxæ“ä½œä¼šå¤±è´¥(åŸå­æ€§çš„)</li> <li>getrange [key] [index] [end] è·å–å€¼å¾—èŒƒå›´ï¼Œç±»ä¼¼Java substringï¼Œå·¦å³å‡ä¸ºé—­åŒºé—´</li> <li>setrange [key] [index] [value] ç”¨valueè¦†ç›–ä»index(åŒ…å«index)å¼€å§‹åçš„å­—ç¬¦ä¸²valueé•¿åº¦ä¸ªå­—ç¬¦ä¸²(indexä»0å¼€å§‹)</li> <li>setex [key] [è¿‡æœŸæ—¶é—´] [value]ï¼šåœ¨è®¾ç½®å€¼çš„æ—¶å€™å³å¯è®¾ç½®è¿‡æœŸæ—¶é—´</li> <li>getset [key] [value]ï¼šä»¥æ–°æ¢æ—§ï¼Œè®¾ç½®æ–°å€¼å¾—åˆ°æ—§å€¼(å–åˆ°çš„æ˜¯æ—§å€¼ï¼Œç„¶åå­˜å‚¨çš„æ—§å€¼è¢«æ–°å€¼æ›¿æ¢)</li></ul> <h4 id="stringçš„æ•°æ®ç»“æ„"><a href="#stringçš„æ•°æ®ç»“æ„" class="header-anchor">#</a> Stringçš„æ•°æ®ç»“æ„</h4> <blockquote><p>String çš„stringçš„åº•å±‚æ•°æ®ç»“æ„ä¸ºç®€å•åŠ¨æ€å­—ç¬¦ä¸²(Simple Dynamic String,ç¼©å†™SDS)ã€‚æ˜¯å¯ä»¥ä¿®æ”¹çš„å­—ç¬¦ä¸²ï¼Œå†…éƒ¨ç»“æ„å®ç°ä¸Šç±»ä¼¼äºJavaçš„ArrayListï¼Œé‡‡ç”¨é¢„åˆ†é…å†—ä½™ç©ºé—´çš„æ–¹å¼æ¥å‡å°‘å†…å­˜çš„é¢‘ç¹åˆ†é…ã€‚å†…éƒ¨ä¸ºå½“å‰å­—ç¬¦ä¸²å®é™…åˆ†é…çš„ç©ºé—´capacityä¸€èˆ¬è¦é«˜äºå®é™…å­—ç¬¦ä¸²é•¿åº¦lenã€‚å½“å­—ç¬¦ä¸²é•¿åº¦å°äº1Mæ—¶ï¼Œæ‰©å®¹éƒ½æ˜¯åŠ å€ç°æœ‰çš„ç©ºé—´ï¼Œå¦‚æœè¶…è¿‡1Mï¼Œæ‰©å®¹æ—¶ä¸€æ¬¡åªä¼šå¤šæ‰©1Mçš„ç©ºé—´ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å­—ç¬¦ä¸²æœ€å¤§é•¿åº¦ä¸º512Mã€‚</p></blockquote> <p>SDSå®šä¹‰</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">sdshdr</span><span class="token punctuation">{</span>
     <span class="token comment">//è®°å½•bufæ•°ç»„ä¸­å·²ä½¿ç”¨å­—èŠ‚çš„æ•°é‡</span>
     <span class="token comment">//ç­‰äº SDS ä¿å­˜å­—ç¬¦ä¸²çš„é•¿åº¦</span>
     <span class="token keyword">int</span> len<span class="token punctuation">;</span>
     <span class="token comment">//è®°å½• buf æ•°ç»„ä¸­æœªä½¿ç”¨å­—èŠ‚çš„æ•°é‡</span>
     <span class="token keyword">int</span> free<span class="token punctuation">;</span>
     <span class="token comment">//å­—èŠ‚æ•°ç»„ï¼Œç”¨äºä¿å­˜å­—ç¬¦ä¸²</span>
     <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img src="https://images.zaiolos.top/images/image-20220426193757806.png" alt=""></p> <h4 id="ç›¸å¯¹äºä½¿ç”¨cè¯­è¨€åŸæœ¬çš„char-çš„å­—ç¬¦ä¸²æœ‰ä»€ä¹ˆå¥½å¤„"><a href="#ç›¸å¯¹äºä½¿ç”¨cè¯­è¨€åŸæœ¬çš„char-çš„å­—ç¬¦ä¸²æœ‰ä»€ä¹ˆå¥½å¤„" class="header-anchor">#</a> ç›¸å¯¹äºä½¿ç”¨Cè¯­è¨€åŸæœ¬çš„char[]çš„å­—ç¬¦ä¸²æœ‰ä»€ä¹ˆå¥½å¤„</h4> <ol><li><p><strong>å¸¸æ•°å¤æ‚åº¦è·å–å­—ç¬¦ä¸²é•¿åº¦</strong></p> <blockquote><p>ç”±äº len å±æ€§çš„å­˜åœ¨ï¼Œæˆ‘ä»¬è·å– SDS å­—ç¬¦ä¸²çš„é•¿åº¦åªéœ€è¦è¯»å– len å±æ€§ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚è€Œå¯¹äº C è¯­è¨€ï¼Œè·å–å­—ç¬¦ä¸²çš„é•¿åº¦é€šå¸¸æ˜¯ç»è¿‡éå†è®¡æ•°æ¥å®ç°çš„ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚é€šè¿‡ strlen key å‘½ä»¤å¯ä»¥è·å– key çš„å­—ç¬¦ä¸²é•¿åº¦</p></blockquote></li> <li><p><strong>æœç»ç¼“å†²åŒºæº¢å‡º</strong></p> <blockquote><p>æˆ‘ä»¬çŸ¥é“åœ¨ C è¯­è¨€ä¸­ä½¿ç”¨ strcat å‡½æ•°æ¥è¿›è¡Œä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼Œä¸€æ—¦æ²¡æœ‰åˆ†é…è¶³å¤Ÿé•¿åº¦çš„å†…å­˜ç©ºé—´ï¼Œå°±ä¼šé€ æˆç¼“å†²åŒºæº¢å‡ºã€‚è€Œå¯¹äº SDS æ•°æ®ç±»å‹ï¼Œåœ¨è¿›è¡Œå­—ç¬¦ä¿®æ”¹çš„æ—¶å€™ï¼Œä¼šé¦–å…ˆæ ¹æ®è®°å½•çš„ len å±æ€§æ£€æŸ¥å†…å­˜ç©ºé—´æ˜¯å¦æ»¡è¶³éœ€æ±‚ï¼Œå¦‚æœä¸æ»¡è¶³ï¼Œä¼šè¿›è¡Œç›¸åº”çš„ç©ºé—´æ‰©å±•ï¼Œç„¶ååœ¨è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°ç¼“å†²åŒºæº¢å‡º</p></blockquote></li> <li><p><strong>å‡å°‘ä¿®æ”¹å­—ç¬¦ä¸²çš„å†…å­˜é‡æ–°åˆ†é…æ¬¡æ•°</strong></p> <blockquote><p>Cè¯­è¨€ç”±äºä¸è®°å½•å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œæ‰€ä»¥å¦‚æœè¦ä¿®æ”¹å­—ç¬¦ä¸²ï¼Œå¿…é¡»è¦é‡æ–°åˆ†é…å†…å­˜ï¼ˆå…ˆé‡Šæ”¾å†ç”³è¯·ï¼‰ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰é‡æ–°åˆ†é…ï¼Œå­—ç¬¦ä¸²é•¿åº¦å¢å¤§æ—¶ä¼šé€ æˆå†…å­˜ç¼“å†²åŒºæº¢å‡ºï¼Œå­—ç¬¦ä¸²é•¿åº¦å‡å°æ—¶ä¼šé€ æˆå†…å­˜æ³„éœ²ã€‚</p> <p>è€Œå¯¹äºSDSï¼Œç”±äºlenå±æ€§å’Œfreeå±æ€§çš„å­˜åœ¨ï¼Œå¯¹äºä¿®æ”¹å­—ç¬¦ä¸²SDSå®ç°äº†ç©ºé—´é¢„åˆ†é…å’Œæƒ°æ€§ç©ºé—´é‡Šæ”¾ä¸¤ç§ç­–ç•¥ï¼š</p> <ul><li>ç©ºé—´é¢„åˆ†é…ï¼šå¯¹å­—ç¬¦ä¸²è¿›è¡Œç©ºé—´æ‰©å±•çš„æ—¶å€™ï¼Œæ‰©å±•çš„å†…å­˜æ¯”å®é™…éœ€è¦çš„å¤šï¼Œè¿™æ ·å¯ä»¥å‡å°‘è¿ç»­æ‰§è¡Œå­—ç¬¦ä¸²å¢é•¿æ“ä½œæ‰€éœ€çš„å†…å­˜é‡åˆ†é…æ¬¡æ•°</li> <li>æƒ°æ€§ç©ºé—´é‡Šæ”¾ï¼šå¯¹å­—ç¬¦ä¸²è¿›è¡Œç¼©çŸ­æ“ä½œæ—¶ï¼Œç¨‹åºä¸ç«‹å³ä½¿ç”¨å†…å­˜é‡æ–°åˆ†é…æ¥å›æ”¶ç¼©çŸ­åå¤šä½™çš„å­—èŠ‚ï¼Œè€Œæ˜¯ä½¿ç”¨ free å±æ€§å°†è¿™äº›å­—èŠ‚çš„æ•°é‡è®°å½•ä¸‹æ¥ï¼Œç­‰å¾…åç»­ä½¿ç”¨ã€‚ï¼ˆå½“ç„¶SDSä¹Ÿæä¾›äº†ç›¸åº”çš„APIï¼Œå½“æˆ‘ä»¬æœ‰éœ€è¦æ—¶ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨é‡Šæ”¾è¿™äº›æœªä½¿ç”¨çš„ç©ºé—´ã€‚ï¼‰</li></ul></blockquote></li> <li><p><strong>äºŒè¿›åˆ¶å®‰å…¨</strong></p> <blockquote><p>å› ä¸ºCå­—ç¬¦ä¸²ä»¥ç©ºå­—ç¬¦ä½œä¸ºå­—ç¬¦ä¸²ç»“æŸçš„æ ‡è¯†ï¼Œè€Œå¯¹äºä¸€äº›äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¦‚å›¾ç‰‡ç­‰ï¼‰ï¼Œå†…å®¹å¯èƒ½åŒ…æ‹¬ç©ºå­—ç¬¦ä¸²ï¼Œå› æ­¤Cå­—ç¬¦ä¸²æ— æ³•æ­£ç¡®å­˜å–ï¼›è€Œæ‰€æœ‰ SDS çš„API éƒ½æ˜¯ä»¥å¤„ç†äºŒè¿›åˆ¶çš„æ–¹å¼æ¥å¤„ç† buf é‡Œé¢çš„å…ƒç´ ï¼Œå¹¶ä¸” SDS ä¸æ˜¯ä»¥ç©ºå­—ç¬¦ä¸²æ¥åˆ¤æ–­æ˜¯å¦ç»“æŸï¼Œè€Œæ˜¯ä»¥ len å±æ€§è¡¨ç¤ºçš„é•¿åº¦æ¥åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ç»“æŸ</p></blockquote></li> <li><p><strong>å…¼å®¹éƒ¨åˆ† C å­—ç¬¦ä¸²å‡½æ•°</strong></p> <blockquote><p>è™½ç„¶ SDS æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œä½†æ˜¯ä¸€æ ·éµä»æ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯ä»¥ç©ºå­—ç¬¦ä¸²ç»“å°¾çš„æƒ¯ä¾‹ï¼Œè¿™æ ·å¯ä»¥é‡ç”¨ C è¯­è¨€åº“&lt;string.h&gt; ä¸­çš„ä¸€éƒ¨åˆ†å‡½æ•°</p></blockquote></li> <li><p><strong>æ€»ç»“</strong></p> <p><img src="https://images.zaiolos.top/images/image-20220426200122877.png" alt=""></p></li></ol> <h3 id="list"><a href="#list" class="header-anchor">#</a> List</h3> <h4 id="æ¦‚è¿°-2"><a href="#æ¦‚è¿°-2" class="header-anchor">#</a> æ¦‚è¿°</h4> <blockquote><p>å•é”®å¤šå€¼</p> <p>Redisåˆ—è¡¨æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºæ’åºã€‚ä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°åˆ—è¡¨çš„å¤´éƒ¨(å·¦è¾¹ï¼‰æˆ–è€…å°¾éƒ¨(å³è¾¹)ã€‚
å®ƒçš„åº•å±‚å®é™…æ˜¯ä¸ªåŒå‘é“¾è¡¨ï¼Œå¯¹ä¸¤ç«¯çš„æ“ä½œæ€§èƒ½å¾ˆé«˜ï¼Œé€šè¿‡ç´¢å¼•ä¸‹æ ‡çš„æ“ä½œä¸­é—´çš„èŠ‚ç‚¹æ€§èƒ½ä¼šè¾ƒå·®ã€‚</p></blockquote> <h4 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="header-anchor">#</a> å¸¸ç”¨å‘½ä»¤</h4> <ul><li><p>lrange/rrange [key] [start] [stop] æŒ‰ç…§ç´¢å¼•ä¸‹æ ‡è·å–å…ƒç´ (ä»å·¦åˆ°å³æˆ–ä»å³åˆ°å·¦)</p> <p>å¦‚æœstartæ˜¯0ï¼Œstopæ˜¯-1ï¼Œå³å¯å–åˆ°æ‰€æœ‰å€¼ï¼Œå› ä¸º0è¡¨ç¤ºå·¦è¾¹ç¬¬ä¸€ä¸ªï¼Œ-1è¡¨ç¤ºå³è¾¹ç¬¬ä¸€ä¸ª</p></li> <li><p>lpush/rpush [key] [value] [key] [value] [key] [value]..... ï¼šä»å·¦æˆ–å³æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ï¼Œæ’å…¥æ–¹å¼ä¸ºå·¦æ’æ³•æˆ–å³æ’æ³•ï¼Œå³æ¯æ¬¡æ’å…¥åˆ°å½“å‰æ–¹å‘çš„æœ€åä¸€ä¸ªçš„åé¢ã€‚</p> <p>ä¾‹å¦‚lpush k1 v1 k2 v2 k3 v3ï¼Œç„¶åä½¿ç”¨lrange 0 2å–åˆ°çš„å€¼å¾—é¡ºåºæ˜¯v3 v2 v1ï¼Œå› ä¸ºæ’å…¥çš„æ–¹å¼æ˜¯å…ˆv1</p> <p>ï¼Œç„¶åv2 v1ï¼Œç„¶åv3 v2 v1ã€‚</p></li> <li><p>lpop/rpop [key] ä»å·¦è¾¹/å³è¾¹åå‡ºä¸€ä¸ªå€¼</p></li> <li><p>rpoplpush [key1] [key2] ä»[key1]åˆ—è¡¨å³è¾¹åå‡ºä¸€ä¸ªå€¼ï¼Œæ’åˆ°[key2]åˆ—è¡¨çš„å·¦è¾¹</p></li> <li><p>lindex[key] [index] æ ¹æ®ç´¢å¼•è·å–å…ƒç´ (ä»å·¦åˆ°å³)</p></li> <li><p>llen[key] è·å¾—é“¾è¡¨é•¿åº¦</p></li> <li><p>linsert[key] before/after [value] [newvalue] åœ¨valueçš„ä¹‹å‰æˆ–ä¹‹åæ’å…¥newvalue</p></li> <li><p>lset[key] [index] [value] å°†åˆ—è¡¨keyä¸‹æ ‡ä¸ºindexçš„å€¼æ›¿æ¢ä¸ºvalue</p></li> <li><p>lrem[key] [n] [value] ä»å·¦è¾¹å¼€å§‹åˆ é™¤nä¸ªvalue</p></li></ul> <h4 id="listçš„æ•°æ®ç»“æ„"><a href="#listçš„æ•°æ®ç»“æ„" class="header-anchor">#</a> Listçš„æ•°æ®ç»“æ„</h4> <blockquote><p>Listçš„æ•°æ®ç»“æ„ä¸ºå¿«é€Ÿé“¾è¡¨quickListã€‚</p> <p>é¦–å…ˆåœ¨åˆ—è¡¨å…ƒç´ è¾ƒå°‘çš„æƒ…å†µä¸‹ä¼šä½¿ç”¨ä¸€å—è¿ç»­çš„å†…å­˜å­˜å‚¨ï¼Œè¿™ä¸ªç»“æ„æ˜¯ziplistï¼Œä¹Ÿå³æ˜¯å‹ç¼©åˆ—è¡¨ã€‚
å®ƒå°†æ‰€æœ‰çš„å…ƒç´ ç´§æŒ¨ç€ä¸€èµ·å­˜å‚¨ï¼Œåˆ†é…çš„æ˜¯ä¸€å—è¿ç»­çš„å†…å­˜ã€‚å½“æ•°æ®é‡æ¯”è¾ƒå¤šçš„æ—¶å€™æ‰ä¼šæ”¹æˆquicklistã€‚</p> <p>å› ä¸ºæ™®é€šçš„é“¾è¡¨éœ€è¦çš„é™„åŠ æŒ‡é’ˆç©ºé—´å¤ªå¤§ï¼Œä¼šæ¯”è¾ƒæµªè´¹ç©ºé—´ã€‚æ¯”å¦‚åˆ—è¡¨é‡Œå­˜çš„åªæ˜¯intç±»å‹çš„æ•°æ®ï¼Œç»“æ„ä¸Šè¿˜éœ€è¦ä¸¤ä¸ªé¢å¤–çš„æŒ‡é’ˆprevå’Œnextã€‚</p> <p>Rediså°†é“¾è¡¨å’Œziplistç»“åˆèµ·æ¥ç»„æˆäº†quicklistã€‚ä¹Ÿå°±æ˜¯å°†å¤šä¸ªziplistä½¿ç”¨åŒå‘æŒ‡é’ˆä¸²èµ·æ¥ä½¿ç”¨ã€‚è¿™æ ·æ—¢æ»¡è¶³äº†å¿«é€Ÿçš„æ’å…¥åˆ é™¤æ€§èƒ½ï¼Œåˆä¸ä¼šå‡ºç°å¤ªå¤§çš„ç©ºé—´å†—ä½™ã€‚</p></blockquote> <p>é“¾è¡¨ç»“ç‚¹å®šä¹‰ï¼š</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span>  <span class="token keyword">struct</span> <span class="token class-name">listNode</span><span class="token punctuation">{</span>
       <span class="token comment">//å‰ç½®èŠ‚ç‚¹</span>
       <span class="token keyword">struct</span> <span class="token class-name">listNode</span> <span class="token operator">*</span>prev<span class="token punctuation">;</span>
       <span class="token comment">//åç½®èŠ‚ç‚¹</span>
       <span class="token keyword">struct</span> <span class="token class-name">listNode</span> <span class="token operator">*</span>next<span class="token punctuation">;</span>
       <span class="token comment">//èŠ‚ç‚¹çš„å€¼</span>
       <span class="token keyword">void</span> <span class="token operator">*</span>value<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>listNode
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>åŒå‘é“¾è¡¨å®šä¹‰ï¼š</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">list</span><span class="token punctuation">{</span>
     <span class="token comment">//è¡¨å¤´èŠ‚ç‚¹</span>
     listNode <span class="token operator">*</span>head<span class="token punctuation">;</span>
     <span class="token comment">//è¡¨å°¾èŠ‚ç‚¹</span>
     listNode <span class="token operator">*</span>tail<span class="token punctuation">;</span>
     <span class="token comment">//é“¾è¡¨æ‰€åŒ…å«çš„èŠ‚ç‚¹æ•°é‡</span>
     <span class="token keyword">unsigned</span> <span class="token keyword">long</span> len<span class="token punctuation">;</span>
     <span class="token comment">//èŠ‚ç‚¹å€¼å¤åˆ¶å‡½æ•°</span>
     <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>free<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">//èŠ‚ç‚¹å€¼é‡Šæ”¾å‡½æ•°</span>
     <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>free<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">//èŠ‚ç‚¹å€¼å¯¹æ¯”å‡½æ•°</span>
     <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>match<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span><span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>list<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Redisé“¾è¡¨ç‰¹æ€§ï¼š</p> <ul><li>åŒç«¯ï¼šé“¾è¡¨å…·æœ‰å‰ç½®èŠ‚ç‚¹å’Œåç½®èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œè·å–è¿™ä¸¤ä¸ªèŠ‚ç‚¹æ—¶é—´å¤æ‚åº¦éƒ½ä¸ºO(1)</li> <li>æ— ç¯ï¼šè¡¨å¤´èŠ‚ç‚¹çš„ prev æŒ‡é’ˆå’Œè¡¨å°¾èŠ‚ç‚¹çš„ next æŒ‡é’ˆéƒ½æŒ‡å‘ NULL,å¯¹é“¾è¡¨çš„è®¿é—®éƒ½æ˜¯ä»¥ NULL ç»“æŸ</li> <li>å¸¦é“¾è¡¨é•¿åº¦è®¡æ•°å™¨ï¼šé€šè¿‡ len å±æ€§è·å–é“¾è¡¨é•¿åº¦çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)</li> <li>å¤šæ€ï¼šé“¾è¡¨èŠ‚ç‚¹ä½¿ç”¨ void* æŒ‡é’ˆæ¥ä¿å­˜èŠ‚ç‚¹å€¼ï¼Œå¯ä»¥ä¿å­˜å„ç§ä¸åŒç±»å‹çš„å€¼</li></ul> <h4 id="ä½œä¸ºliståº•å±‚å®ç°ä¹‹ä¸€çš„å‹ç¼©åˆ—è¡¨"><a href="#ä½œä¸ºliståº•å±‚å®ç°ä¹‹ä¸€çš„å‹ç¼©åˆ—è¡¨" class="header-anchor">#</a> ä½œä¸ºListåº•å±‚å®ç°ä¹‹ä¸€çš„å‹ç¼©åˆ—è¡¨</h4> <blockquote><p>å‹ç¼©åˆ—è¡¨ï¼ˆziplistï¼‰æ˜¯Redisä¸ºäº†èŠ‚çœå†…å­˜è€Œå¼€å‘çš„ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—ç‰¹æ®Šç¼–ç çš„è¿ç»­å†…å­˜å—ç»„æˆçš„é¡ºåºå‹æ•°æ®ç»“æ„ï¼Œä¸€ä¸ªå‹ç¼©åˆ—è¡¨å¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªèŠ‚ç‚¹ï¼ˆentryï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥ä¿å­˜ä¸€ä¸ªå­—èŠ‚æ•°ç»„æˆ–è€…ä¸€ä¸ªæ•´æ•°å€¼</p></blockquote> <p><strong>å‹ç¼©åˆ—è¡¨çš„åŸç†ï¼šå‹ç¼©åˆ—è¡¨å¹¶ä¸æ˜¯å¯¹æ•°æ®åˆ©ç”¨æŸç§ç®—æ³•è¿›è¡Œå‹ç¼©ï¼Œè€Œæ˜¯å°†æ•°æ®æŒ‰ç…§ä¸€å®šè§„åˆ™ç¼–ç åœ¨ä¸€å—è¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œç›®çš„æ˜¯èŠ‚çœå†…å­˜</strong></p> <p>å‹ç¼©åˆ—è¡¨çš„æ¯ä¸ªèŠ‚ç‚¹æ„æˆå¦‚ä¸‹ï¼š</p> <p><img src="https://images.zaiolos.top/images/image-20220426203659897.png" alt="image-20220426203659897"></p> <ol><li>previous_entry_engthï¼šè®°å½•å‹ç¼©åˆ—è¡¨å‰ä¸€ä¸ªå­—èŠ‚çš„é•¿åº¦ã€‚previous_entry_engthçš„é•¿åº¦å¯èƒ½æ˜¯1ä¸ªå­—èŠ‚æˆ–è€…æ˜¯5ä¸ªå­—èŠ‚ï¼Œå¦‚æœä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦å°äº254ï¼Œåˆ™è¯¥èŠ‚ç‚¹åªéœ€è¦ä¸€ä¸ªå­—èŠ‚å°±å¯ä»¥è¡¨ç¤ºå‰ä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦äº†ï¼Œå¦‚æœå‰ä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦å¤§äºç­‰äº254ï¼Œåˆ™previous lengthçš„ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸º254ï¼Œåé¢ç”¨å››ä¸ªå­—èŠ‚è¡¨ç¤ºå½“å‰èŠ‚ç‚¹å‰ä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦ã€‚åˆ©ç”¨æ­¤åŸç†å³å½“å‰èŠ‚ç‚¹ä½ç½®å‡å»ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦å³å¾—åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„èµ·å§‹ä½ç½®ï¼Œå‹ç¼©åˆ—è¡¨å¯ä»¥ä»å°¾éƒ¨å‘å¤´éƒ¨éå†ã€‚è¿™ä¹ˆåšå¾ˆæœ‰æ•ˆåœ°å‡å°‘äº†å†…å­˜çš„æµªè´¹</li> <li>encodingï¼šèŠ‚ç‚¹çš„encodingä¿å­˜çš„æ˜¯èŠ‚ç‚¹çš„contentçš„å†…å®¹ç±»å‹ä»¥åŠé•¿åº¦ï¼Œencodingç±»å‹ä¸€å…±æœ‰ä¸¤ç§ï¼Œä¸€ç§å­—èŠ‚æ•°ç»„ä¸€ç§æ˜¯æ•´æ•°ï¼ŒencodingåŒºåŸŸé•¿åº¦ä¸º1å­—èŠ‚ã€2å­—èŠ‚æˆ–è€…5å­—èŠ‚é•¿</li> <li>contentï¼šcontentåŒºåŸŸç”¨äºä¿å­˜èŠ‚ç‚¹çš„å†…å®¹ï¼ŒèŠ‚ç‚¹å†…å®¹ç±»å‹å’Œé•¿åº¦ç”±encodingå†³å®š</li></ol> <h3 id="set"><a href="#set" class="header-anchor">#</a> Set</h3> <h4 id="æ¦‚è¿°-3"><a href="#æ¦‚è¿°-3" class="header-anchor">#</a> æ¦‚è¿°</h4> <blockquote><p>Redis setå¯¹å¤–æä¾›çš„åŠŸèƒ½ä¸listç±»ä¼¼æ˜¯ä¸€ä¸ªåˆ—è¡¨çš„åŠŸèƒ½ï¼Œç‰¹æ®Šä¹‹å¤„åœ¨äºsetæ˜¯å¯ä»¥è‡ªåŠ¨æ’é‡çš„ï¼Œå½“ä½ éœ€è¦å­˜å‚¨ä¸€ä¸ªåˆ—è¡¨æ•°æ®ï¼Œåˆä¸å¸Œæœ›å‡ºç°é‡å¤æ•°æ®æ—¶ï¼Œsetæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p> <p>å¹¶ä¸”setæä¾›äº†åˆ¤æ–­æŸä¸ªæˆå‘˜æ˜¯å¦åœ¨ä¸€ä¸ªseté›†åˆå†…çš„é‡è¦æ¥å£ï¼Œè¿™ä¸ªä¹Ÿæ˜¯listæ‰€ä¸èƒ½æä¾›çš„ã€‚</p> <p>Redisçš„setæ˜¯stringç±»å‹çš„æ— åºé›†åˆã€‚å®ƒåº•å±‚å…¶å®æ˜¯ä¸€ä¸ªvalueä¸ºnullçš„hashè¡¨ï¼Œæ‰€ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½æ˜¯O(1)ã€‚</p> <p>ä¸€ä¸ªç®—æ³•ï¼Œéšç€æ•°æ®çš„å¢åŠ ï¼Œæ‰§è¡Œæ—¶é—´çš„é•¿çŸ­ï¼Œå¦‚æœæ˜¯O(1)ï¼Œæ•°æ®å¢åŠ ï¼ŒæŸ¥æ‰¾æ•°æ®çš„æ—¶é—´ä¸å˜</p></blockquote> <h4 id="å¸¸ç”¨å‘½ä»¤-2"><a href="#å¸¸ç”¨å‘½ä»¤-2" class="header-anchor">#</a> å¸¸ç”¨å‘½ä»¤</h4> <ul><li><p>sadd[key] [value1] [value2] å°†ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ åŠ å…¥åˆ°é›†åˆkeyä¸­</p></li> <li><p>smembers[key] å–å‡ºè¯¥é›†åˆçš„æ‰€æœ‰å€¼</p></li> <li><p>sismember[key] [value] åˆ¤æ–­é›†åˆkeyæ˜¯å«æœ‰è¯¥valueï¼Œæœ‰ä¸º1ï¼Œæ²¡æœ‰ä¸º0</p></li> <li><p>scard[key] è¿”å›è¯¥é›†åˆçš„å…ƒç´ ä¸ªæ•°</p></li> <li><p>srem[key] [value1] [value2]..åˆ é™¤é›†åˆä¸­çš„æŸ(å‡ )ä¸ªå…ƒç´ </p></li> <li><p>spop[key] [n]éšæœºä»è¯¥é›†åˆä¸­åå‡ºnä¸ªå€¼ï¼Œä¸åŠ né»˜è®¤åå‡ºä¸€ä¸ªï¼Œå³æ‹¿å‡ºï¼Œä¼šä»é›†åˆä¸­åˆ é™¤</p></li> <li><p>srandmember[key] [n]éšæœºä»è¯¥é›†åˆä¸­å–å‡ºnä¸ªå€¼ï¼Œä¸ä¼šä»é›†åˆä¸­åˆ é™¤</p></li> <li><p>smove[source] [destination] value æŠŠé›†åˆsourceä¸­çš„å€¼ä¸ºvalueçš„å…ƒç´ ç§»åŠ¨åˆ°é›†åˆdestinationä¸­</p></li> <li><p>sinter[key1] [key2] è¿”å›ä¸¤ä¸ªé›†åˆçš„äº¤é›†å…ƒç´ </p></li> <li><p>sunion[key1] [key2] è¿”å›ä¸¤ä¸ªé›†åˆçš„å¹¶é›†å…ƒç´ </p></li> <li><p>sdiff[key1] [key2] è¿”å›ä¸¤ä¸ªé›†åˆçš„å·®é›†å…ƒç´ (key1ä¸­æœ‰çš„ï¼Œkey2ä¸­æ²¡æœ‰çš„)</p></li></ul> <h4 id="setçš„æ•°æ®ç»“æ„"><a href="#setçš„æ•°æ®ç»“æ„" class="header-anchor">#</a> setçš„æ•°æ®ç»“æ„</h4> <blockquote><p>setçš„æ•°æ®ç»“æ„æ˜¯dict(dictionary)å­—å…¸ï¼Œå­—å…¸æ˜¯ç”¨å“ˆå¸Œè¡¨å®ç°çš„</p> <p>Javaä¸­ HashSetçš„å†…éƒ¨å®ç°ä½¿ç”¨çš„æ˜¯ HashMapï¼Œåªä¸è¿‡æ‰€æœ‰çš„valueéƒ½æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚</p> <p>Redisçš„setç»“æ„ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå®ƒçš„å†…éƒ¨ä¹Ÿä½¿ç”¨hashç»“æ„ï¼Œæ‰€æœ‰çš„valueéƒ½æŒ‡å‘åŒä¸€ä¸ªå†…éƒ¨å€¼ã€‚</p></blockquote> <h3 id="æœ‰åºé›†åˆzset"><a href="#æœ‰åºé›†åˆzset" class="header-anchor">#</a> æœ‰åºé›†åˆzset</h3> <h4 id="æ¦‚è¿°-4"><a href="#æ¦‚è¿°-4" class="header-anchor">#</a> æ¦‚è¿°</h4> <blockquote><p>Redisæœ‰åºé›†åˆzsetä¸æ™®é€šé›†åˆsetéå¸¸ç›¸ä¼¼ï¼Œæ˜¯ä¸€ä¸ªæ²¡æœ‰é‡å¤å…ƒç´ çš„å­—ç¬¦ä¸²é›†åˆã€‚Â·
ä¸åŒä¹‹å¤„æ˜¯æœ‰åºé›†åˆçš„æ¯ä¸ªæˆå‘˜éƒ½å…³è”äº†ä¸€ä¸ªè¯„åˆ†(score),è¿™ä¸ªè¯„åˆ†(score)è¢«ç”¨æ¥æŒ‰ç…§ä»æœ€ä½åˆ†åˆ°æœ€é«˜åˆ†çš„æ–¹å¼æ’åºé›†åˆä¸­çš„æˆå‘˜ã€‚é›†åˆçš„æˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯è¯„åˆ†å¯ä»¥æ˜¯é‡å¤äº†ã€‚
å› ä¸ºå…ƒç´ æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥ä½ ä¹Ÿå¯ä»¥å¾ˆå¿«çš„æ ¹æ®è¯„åˆ†(score)æˆ–è€…æ¬¡åº(position)æ¥è·å–ä¸€ä¸ªèŒƒå›´çš„å…ƒç´ ã€‚
è®¿é—®æœ‰åºé›†åˆçš„ä¸­é—´å…ƒç´ ä¹Ÿæ˜¯éå¸¸å¿«çš„,å› æ­¤ä½ èƒ½å¤Ÿä½¿ç”¨æœ‰åºé›†åˆä½œä¸ºä¸€ä¸ªæ²¡æœ‰é‡å¤æˆå‘˜çš„æ™ºèƒ½åˆ—è¡¨ã€‚</p></blockquote> <h4 id="å¸¸ç”¨å‘½ä»¤-3"><a href="#å¸¸ç”¨å‘½ä»¤-3" class="header-anchor">#</a> å¸¸ç”¨å‘½ä»¤</h4> <ul><li><p>zadd[key] [score1] [value1] [score2] [value2]...ï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ªmemberå…ƒç´ åŠå…¶scoreå€¼åŠ å…¥åˆ°æœ‰åºé›†åˆkeyä¸­</p></li> <li><p>zrange[key] [start] [stop] [WAHTSCORES]ï¼šè¿”å›æœ‰åºç»“åˆä¸­ï¼Œä¸‹æ ‡åœ¨startå’Œtopä¹‹é—´çš„å…ƒç´ ,å¸¦WAHTSCORESå¯ä»¥è®©scoreå’Œå€¼ä¸€èµ·è¿”å›ã€‚stopä¸º-1æ—¶è¿”å›æ‰€æœ‰æ•°æ®</p></li> <li><p>zrangebyscore key minmax[withscores] [limit offset count]ï¼šè¿”å›æœ‰åºé›†åˆkeyä¸­ï¼Œæ‰€æœ‰scoreå€¼ä»‹äºminå’Œmaxä¹‹é—´(åŒ…æ‹¬ç­‰äºminå’Œmax)çš„æˆå‘˜ã€‚æœ‰åºé›†åˆæŒ‰scoreå€¼é€’å¢æ’åº(ä»å°åˆ°å¤§)</p></li> <li><p>zrevrangebyscore key maxmin[withscores] [limit offset count]ï¼šåŒä¸Šï¼Œæ’åºæ–¹å¼æ”¹ä¸ºä»å¤§åˆ°å°</p></li> <li><p>zincrby[key] [increment] [value] ä¸ºå…ƒç´ çš„scoreåŠ ä¸Šå¢é‡</p></li> <li><p>zrem[key] [value]åˆ é™¤è¯¥é›†åˆä¸‹ï¼ŒæŒ‡å®šå€¼çš„å…ƒç´ </p></li> <li><p>zcount[key] [min] [max]ç»Ÿè®¡è¯¥é›†åˆçš„å…ƒç´ scoreåœ¨åŒºé—´[min,max]ä¹‹é—´çš„å…ƒç´ ä¸ªæ•°</p></li> <li><p>zrank[key] [value] è¿”å›è¯¥å€¼åœ¨é›†åˆä¸­çš„æ’åï¼Œä»0å¼€å§‹</p></li></ul> <p>æ¡ˆä¾‹ï¼šå¦‚ä½•åˆ©ç”¨zsetå®ç°ä¸€ä¸ªæ–‡ç« è®¿é—®é‡çš„æ’è¡Œæ¦œ</p> <h4 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="header-anchor">#</a> æ•°æ®ç»“æ„</h4> <blockquote><p>SortedSet(zset)æ˜¯Redisæä¾›çš„ä¸€ä¸ªéå¸¸ç‰¹åˆ«çš„æ•°æ®ç»“æ„ï¼Œä¸€æ–¹é¢å®ƒç­‰ä»·äºJavaçš„æ•°æ®ç»“æ„Map&lt;Stringï¼ŒDouble&gt;ï¼Œå¯ä»¥ç»™æ¯ä¸€ä¸ªå…ƒç´ valueèµ‹äºˆä¸€ä¸ªæƒé‡scoreï¼Œå¦ä¸€æ–¹é¢å®ƒåˆç±»ä¼¼äºTreeSetï¼Œå†…éƒ¨çš„å…ƒç´ ä¼šæŒ‰ç…§æƒé‡scoreè¿›è¡Œæ’åºï¼Œå¯ä»¥å¾—åˆ°æ¯ä¸ªå…ƒç´ çš„åæ¬¡ï¼Œè¿˜å¯ä»¥é€šè¿‡scoreçš„èŒƒå›´æ¥è·å–å…ƒç´ çš„åˆ—è¡¨ã€‚
zsetåº•å±‚ä½¿ç”¨äº†ä¸¤ä¸ªæ•°æ®ç»“æ„
(1) hash ,hashçš„ä½œç”¨å°±æ˜¯å…³è”å…ƒç´ valueå’Œæƒé‡scoreï¼Œä¿éšœå…ƒç´ valueçš„å”¯ä¸€æ€§ï¼Œå¯ä»¥é€šè¿‡å…ƒç´ valueæ‰¾åˆ°ç›¸åº”çš„scoreå€¼ã€‚
(2ï¼‰è·³è·ƒè¡¨ï¼Œè·³è·ƒè¡¨çš„ç›®çš„åœ¨äºç»™å…ƒç´ valueæ’åºï¼Œæ ¹æ®scoreçš„èŒƒå›´è·å–å…ƒç´ åˆ—è¡¨ã€‚</p></blockquote> <h4 id="æœ‰åºé›†åˆzsetåº•å±‚å®ç°ä¹‹è·³è·ƒè¡¨"><a href="#æœ‰åºé›†åˆzsetåº•å±‚å®ç°ä¹‹è·³è·ƒè¡¨" class="header-anchor">#</a> æœ‰åºé›†åˆzsetåº•å±‚å®ç°ä¹‹è·³è·ƒè¡¨</h4> <p><img src="https://images.zaiolos.top/images/image-20211101133155477.png" alt="image-20211101133155477"></p> <div class="custom-block tip"><p class="custom-block-title">æ¦‚å¿µ</p> <p>è·³è·ƒè¡¨ï¼ˆskiplistï¼‰æ˜¯ä¸€ç§æœ‰åºæ•°æ®ç»“æ„ï¼Œå®ƒé€šè¿‡åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸­ç»´æŒå¤šä¸ªæŒ‡å‘å…¶å®ƒèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä»è€Œè¾¾åˆ°å¿«é€Ÿè®¿é—®èŠ‚ç‚¹çš„ç›®çš„ã€‚å…·æœ‰å¦‚ä¸‹æ€§è´¨ï¼š</p> <ol><li>ç”±å¾ˆå¤šå±‚ç»“æ„ç»„æˆï¼›</li> <li>æ¯ä¸€å±‚éƒ½æ˜¯ä¸€ä¸ªæœ‰åºçš„é“¾è¡¨ï¼Œæ’åˆ—é¡ºåºä¸ºç”±é«˜å±‚åˆ°åº•å±‚ï¼Œéƒ½è‡³å°‘åŒ…å«ä¸¤ä¸ªé“¾è¡¨èŠ‚ç‚¹ï¼Œåˆ†åˆ«æ˜¯å‰é¢çš„headèŠ‚ç‚¹å’Œåé¢çš„nilèŠ‚ç‚¹ï¼›</li> <li>æœ€åº•å±‚çš„é“¾è¡¨åŒ…å«äº†æ‰€æœ‰çš„å…ƒç´ ï¼›</li> <li>å¦‚æœä¸€ä¸ªå…ƒç´ å‡ºç°åœ¨æŸä¸€å±‚çš„é“¾è¡¨ä¸­ï¼Œé‚£ä¹ˆåœ¨è¯¥å±‚ä¹‹ä¸‹çš„é“¾è¡¨ä¹Ÿå…¨éƒ½ä¼šå‡ºç°ï¼ˆä¸Šä¸€å±‚çš„å…ƒç´ æ˜¯å½“å‰å±‚çš„å…ƒç´ çš„å­é›†ï¼‰ï¼›</li> <li>é“¾è¡¨ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡å‘åŒä¸€å±‚çš„ä¸‹ä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€å±‚çš„åŒä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹ï¼›</li></ol> <p><img src="https://images.zaiolos.top/images/image-20220426203950581.png" alt="image-20220426203950581"></p></div> <p>Redisä¸­è·³è·ƒè¡¨ç»“ç‚¹çš„å®šä¹‰å¦‚ä¸‹ï¼š</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token punctuation">{</span>
     <span class="token comment">//å±‚</span>
     <span class="token keyword">struct</span> <span class="token class-name">zskiplistLevel</span><span class="token punctuation">{</span>
           <span class="token comment">//å‰è¿›æŒ‡é’ˆ</span>
           <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>forward<span class="token punctuation">;</span>
           <span class="token comment">//è·¨åº¦</span>
           <span class="token keyword">unsigned</span> <span class="token keyword">int</span> span<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>level<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
     <span class="token comment">//åé€€æŒ‡é’ˆ</span>
     <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>backward<span class="token punctuation">;</span>
     <span class="token comment">//åˆ†å€¼</span>
     <span class="token keyword">double</span> score<span class="token punctuation">;</span>
     <span class="token comment">//æˆå‘˜å¯¹è±¡</span>
     robj <span class="token operator">*</span>obj<span class="token punctuation">;</span>
 
<span class="token punctuation">}</span> zskiplistNode
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>å¤šä¸ªè·³è·ƒè¡¨ç»“ç‚¹æ„æˆä¸€ä¸ªè·³è·ƒè¡¨ï¼š</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zskiplist</span><span class="token punctuation">{</span>
     <span class="token comment">//è¡¨å¤´èŠ‚ç‚¹å’Œè¡¨å°¾èŠ‚ç‚¹</span>
     structz skiplistNode <span class="token operator">*</span>header<span class="token punctuation">,</span> <span class="token operator">*</span>tail<span class="token punctuation">;</span>
     <span class="token comment">//è¡¨ä¸­èŠ‚ç‚¹çš„æ•°é‡</span>
     <span class="token keyword">unsigned</span> <span class="token keyword">long</span> length<span class="token punctuation">;</span>
     <span class="token comment">//è¡¨ä¸­å±‚æ•°æœ€å¤§çš„èŠ‚ç‚¹çš„å±‚æ•°</span>
     <span class="token keyword">int</span> level<span class="token punctuation">;</span>
<span class="token punctuation">}</span>zskiplist<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><img src="https://images.zaiolos.top/images/image-20220426204054792.png" alt="image-20220426204054792"></p> <div class="custom-block tip"><p class="custom-block-title">æ“ä½œ</p> <ol><li>æœç´¢ï¼šä»æœ€é«˜å±‚çš„é“¾è¡¨èŠ‚ç‚¹å¼€å§‹ï¼Œå¦‚æœæ¯”å½“å‰èŠ‚ç‚¹è¦å¤§å’Œæ¯”å½“å‰å±‚çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹è¦å°ï¼Œé‚£ä¹ˆåˆ™å¾€ä¸‹æ‰¾ï¼Œä¹Ÿå°±æ˜¯å’Œå½“å‰å±‚çš„ä¸‹ä¸€å±‚çš„èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼Œä»¥æ­¤ç±»æ¨ï¼Œä¸€ç›´æ‰¾åˆ°æœ€åº•å±‚çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å›ï¼Œåä¹‹åˆ™è¿”å›ç©ºã€‚</li> <li>æ’å…¥ï¼šé¦–å…ˆç¡®å®šæ’å…¥çš„å±‚æ•°ï¼Œæœ‰ä¸€ç§æ–¹æ³•æ˜¯å‡è®¾æŠ›ä¸€æšç¡¬å¸ï¼Œå¦‚æœæ˜¯æ­£é¢å°±ç´¯åŠ ï¼Œç›´åˆ°é‡è§åé¢ä¸ºæ­¢ï¼Œæœ€åè®°å½•æ­£é¢çš„æ¬¡æ•°ä½œä¸ºæ’å…¥çš„å±‚æ•°ã€‚å½“ç¡®å®šæ’å…¥çš„å±‚æ•°kåï¼Œåˆ™éœ€è¦å°†æ–°å…ƒç´ æ’å…¥åˆ°ä»åº•å±‚åˆ°kå±‚</li> <li>åˆ é™¤ï¼šåœ¨å„ä¸ªå±‚ä¸­æ‰¾åˆ°åŒ…å«æŒ‡å®šå€¼çš„èŠ‚ç‚¹ï¼Œç„¶åå°†èŠ‚ç‚¹ä»é“¾è¡¨ä¸­åˆ é™¤å³å¯ï¼Œå¦‚æœåˆ é™¤ä»¥ååªå‰©ä¸‹å¤´å°¾ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œåˆ™åˆ é™¤è¿™ä¸€å±‚</li></ol></div> <h3 id="hash"><a href="#hash" class="header-anchor">#</a> hash</h3> <p>key item value</p> <p>å‘½ä»¤ï¼š</p> <ul><li>hdel key field1 [field2] åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå“ˆå¸Œè¡¨å­—æ®µ</li> <li>hexists key field  æŸ¥çœ‹å“ˆå¸Œè¡¨ key ä¸­ï¼ŒæŒ‡å®šçš„å­—æ®µæ˜¯å¦å­˜åœ¨ã€‚</li> <li>hget key field  è·å–å­˜å‚¨åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®šå­—æ®µçš„å€¼ã€‚</li> <li>hgetall key  è·å–åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®š key çš„æ‰€æœ‰å­—æ®µå’Œå€¼</li> <li>hincrby key field increment ä¸ºå“ˆå¸Œè¡¨keyä¸­çš„æŒ‡å®šå­—æ®µçš„æ•´æ•°å€¼åŠ ä¸Šå¸¸é‡increment</li> <li>hincrbyfloat key field increment  ä¸ºå“ˆå¸Œè¡¨ key ä¸­çš„æŒ‡å®šå­—æ®µçš„æµ®ç‚¹æ•°å€¼åŠ ä¸Šå¢é‡ increment ã€‚</li> <li>hkeys key è·å–å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰å­—æ®µ</li> <li>hlen key è·å–å“ˆå¸Œè¡¨ä¸­å­—æ®µçš„æ•°é‡</li> <li>hmget key field1 [field2] è·å–æ‰€æœ‰ç»™å®šå­—æ®µçš„å€¼</li> <li>hmset key field1 value [field2 value2]  åŒæ—¶å°†å¤šä¸ª field-value (åŸŸ-å€¼)å¯¹è®¾ç½®åˆ°å“ˆå¸Œè¡¨ key ä¸­ã€‚</li> <li>hset key field value å°†å“ˆå¸Œè¡¨ key ä¸­çš„å­—æ®µ field çš„å€¼è®¾ä¸º value</li> <li>hsetnx key field value  åªæœ‰åœ¨å­—æ®µ field ä¸å­˜åœ¨æ—¶ï¼Œè®¾ç½®å“ˆå¸Œè¡¨å­—æ®µçš„å€¼ã€‚</li> <li>hvals key è·å–å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰å€¼</li> <li>hscan key cursor [MATCH pattern] [COUNT count]  è¿­ä»£å“ˆå¸Œè¡¨ä¸­çš„é”®å€¼å¯¹</li></ul> <h4 id="åº•å±‚ç»“æ„"><a href="#åº•å±‚ç»“æ„" class="header-anchor">#</a> åº•å±‚ç»“æ„</h4> <span class="badge tip" style="vertical-align:top;" data-v-d5affa18>Redis çš„å­—å…¸ä½¿ç”¨å“ˆå¸Œè¡¨ä½œä¸ºåº•å±‚å®ç°</span> <p>å“ˆå¸Œè¡¨ç»“æ„å®šä¹‰ï¼š</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dictht</span><span class="token punctuation">{</span>
     <span class="token comment">//å“ˆå¸Œè¡¨æ•°ç»„</span>
     dictEntry <span class="token operator">*</span><span class="token operator">*</span>table<span class="token punctuation">;</span>
     <span class="token comment">//å“ˆå¸Œè¡¨å¤§å°</span>
     <span class="token keyword">unsigned</span> <span class="token keyword">long</span> size<span class="token punctuation">;</span>
     <span class="token comment">//å“ˆå¸Œè¡¨å¤§å°æ©ç ï¼Œç”¨äºè®¡ç®—ç´¢å¼•å€¼</span>
     <span class="token comment">//æ€»æ˜¯ç­‰äº size-1</span>
     <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sizemask<span class="token punctuation">;</span>
     <span class="token comment">//è¯¥å“ˆå¸Œè¡¨å·²æœ‰èŠ‚ç‚¹çš„æ•°é‡</span>
     <span class="token keyword">unsigned</span> <span class="token keyword">long</span> used<span class="token punctuation">;</span>
<span class="token punctuation">}</span>dictht
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>å“ˆå¸Œè¡¨æ˜¯ç”±æ•°ç»„ table ç»„æˆï¼Œtable ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯æŒ‡å‘ dictEntry ç»“æ„ï¼ŒdictEntry ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dictEntry</span><span class="token punctuation">{</span>
     <span class="token comment">//é”®</span>
     <span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">;</span>
     <span class="token comment">//å€¼</span>
     <span class="token keyword">union</span><span class="token punctuation">{</span>
          <span class="token keyword">void</span> <span class="token operator">*</span>val<span class="token punctuation">;</span>
          uint64_tu64<span class="token punctuation">;</span>
          int64_ts64<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>v<span class="token punctuation">;</span>
     <span class="token comment">//æŒ‡å‘ä¸‹ä¸€ä¸ªå“ˆå¸Œè¡¨èŠ‚ç‚¹ï¼Œå½¢æˆé“¾è¡¨</span>
     <span class="token keyword">struct</span> <span class="token class-name">dictEntry</span> <span class="token operator">*</span>next<span class="token punctuation">;</span>
<span class="token punctuation">}</span>dictEntry
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>key ç”¨æ¥ä¿å­˜é”®ï¼Œval å±æ€§ç”¨æ¥ä¿å­˜å€¼ï¼Œå€¼å¯ä»¥æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œä¹Ÿå¯ä»¥æ˜¯uint64_tæ•´æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯int64_tæ•´æ•°</p> <blockquote><p>æ³¨æ„è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå“ˆå¸Œè¡¨èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬çŸ¥é“å“ˆå¸Œè¡¨æœ€å¤§çš„é—®é¢˜æ˜¯å­˜åœ¨å“ˆå¸Œå†²çªï¼Œå¦‚ä½•è§£å†³å“ˆå¸Œå†²çªï¼Œæœ‰å¼€æ”¾åœ°å€æ³•å’Œé“¾åœ°å€æ³•ã€‚è¿™é‡Œé‡‡ç”¨çš„ä¾¿æ˜¯é“¾åœ°å€æ³•ï¼Œé€šè¿‡nextè¿™ä¸ªæŒ‡é’ˆå¯ä»¥å°†å¤šä¸ªå“ˆå¸Œå€¼ç›¸åŒçš„é”®å€¼å¯¹è¿æ¥åœ¨ä¸€èµ·ï¼Œç”¨æ¥è§£å†³<strong>å“ˆå¸Œå†²çª</strong></p></blockquote> <p>è¿åœ¨ä¸€èµ·çš„é”®K1å’Œé”®K0</p> <p><img src="https://images.zaiolos.top/images/image-20220426203100321.png" alt="image-20220426203100321"></p> <ol><li><p>**å“ˆå¸Œç®—æ³•ï¼š**Redisè®¡ç®—å“ˆå¸Œå€¼å’Œç´¢å¼•å€¼æ–¹æ³•å¦‚ä¸‹ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#1ã€ä½¿ç”¨å­—å…¸è®¾ç½®çš„å“ˆå¸Œå‡½æ•°ï¼Œè®¡ç®—é”® key çš„å“ˆå¸Œå€¼</span>
<span class="token builtin class-name">hash</span> <span class="token operator">=</span> dict-<span class="token operator">&gt;</span>type-<span class="token operator">&gt;</span>hashFunction<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">#2ã€ä½¿ç”¨å“ˆå¸Œè¡¨çš„sizemaskå±æ€§å’Œç¬¬ä¸€æ­¥å¾—åˆ°çš„å“ˆå¸Œå€¼ï¼Œè®¡ç®—ç´¢å¼•å€¼</span>
index <span class="token operator">=</span> <span class="token builtin class-name">hash</span> <span class="token operator">&amp;</span> dict-<span class="token operator">&gt;</span>ht<span class="token punctuation">[</span>x<span class="token punctuation">]</span>.sizemask<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>**è§£å†³å“ˆå¸Œå†²çªï¼š**æ–¹æ³•æ˜¯é“¾åœ°å€æ³•ã€‚é€šè¿‡å­—å…¸é‡Œé¢çš„ *next æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªå…·æœ‰ç›¸åŒç´¢å¼•å€¼çš„å“ˆå¸Œè¡¨èŠ‚ç‚¹</p></li> <li><p>**æ‰©å®¹å’Œæ”¶ç¼©ï¼š**å½“å“ˆå¸Œè¡¨ä¿å­˜çš„é”®å€¼å¯¹å¤ªå¤šæˆ–è€…å¤ªå°‘æ—¶ï¼Œå°±è¦é€šè¿‡ rerehash(é‡æ–°æ•£åˆ—ï¼‰æ¥å¯¹å“ˆå¸Œè¡¨è¿›è¡Œç›¸åº”çš„æ‰©å±•æˆ–è€…æ”¶ç¼©ã€‚å…·ä½“æ­¥éª¤ï¼š</p> <ul><li>å¦‚æœæ‰§è¡Œæ‰©å±•æ“ä½œï¼Œä¼šåŸºäºåŸå“ˆå¸Œè¡¨åˆ›å»ºä¸€ä¸ªå¤§å°ç­‰äº ht[0].used*2n çš„å“ˆå¸Œè¡¨ï¼ˆä¹Ÿå°±æ˜¯æ¯æ¬¡æ‰©å±•éƒ½æ˜¯æ ¹æ®åŸå“ˆå¸Œè¡¨å·²ä½¿ç”¨çš„ç©ºé—´æ‰©å¤§ä¸€å€åˆ›å»ºå¦ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼‰ã€‚ç›¸åå¦‚æœæ‰§è¡Œçš„æ˜¯æ”¶ç¼©æ“ä½œï¼Œæ¯æ¬¡æ”¶ç¼©æ˜¯æ ¹æ®å·²ä½¿ç”¨ç©ºé—´ç¼©å°ä¸€å€åˆ›å»ºä¸€ä¸ªæ–°çš„å“ˆå¸Œè¡¨</li> <li>é‡æ–°åˆ©ç”¨ä¸Šé¢çš„å“ˆå¸Œç®—æ³•ï¼Œè®¡ç®—ç´¢å¼•å€¼ï¼Œç„¶åå°†é”®å€¼å¯¹æ”¾åˆ°æ–°çš„å“ˆå¸Œè¡¨ä½ç½®ä¸Š</li> <li>æ‰€æœ‰é”®å€¼å¯¹éƒ½è¿å¾™å®Œæ¯•åï¼Œé‡Šæ”¾åŸå“ˆå¸Œè¡¨çš„å†…å­˜ç©ºé—´</li></ul></li> <li><p><strong>è§¦å‘æ‰©å®¹çš„æ¡ä»¶ï¼š</strong></p> <ul><li><p>æœåŠ¡å™¨ç›®å‰æ²¡æœ‰æ‰§è¡Œ BGSAVE å‘½ä»¤æˆ–è€… BGREWRITEAOF å‘½ä»¤ï¼Œå¹¶ä¸”è´Ÿè½½å› å­å¤§äºç­‰äº1</p></li> <li><p>æœåŠ¡å™¨ç›®å‰æ­£åœ¨æ‰§è¡Œ BGSAVE å‘½ä»¤æˆ–è€… BGREWRITEAOF å‘½ä»¤ï¼Œå¹¶ä¸”è´Ÿè½½å› å­å¤§äºç­‰äº5</p> <p><code>psï¼šè´Ÿè½½å› å­ = å“ˆå¸Œè¡¨å·²ä¿å­˜èŠ‚ç‚¹æ•°é‡ / å“ˆå¸Œè¡¨å¤§å°</code></p></li></ul></li> <li><p><strong>æ¸è¿‘å¼ rehash</strong></p> <blockquote><p>æ¸è¿‘å¼ rehashï¼Œæ‰©å®¹å’Œæ”¶ç¼©æ“ä½œä¸æ˜¯ä¸€æ¬¡æ€§ã€é›†ä¸­å¼å®Œæˆçš„ï¼Œè€Œæ˜¯åˆ†å¤šæ¬¡ã€æ¸è¿›å¼å®Œæˆçš„ã€‚å¦‚æœä¿å­˜åœ¨Redisä¸­çš„é”®å€¼å¯¹åªæœ‰å‡ ä¸ªå‡ åä¸ªï¼Œé‚£ä¹ˆ rehash æ“ä½œå¯ä»¥ç¬é—´å®Œæˆï¼Œä½†æ˜¯å¦‚æœé”®å€¼å¯¹æœ‰å‡ ç™¾ä¸‡ï¼Œå‡ åƒä¸‡ç”šè‡³å‡ äº¿ï¼Œé‚£ä¹ˆè¦ä¸€æ¬¡æ€§çš„è¿›è¡Œ rehashï¼ŒåŠ¿å¿…ä¼šé€ æˆRedisä¸€æ®µæ—¶é—´å†…ä¸èƒ½è¿›è¡Œåˆ«çš„æ“ä½œã€‚æ‰€ä»¥Redisé‡‡ç”¨æ¸è¿›å¼ rehash,è¿™æ ·åœ¨è¿›è¡Œæ¸è¿›å¼rehashæœŸé—´ï¼Œå­—å…¸çš„åˆ é™¤æŸ¥æ‰¾æ›´æ–°ç­‰æ“ä½œå¯èƒ½ä¼šåœ¨ä¸¤ä¸ªå“ˆå¸Œè¡¨ä¸Šè¿›è¡Œï¼Œç¬¬ä¸€ä¸ªå“ˆå¸Œè¡¨æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ä¼šå»ç¬¬äºŒä¸ªå“ˆå¸Œè¡¨ä¸Šè¿›è¡ŒæŸ¥æ‰¾ã€‚ä½†æ˜¯è¿›è¡Œ å¢åŠ æ“ä½œï¼Œä¸€å®šæ˜¯åœ¨æ–°çš„å“ˆå¸Œè¡¨ä¸Šè¿›è¡Œçš„</p></blockquote></li></ol> <h3 id="redisé…ç½®æ–‡ä»¶è¯¦è§£"><a href="#redisé…ç½®æ–‡ä»¶è¯¦è§£" class="header-anchor">#</a> Redisé…ç½®æ–‡ä»¶è¯¦è§£</h3> <ul><li><p>portï¼šç«¯å£å·ï¼Œé»˜è®¤6379</p></li> <li><p>tcp-backlog</p> <blockquote><p>è®¾ç½®tcpçš„backlog,backlogå…¶å®æ˜¯ä¸€ä¸ªè¿æ¥é˜Ÿåˆ—ï¼Œbacklogé˜Ÿåˆ—æ€»å’Œ=æœªå®Œæˆä¸‰æ¬¡æ¡æ‰‹é˜Ÿåˆ—ï¼‹å·²ç»å®Œæˆä¸‰æ¬¡æ¡æ‰‹é˜Ÿåˆ—ã€‚
åœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹ä½ éœ€è¦ä¸€ä¸ªé«˜backlogå€¼æ¥é¿å…æ…¢å®¢æˆ·ç«¯è¿æ¥é—®é¢˜ã€‚u
æ³¨æ„Linuxå†…æ ¸ä¼šå°†è¿™ä¸ªå€¼å‡å°åˆ°/proc/sys/net/core/somaxconnçš„å€¼(128ï¼‰ï¼Œæ‰€ä»¥éœ€è¦ç¡®è®¤å¢å¤§/proc/sys/net/core/somaxconnå’Œ/proc/sys/net/ipv4/tcp_max_syn_backlog(128)ä¸¤ä¸ªå€¼æ¥è¾¾åˆ°æƒ³è¦çš„æ•ˆæœ</p></blockquote></li></ul> <h3 id="redisæ–°æ•°æ®ç±»å‹"><a href="#redisæ–°æ•°æ®ç±»å‹" class="header-anchor">#</a> Redisæ–°æ•°æ®ç±»å‹</h3> <h4 id="bitmaps"><a href="#bitmaps" class="header-anchor">#</a> Bitmaps</h4> <ol><li><p>ç®€ä»‹</p> <p><img src="https://images.zaiolos.top/images/image-20211101133201992.png" alt="image-20211101133201992"></p> <ol start="2"><li><p>å¸¸ç”¨å‘½ä»¤</p> <ul><li><p>setbit[key] [offset] [value] è®¾bitmapsä¸­æŸä¸ªåç§»é‡çš„å€¼ä¸º0æˆ–1.offsetï¼šåç§»é‡ä»0å¼€å§‹</p> <p><img src="https://images.zaiolos.top/images/image-20211101133208197.png" alt="image-20211101133208197"></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>æ³¨æ„ï¼šå¾ˆå¤šåº”ç”¨çš„ç”¨æˆ·idä»¥ä¸€ä¸ªæŒ‡å®šæ•°å­—ï¼ˆä¾‹å¦‚10000 ï¼‰å¼€å¤´ï¼Œç›´æ¥å°†ç”¨æˆ·idå’ŒBitmapsçš„åç§»é‡å¯¹åº”åŠ¿å¿…ä¼šé€ æˆä¸€å®šçš„æµªè´¹ï¼Œé€šå¸¸çš„åšæ³•æ˜¯æ¯æ¬¡åšsetbit æ“ä½œæ—¶å°†ç”¨æˆ·idå‡å»è¿™ä¸ªæŒ‡å®šæ•°å­—ã€‚
åœ¨ç¬¬ä¸€æ¬¡åˆå§‹åŒ– Bitmapsæ—¶ï¼Œå‡å¦‚åç§»é‡éå¸¸å¤§ï¼Œé‚£ä¹ˆæ•´ä¸ªåˆå§‹åŒ–è¿‡ç¨‹æ‰§è¡Œä¼šæ¯”è¾ƒæ…¢ï¼Œå¯èƒ½ä¼šé€ æˆ Redisçš„é˜»å¡ã€‚
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>getbit[key] [offset] è·å–bitmapsä¸­ç¬¬åç§»é‡ä¸ºoffsetçš„å€¼(offsetä»0å¼€å§‹)</p></li> <li><p>bitcount[key] [start end]ï¼šç»Ÿè®¡å­—ç¬¦ä¸²è¢«è®¾ç½®ä¸º1çš„bitæ•°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç»™å®šçš„æ•´ä¸ªå­—ç¬¦ä¸²éƒ½ä¼šè¢«è¿›è¡Œè®¡æ•°ï¼Œé€šè¿‡æŒ‡å®šé¢å¤–çš„startå’Œendå‚æ•°å¯ä»¥è®©è®¡æ•°åªåœ¨ç‰¹å®šçš„ä½ä¹‹é—´è¿›è¡Œã€‚startå’Œendå‚æ•°çš„è®¾ç½®éƒ½å¯ä»¥ä½¿ç”¨è´Ÿæ•°å€¼ï¼Œæ¯”å¦‚-1è¡¨ç¤ºæœ€åä¸€ä¸ªä½ï¼Œ-2è¡¨ç¤ºå€’æ•°ç¬¬äºŒä¸ªä½ã€‚startã€endæ˜¯æŒ‡bitç»„çš„å­—èŠ‚çš„ä¸‹æ ‡æ•°ï¼Œ[start,end]å·¦å³çš†ä¸ºé—­åŒºé—´ã€‚[start,end]è¡¨ç¤ºæœ‰(end-start+1)8ä¸ªå­—èŠ‚ç©ºé—´ã€‚ä¾‹å¦‚[0,2]ï¼Œå³ä¸‹æ ‡åœ¨0~(2-0+1)*8-1=23ä¹‹é—´çš„ä¸‹æ ‡ä¸­ï¼Œå€¼ä¸º1çš„ä¸ªæ•°ã€‚</p></li> <li><p>bitop and(or/not/xor) [destkey] [key]ï¼šbitopæ˜¯ä¸€ä¸ªå¤åˆæ“ä½œï¼Œå®ƒå¯ä»¥åšå¤šä¸ªBitmapsçš„and(äº¤é›†ï¼‰ã€or(å¹¶é›†ï¼‰ ã€not(é) ã€ xorï¼ˆå¼‚æˆ–ï¼‰æ“ä½œå¹¶å°†ç»“æœä¿å­˜åœ¨destkeyä¸­ã€‚</p></li></ul></li> <li><p>setä¸bitmapå¯¹æ¯”</p> <p><img src="https://images.zaiolos.top/images/image-20211101133218544.png" alt="image-20211101133218544"> <img src="https://images.zaiolos.top/images/image-20211101133225425.png" alt="image-20211101133225425"> <img src="https://images.zaiolos.top/images/image-20211101133231200.png" alt="image-20211101133231200"></p></li></ol></li></ol> <h4 id="hyperloglog"><a href="#hyperloglog" class="header-anchor">#</a> HyperLogLog</h4> <ol><li><p>ç®€ä»‹</p> <p><img src="https://images.zaiolos.top/images/image-20211101133250834.png" alt="image-20211101133250834"> <img src="https://images.zaiolos.top/images/image-20211101133304014.png" alt="image-20211101133304014"></p> <p><img src="https://images.zaiolos.top/images/image-20211101133311498.png" alt="image-20211101133311498"></p></li> <li><p>å¸¸ç”¨å‘½ä»¤</p> <ul><li>pfadd[key] [element]...ï¼šæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ åˆ°HyperLogLogä¸­ã€‚æ‰§è¡Œå‘½ä»¤åå¦‚æœHLLä¼°è®¡çš„è¿‘ä¼¼åŸºæ•°å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è¿”å›1ï¼Œå¦åˆ™è¿”å›0
<ul><li>pfcount[key] [key]....ï¼šè®¡ç®—HLLçš„è¿‘ä¼¼åŸºæ•°ï¼Œå¯ä»¥è®¡ç®—å¤šä¸ª</li></ul></li> <li>pfmerge[destkey] [sourcekey] [sourcekey]....ï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ªHLLåˆå¹¶åçš„ç»“æœå­˜åœ¨å¦ä¸€ä¸ªHLL destkeyä¸­ã€‚æ¯”å¦‚æ¯æœˆæ´»è·ƒç”¨æˆ·å¯ä»¥ä½¿ç”¨æ¯å¤©çš„æ´»è·ƒç”¨æˆ·æ¥åˆå¹¶è®¡ç®—å‡ºæ¥</li></ul></li></ol> <h4 id="geospatial"><a href="#geospatial" class="header-anchor">#</a> Geospatial</h4> <ol><li><p>ç®€ä»‹</p> <p><img src="https://images.zaiolos.top/images/image-20211101133318417.png" alt="image-20211101133318417"></p></li> <li><p>åŸºæœ¬å‘½ä»¤</p> <ul><li><p>Geospatialåº•å±‚æ˜¯zsetï¼Œæ‰€ä»¥å¯ç”¨zsetçš„å‘½ä»¤å®ç°Geospatialè‡ªèº«å‘½ä»¤ä¸èƒ½å®ç°çš„æ“ä½œ(å¦‚åˆ é™¤æ“ä½œ)</p></li> <li><p>geoadd[key] [longitude] [latitude] [member] [longitude latitude member...]ï¼šæ·»åŠ åœ°ç†ä½ç½®(ç»åº¦ã€çº¬åº¦ã€åç§°)</p> <blockquote><p>ä¸¤ææ— æ³•ç›´æ¥æ·»åŠ ï¼Œä¸€èˆ¬ä¼šä¸‹è½½åŸå¸‚æ•°æ®ï¼Œç›´æ¥é€šè¿‡Javaç¨‹åºä¸€æ¬¡æ€§å¯¼å…¥
æœ‰æ•ˆçš„ç»åº¦ä»-180åº¦åˆ°180åº¦ã€‚æœ‰æ•ˆçš„çº¬åº¦ä»-85.05112878åº¦åˆ°85.05112878åº¦
å½“åæ ‡ä½ç½®è¶…å‡ºæŒ‡å®šèŒƒå›´æ—¶ï¼Œè¯¥å‘½ä»¤å°†ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯
å·²ç»æ·»åŠ çš„æ•°æ®ï¼Œæ˜¯æ— æ³•å†æ¬¡å¾€é‡Œé¢æ·»åŠ çš„</p></blockquote></li> <li><p>geopos[key] [member...]ï¼šè·å–ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šåœ°åŒºçš„åæ ‡å€¼</p></li> <li><p>geodis[key] [member1] [member2] [m|km|ft|mi]ï¼šè·å–ä¸¤ä¸ªä½ç½®ä¹‹é—´çš„ç›´çº¿è·ç¦»</p> <blockquote><p>mè¡¨ç¤ºå•ä½ä¸ºç±³(é»˜è®¤å€¼)
kmè¡¨ç¤ºå•ä½ä¸ºåƒç±³
miè¡¨ç¤ºå•ä½ä¸ºè‹±é‡Œ
ftè¡¨ç¤ºå•ä½ä¸ºè‹±å°º</p></blockquote></li> <li><p>georadius[key] [longitude] [latitude] radius [m|km|ft|mi]ï¼šæ‰¾å‡ºæŸä¸€åŠå¾„å†…çš„å…ƒç´ (ç»åº¦ çº¬åº¦ è·ç¦» å•ä½)</p></li></ul></li></ol> <h3 id="jedisè®¿é—®redisæ­¥éª¤"><a href="#jedisè®¿é—®redisæ­¥éª¤" class="header-anchor">#</a> jedisè®¿é—®redisæ­¥éª¤</h3> <ul><li><p>å…³é—­Linuxé˜²ç«å¢™æˆ–è€…å¼€æ”¾redisçš„ç«¯å£</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>firewall-cmd <span class="token parameter variable">--zone</span><span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">6379</span>/tcp --permanentå¼€å¯6379é˜²ç«å¢™
firewall-cmd --reloadï¼šé‡æ–°åŠ è½½é˜²ç«å¢™
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>è®°å¾—æ³¨é‡Šæ‰é…ç½®æ–‡ä»¶ä¸­çš„bind 127.0.0.1</p></li> <li><p>redis.confè®¾ç½®å¯†ç åï¼ŒæœåŠ¡ç«¯å¯åŠ¨æ—¶éœ€å¸¦ä¸Šredis.confå³æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>./redis-server redis.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>å®¢æˆ·ç«¯å¯åŠ¨æ—¶éœ€è¦ä½¿ç”¨-aå¸¦ä¸Šrequirpassçš„å¯†ç </p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>./redis-cli <span class="token parameter variable">-a</span> å¯†ç 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>ä½¿ç”¨jedisè¿æ¥æ—¶ï¼Œä¹Ÿéœ€è¦åŠ ä¸Šå¯†ç </p> <p><img src="https://images.zaiolos.top/images/image-20211101133324485.png" alt="image-20211101133324485"></p></li></ul> <h3 id="redisäº‹åŠ¡"><a href="#redisäº‹åŠ¡" class="header-anchor">#</a> redisäº‹åŠ¡</h3> <div class="custom-block note"><p class="custom-block-title">ç¬”è®°</p> <p>redisäº‹åŠ¡çš„æœ¬è´¨å°±æ˜¯ä¸€ç»„å‘½ä»¤çš„é›†åˆã€‚ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰€æœ‰çš„å‘½ä»¤éƒ½ä¼šè¢«åºåˆ—åŒ–(é¡ºåº)ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œ
å…·æœ‰ï¼šä¸€æ¬¡æ€§ã€é¡ºåºæ€§ã€æ’ä»–æ€§
rediså•æ¡å‘½ä»¤ä¿è¯åŸå­æ€§(å› ä¸ºredisæ˜¯å•çº¿ç¨‹)ï¼Œä½†äº‹åŠ¡ä¸ä¿è¯åŸå­æ€§</p></div> <p>è¿‡ç¨‹ï¼š</p> <ul><li><p>å¼€å¯äº‹åŠ¡ï¼šmulti</p> <p><img src="https://images.zaiolos.top/images/image-20211101133330639.png" alt="image-20211101133330639"></p></li> <li><p>å‘½ä»¤å…¥é˜Ÿï¼šè¾“å…¥ä¸€ç³»åˆ—å‘½ä»¤</p> <p><img src="https://images.zaiolos.top/images/image-20211101133335437.png" alt="image-20211101133335437"></p></li> <li><p>ä¸­é€”ä¹Ÿå¯å–æ¶ˆäº‹åŠ¡ï¼šä½¿ç”¨discardå‘½ä»¤</p> <p><img src="https://images.zaiolos.top/images/image-20211101133339820.png" alt="image-20211101133339820"></p></li> <li><p>æ‰§è¡Œäº‹åŠ¡ï¼šexec</p> <p><img src="https://images.zaiolos.top/images/image-20211101133346972.png" alt="image-20211101133346972"></p></li></ul> <h4 id="äº‹åŠ¡ä¸æ‰§è¡Œçš„æƒ…å†µ"><a href="#äº‹åŠ¡ä¸æ‰§è¡Œçš„æƒ…å†µ" class="header-anchor">#</a> äº‹åŠ¡ä¸æ‰§è¡Œçš„æƒ…å†µ</h4> <blockquote><p>å‡ºç°ç¼–è¯‘å‹å¼‚å¸¸(ä»£ç æœ‰é—®é¢˜å³å‘½ä»¤æœ¬èº«æœ‰é”™è¯¯)ï¼Œé‚£ä¹ˆäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¸ä¼šæ‰§è¡Œ</p></blockquote> <p><img src="https://images.zaiolos.top/images/image-20211101133427852.png" alt="image-20211101133427852">	å› ä¸ºé˜Ÿåˆ—ä¸­æœ‰ä¸€æ¬¡å‘½ä»¤å‡ºç°äº†è¯­æ³•é”™è¯¯ï¼Œæ‰€ä»¥æ‰€æœ‰å‘½ä»¤å‡æœªæ‰§è¡Œ</p> <blockquote><p>å‡ºç°è¿è¡Œæ—¶å¼‚å¸¸(å¦‚1/0è¿™ç§)ï¼Œå‡ºç°æ­¤ç§é”™è¯¯ï¼Œå…¶ä»–å‘½ä»¤ä»å¯æ­£å¸¸æ‰§è¡Œ</p></blockquote> <p><img src="https://images.zaiolos.top/images/image-20211101133435210.png" alt="image-20211101133435210"></p> <p>è¿™ç§é”™è¯¯å…¶ä»–å‘½ä»¤ä»å¯æ­£å¸¸æ‰§è¡Œ</p> <h4 id="ä¹è§‚é”å®ç°ç§’æ€ç³»ç»Ÿ"><a href="#ä¹è§‚é”å®ç°ç§’æ€ç³»ç»Ÿ" class="header-anchor">#</a> ä¹è§‚é”å®ç°ç§’æ€ç³»ç»Ÿ</h4> <div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <p>æˆ‘ä»¬çŸ¥é“å¤§å¤šæ•°æ˜¯åŸºäºæ•°æ®ç‰ˆæœ¬ï¼ˆ version )çš„è®°å½•æœºåˆ¶å®ç°çš„ã€‚å³ä¸ºæ•°æ®å¢åŠ ä¸€ä¸ªç‰ˆæœ¬æ ‡è¯†ï¼Œåœ¨åŸºäºæ•°æ®åº“è¡¨çš„ç‰ˆæœ¬è§£å†³æ–¹æ¡ˆä¸­ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ä¸ºæ•°æ®åº“è¡¨å¢åŠ ä¸€ä¸ª&quot;version&quot;å­—æ®µæ¥å®ç°è¯»å–å‡ºæ•°æ®æ—¶ï¼Œå°†æ­¤ç‰ˆæœ¬å·ä¸€åŒè¯»å‡ºï¼Œä¹‹åæ›´æ–°æ—¶ï¼Œå¯¹æ­¤ç‰ˆæœ¬å·åŠ 1ã€‚æ­¤æ—¶ï¼Œå°†æäº¤æ•°æ®çš„ç‰ˆæœ¬å·ä¸æ•°æ®åº“è¡¨å¯¹åº”è®°å½•çš„å½“å‰ç‰ˆæœ¬å·è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæäº¤çš„æ•°æ®ç‰ˆæœ¬å·å¤§äºæ•°æ®åº“å½“å‰ç‰ˆæœ¬å·ï¼Œåˆ™äºˆä»¥æ›´æ–°ï¼Œå¦åˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ•°æ®ã€‚redisä¸­å¯ä»¥ä½¿ç”¨watchå‘½ä»¤ä¼šç›‘è§†ç»™å®šçš„keyï¼Œå½“execæ—¶å€™å¦‚æœç›‘è§†çš„keyä»è°ƒç”¨watchåå‘ç”Ÿè¿‡å˜åŒ–ï¼Œåˆ™æ•´ä¸ªäº‹åŠ¡ä¼šå¤±è´¥ã€‚ä¹Ÿå¯ä»¥è°ƒç”¨watchå¤šæ¬¡ç›‘è§†å¤šä¸ªkeyã€‚è¿™æ ·å°±å¯ä»¥å¯¹æŒ‡å®šçš„keyåŠ ä¹è§‚é”äº†ã€‚æ³¨æ„watchçš„keyæ˜¯å¯¹æ•´ä¸ªè¿æ¥æœ‰æ•ˆçš„ï¼Œäº‹åŠ¡ä¹Ÿä¸€æ ·ã€‚å¦‚æœè¿æ¥æ–­å¼€ï¼Œç›‘è§†å’Œäº‹åŠ¡éƒ½ä¼šè¢«è‡ªåŠ¨æ¸…é™¤ã€‚å½“ç„¶äº†exec , discard , unwatchå‘½ä»¤éƒ½ä¼šæ¸…é™¤è¿æ¥ä¸­çš„æ‰€æœ‰ç›‘è§†</p></div> <h4 id="rediså®ç°ä¹è§‚é”"><a href="#rediså®ç°ä¹è§‚é”" class="header-anchor">#</a> rediså®ç°ä¹è§‚é”</h4> <p>å½“ä¸€ä¸ªçº¿ç¨‹åœ¨è¦å¯¹æ•°æ®è¿›è¡Œæ“ä½œï¼Œä½†å®ƒçš„æ“ä½œè¿˜æœªå®Œæˆæ—¶ï¼Œæ•°æ®ä¾¿è¢«å¦ä¸€çº¿ç¨‹æ”¹å˜ï¼Œè¿™ä¸€çº¿ç¨‹æ“ä½œçš„æ•°æ®å°±ä¸æ˜¯åŸæ¥çš„æ•°æ®äº†ã€‚ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ä¹è§‚é”ã€‚</p> <ul><li><p>ä½¿ç”¨watch[key]....ï¼šç›‘æ§ä¸€ä¸ªæˆ–å¤šä¸ªkeyï¼Œå½“äº‹åŠ¡æœªæ‰§è¡Œæ—¶ï¼Œå¦‚æœç›‘æ§çš„keyçš„å€¼å‘ç”Ÿäº†æ”¹å˜ï¼Œäº‹åŠ¡ä¾¿ä¸ä¼šæ‰§è¡Œ</p> <ul><li><p>å…ˆè®¾å®šä¸¤ä¸ªåˆå€¼k1 k2ï¼Œç›‘æ§k1ï¼Œç„¶åè¿›è¡Œäº‹åŠ¡</p> <p><img src="https://images.zaiolos.top/images/image-20211101133447825.png" alt="image-20211101133447825"></p></li> <li><p>åœ¨äº‹åŠ¡æœªæ‰§è¡Œæ—¶ï¼Œåœ¨å¦ä¸€ç»ˆç«¯æ ‡ç­¾é¡µå¯¹k1 k2è¿›è¡Œä¿®æ”¹</p> <p><img src="https://images.zaiolos.top/images/image-20211101133453321.png" alt="image-20211101133453321"></p></li> <li><p>å†å›åˆ°åŸæ¥çš„é¡µé¢æ‰§è¡Œäº‹åŠ¡ï¼Œå‘ç°äº‹åŠ¡å¹¶æ²¡æœ‰æ‰§è¡Œï¼Œä½¿ç”¨unwatchåç»§ç»­ç›‘æ§key</p> <p><img src="https://images.zaiolos.top/images/image-20211101133459234.png" alt="image-20211101133459234"></p></li></ul></li> <li><p>ç„¶åå†ä½¿ç”¨unwatchå‘½ä»¤è§£é™¤ç›‘æ§ï¼Œå³å¯å†æ¬¡ç›‘æ§key</p></li></ul> <h4 id="springbootæ•´åˆredis"><a href="#springbootæ•´åˆredis" class="header-anchor">#</a> SpringBootæ•´åˆRedis</h4> <p>SpringBoot 2.xä¹‹åï¼ŒåŸæ¥ä½¿ç”¨çš„jedisè¢«æ›¿æ¢ä¸ºäº†lettuce</p> <ul><li>jedis:é‡‡ç”¨å®¢æˆ·ç«¯ç›´è¿ï¼Œå¤šä¸ªçº¿ç¨‹æ“ä½œçš„è¯ï¼Œæ˜¯ä¸å®‰å…¨çš„ï¼Œå¦‚æœæƒ³è¦é¿å…ä¸å®‰å…¨çš„ï¼Œä½¿ç”¨jedis poolè¿æ¥æ± !BIOæ¨¡å¼</li> <li>lettuceï¼šé‡‡ç”¨nettyï¼Œå®ä¾‹å¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¸­è¿›ç¨‹å…±äº«ï¼Œä¸å­˜åœ¨çº¿ç¨‹ä¸å®‰å…¨çš„æƒ…å†µï¼Œå¯ä»¥å‡å°‘çº¿ç¨‹æ•°æ®ã€‚æ›´åƒNIOæ¨¡å¼</li></ul> <h5 id="ç¼–å†™redisé…ç½®ç±»-å¯¹key-valueè¿›è¡Œåºåˆ—åŒ–-å®ä½“ç±»éœ€å®ç°serializableæ¥å£"><a href="#ç¼–å†™redisé…ç½®ç±»-å¯¹key-valueè¿›è¡Œåºåˆ—åŒ–-å®ä½“ç±»éœ€å®ç°serializableæ¥å£" class="header-anchor">#</a> ç¼–å†™redisé…ç½®ç±»,å¯¹key valueè¿›è¡Œåºåˆ—åŒ–(å®ä½“ç±»éœ€å®ç°Serializableæ¥å£)</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @author zdk
 * @date 2021/7/18 21:08
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;myRedisTemplate&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jackson2JsonRedisSerializer</span> jackson2JsonRedisSerializer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ObjectMapper</span> objectMapper<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        objectMapper<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">PropertyAccessor</span><span class="token punctuation">.</span><span class="token constant">ALL</span><span class="token punctuation">,</span> <span class="token class-name">JsonAutoDetect<span class="token punctuation">.</span>Visibility</span><span class="token punctuation">.</span><span class="token constant">ANY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        objectMapper<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span><span class="token class-name">ObjectMapper<span class="token punctuation">.</span>DefaultTyping</span><span class="token punctuation">.</span><span class="token constant">NON_FINAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">StringRedisSerializer</span> stringRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//keyé‡‡ç”¨stringçš„åºåˆ—åŒ–æ–¹å¼</span>
        template<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span>stringRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//valueé‡‡ç”¨Jacksonåºåˆ—åŒ–æ–¹å¼</span>
        template<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//hashçš„keyä¹Ÿé‡‡ç”¨stringçš„åºåˆ—åŒ–æ–¹å¼</span>
        template<span class="token punctuation">.</span><span class="token function">setHashKeySerializer</span><span class="token punctuation">(</span>stringRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨Jackson</span>
        template<span class="token punctuation">.</span><span class="token function">setHashValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> template<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;myStringRedisTemplate&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">StringRedisTemplate</span> <span class="token function">stringRedisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StringRedisTemplate</span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRedisTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">StringRedisSerializer</span> stringRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//keyé‡‡ç”¨stringçš„åºåˆ—åŒ–æ–¹å¼</span>
        template<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span>stringRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//valueé‡‡ç”¨stringçš„åºåˆ—åŒ–æ–¹å¼</span>
        template<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span>stringRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> template<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h5 id="ç¼–å†™rediså¸¸ç”¨æ“ä½œå·¥å…·ç±»"><a href="#ç¼–å†™rediså¸¸ç”¨æ“ä½œå·¥å…·ç±»" class="header-anchor">#</a> ç¼–å†™rediså¸¸ç”¨æ“ä½œå·¥å…·ç±»</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * @author zdk
 * @date 2021/7/19 9:56
 */</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisUtil</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;myRedisTemplate&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> redisTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;myStringRedisTemplate&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">StringRedisTemplate</span> stringRedisTemplate<span class="token punctuation">;</span>

    <span class="token comment">// =============================common============================</span>
    <span class="token comment">/**
     * æŒ‡å®šç¼“å­˜å¤±æ•ˆæ—¶é—´
     * @param key é”®
     * @param time æ—¶é—´(ç§’)
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">expire</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">long</span> time<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                redisTemplate<span class="token punctuation">.</span><span class="token function">expire</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> time<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * æ ¹æ®key è·å–è¿‡æœŸæ—¶é—´
     * @param key é”® ä¸èƒ½ä¸ºnull
     * @return æ—¶é—´(ç§’) è¿”å›0ä»£è¡¨ä¸ºæ°¸ä¹…æœ‰æ•ˆ
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">getExpire</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">getExpire</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨
     * @param key é”®
     * @return true å­˜åœ¨ falseä¸å­˜åœ¨
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">hasKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">hasKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * åˆ é™¤ç¼“å­˜
     * @param key å¯ä»¥ä¼ ä¸€ä¸ªå€¼ æˆ–å¤šä¸ª
     */</span>
    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                redisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                redisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> <span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">arrayToList</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ============================String=============================</span>
    <span class="token comment">/**
     * æ™®é€šç¼“å­˜è·å–
     * @param key é”®
     * @return å€¼
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> key <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * æ™®é€šç¼“å­˜æ”¾å…¥
     * @param key é”®
     * @param value å€¼
     * @return trueæˆåŠŸ falseå¤±è´¥
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * æ™®é€šç¼“å­˜æ”¾å…¥å¹¶è®¾ç½®æ—¶é—´
     * @param key é”®
     * @param value å€¼
     * @param time æ—¶é—´(ç§’) timeè¦å¤§äº0 å¦‚æœtimeå°äºç­‰äº0 å°†è®¾ç½®æ— é™æœŸ
     * @return trueæˆåŠŸ false å¤±è´¥
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token keyword">long</span> time<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> time<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * é€’å¢
     * @param key é”®
     * @param delta è¦å¢åŠ å‡ (å¤§äº0)
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">incr</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">long</span> delta<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>delta <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;é€’å¢å› å­å¿…é¡»å¤§äº0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> delta<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * é€’å‡
     * @param key é”®
     * @param delta è¦å‡å°‘å‡ (å°äº0)
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">decr</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">long</span> delta<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>delta <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;é€’å‡å› å­å¿…é¡»å¤§äº0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token operator">-</span>delta<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">// ================================Map=================================</span>
    <span class="token comment">/**
     * HashGet
     * @param key é”® ä¸èƒ½ä¸ºnull
     * @param item é¡¹ ä¸èƒ½ä¸ºnull
     * @return å€¼
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">hget</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * è·å–hashKeyå¯¹åº”çš„æ‰€æœ‰é”®å€¼
     * @param key é”®
     * @return å¯¹åº”çš„å¤šä¸ªé”®å€¼
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">hmget</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * HashSet
     * @param key é”®
     * @param map å¯¹åº”å¤šä¸ªé”®å€¼
     * @return true æˆåŠŸ false å¤±è´¥
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hmset</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putAll</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * HashSet å¹¶è®¾ç½®æ—¶é—´
     * @param key é”®
     * @param map å¯¹åº”å¤šä¸ªé”®å€¼
     * @param time æ—¶é—´(ç§’)
     * @return trueæˆåŠŸ falseå¤±è´¥
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hmset</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">,</span> <span class="token keyword">long</span> time<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putAll</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">expire</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å‘ä¸€å¼ hashè¡¨ä¸­æ”¾å…¥æ•°æ®,å¦‚æœä¸å­˜åœ¨å°†åˆ›å»º
     * @param key é”®
     * @param item é¡¹
     * @param value å€¼
     * @return true æˆåŠŸ falseå¤±è´¥
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hset</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> item<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> item<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å‘ä¸€å¼ hashè¡¨ä¸­æ”¾å…¥æ•°æ®,å¦‚æœä¸å­˜åœ¨å°†åˆ›å»º
     * @param key é”®
     * @param item é¡¹
     * @param value å€¼
     * @param time æ—¶é—´(ç§’) æ³¨æ„:å¦‚æœå·²å­˜åœ¨çš„hashè¡¨æœ‰æ—¶é—´,è¿™é‡Œå°†ä¼šæ›¿æ¢åŸæœ‰çš„æ—¶é—´
     * @return true æˆåŠŸ falseå¤±è´¥
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hset</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> item<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">,</span> <span class="token keyword">long</span> time<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> item<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">expire</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * åˆ é™¤hashè¡¨ä¸­çš„å€¼
     * @param key é”® ä¸èƒ½ä¸ºnull
     * @param item é¡¹ å¯ä»¥ä½¿å¤šä¸ª ä¸èƒ½ä¸ºnull
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">hdel</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * åˆ¤æ–­hashè¡¨ä¸­æ˜¯å¦æœ‰è¯¥é¡¹çš„å€¼
     * @param key é”® ä¸èƒ½ä¸ºnull
     * @param item é¡¹ ä¸èƒ½ä¸ºnull
     * @return true å­˜åœ¨ falseä¸å­˜åœ¨
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hHasKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasKey</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * hashé€’å¢ å¦‚æœä¸å­˜åœ¨,å°±ä¼šåˆ›å»ºä¸€ä¸ª å¹¶æŠŠæ–°å¢åçš„å€¼è¿”å›
     * @param key é”®
     * @param item é¡¹
     * @param by è¦å¢åŠ å‡ (å¤§äº0)
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">hincr</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> item<span class="token punctuation">,</span> <span class="token keyword">double</span> by<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> item<span class="token punctuation">,</span> by<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * hashé€’å‡
     * @param key é”®
     * @param item é¡¹
     * @param by è¦å‡å°‘è®°(å°äº0)
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">hdecr</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> item<span class="token punctuation">,</span> <span class="token keyword">double</span> by<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> item<span class="token punctuation">,</span> <span class="token operator">-</span>by<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ============================set=============================</span>
    <span class="token comment">/**
     * æ ¹æ®keyè·å–Setä¸­çš„æ‰€æœ‰å€¼
     * @param key é”®
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">sGet</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">members</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * æ ¹æ®valueä»ä¸€ä¸ªsetä¸­æŸ¥è¯¢,æ˜¯å¦å­˜åœ¨
     * @param key é”®
     * @param value å€¼
     * @return true å­˜åœ¨ falseä¸å­˜åœ¨
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">sHasKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isMember</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å°†æ•°æ®æ”¾å…¥setç¼“å­˜
     * @param key é”®
     * @param values å€¼ å¯ä»¥æ˜¯å¤šä¸ª
     * @return æˆåŠŸä¸ªæ•°
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">sSet</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å°†setæ•°æ®æ”¾å…¥ç¼“å­˜
     * @param key é”®
     * @param time æ—¶é—´(ç§’)
     * @param values å€¼ å¯ä»¥æ˜¯å¤šä¸ª
     * @return æˆåŠŸä¸ªæ•°
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">sSetAndTime</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">long</span> time<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Long</span> count <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">expire</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> count<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * è·å–setç¼“å­˜çš„é•¿åº¦
     * @param key é”®
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">sGetSetSize</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * ç§»é™¤å€¼ä¸ºvalueçš„
     * @param key é”®
     * @param values å€¼ å¯ä»¥æ˜¯å¤šä¸ª
     * @return ç§»é™¤çš„ä¸ªæ•°
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">setRemove</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Long</span> count <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> count<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ===============================list=================================</span>

    <span class="token comment">/**
     * è·å–listç¼“å­˜çš„å†…å®¹
     * @param key é”®
     * @param start å¼€å§‹
     * @param end ç»“æŸ 0 åˆ° -1ä»£è¡¨æ‰€æœ‰å€¼
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">lGet</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">long</span> start<span class="token punctuation">,</span> <span class="token keyword">long</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * è·å–listç¼“å­˜çš„é•¿åº¦
     * @param key é”®
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">lGetListSize</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * é€šè¿‡ç´¢å¼• è·å–listä¸­çš„å€¼
     * @param key é”®
     * @param index ç´¢å¼• index&gt;=0æ—¶ï¼Œ 0 è¡¨å¤´ï¼Œ1 ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨ï¼›index&lt;0æ—¶ï¼Œ-1ï¼Œè¡¨å°¾ï¼Œ-2å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">lGetIndex</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">long</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å°†listæ”¾å…¥ç¼“å­˜
     * @param key é”®
     * @param value å€¼
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">lSet</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rightPush</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å°†listæ”¾å…¥ç¼“å­˜
     * @param key é”®
     * @param value å€¼
     * @param time æ—¶é—´(ç§’)
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">lSet</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">,</span> <span class="token keyword">long</span> time<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rightPush</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">expire</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å°†listæ”¾å…¥ç¼“å­˜
     * @param key é”®
     * @param value å€¼
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">lSet</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rightPushAll</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å°†listæ”¾å…¥ç¼“å­˜
     *
     * @param key é”®
     * @param value å€¼
     * @param time æ—¶é—´(ç§’)
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">lSet</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> value<span class="token punctuation">,</span> <span class="token keyword">long</span> time<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rightPushAll</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">expire</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * æ ¹æ®ç´¢å¼•ä¿®æ”¹listä¸­çš„æŸæ¡æ•°æ®
     * @param key é”®
     * @param index ç´¢å¼•
     * @param value å€¼
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">lUpdateIndex</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">long</span> index<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> index<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * ç§»é™¤Nä¸ªå€¼ä¸ºvalue
     * @param key é”®
     * @param count ç§»é™¤å¤šå°‘ä¸ª
     * @param value å€¼
     * @return ç§»é™¤çš„ä¸ªæ•°
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">lRemove</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">long</span> count<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> count<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ===============================zset=================================</span>


    <span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">zAdd</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span><span class="token class-name">Object</span> value<span class="token punctuation">,</span><span class="token keyword">double</span> score<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> score<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">zRange</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span><span class="token keyword">long</span> start<span class="token punctuation">,</span><span class="token keyword">long</span> stop<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> start<span class="token punctuation">,</span> stop<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">zRangeByScore</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span><span class="token keyword">double</span> min<span class="token punctuation">,</span><span class="token keyword">double</span> max<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rangeByScore</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> min<span class="token punctuation">,</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">zRangeAll</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForZSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br><span class="line-number">392</span><br><span class="line-number">393</span><br><span class="line-number">394</span><br><span class="line-number">395</span><br><span class="line-number">396</span><br><span class="line-number">397</span><br><span class="line-number">398</span><br><span class="line-number">399</span><br><span class="line-number">400</span><br><span class="line-number">401</span><br><span class="line-number">402</span><br><span class="line-number">403</span><br><span class="line-number">404</span><br><span class="line-number">405</span><br><span class="line-number">406</span><br><span class="line-number">407</span><br><span class="line-number">408</span><br><span class="line-number">409</span><br><span class="line-number">410</span><br><span class="line-number">411</span><br><span class="line-number">412</span><br><span class="line-number">413</span><br><span class="line-number">414</span><br><span class="line-number">415</span><br><span class="line-number">416</span><br><span class="line-number">417</span><br><span class="line-number">418</span><br><span class="line-number">419</span><br><span class="line-number">420</span><br><span class="line-number">421</span><br><span class="line-number">422</span><br><span class="line-number">423</span><br><span class="line-number">424</span><br><span class="line-number">425</span><br><span class="line-number">426</span><br><span class="line-number">427</span><br><span class="line-number">428</span><br><span class="line-number">429</span><br><span class="line-number">430</span><br><span class="line-number">431</span><br><span class="line-number">432</span><br><span class="line-number">433</span><br><span class="line-number">434</span><br><span class="line-number">435</span><br><span class="line-number">436</span><br><span class="line-number">437</span><br><span class="line-number">438</span><br><span class="line-number">439</span><br><span class="line-number">440</span><br><span class="line-number">441</span><br><span class="line-number">442</span><br><span class="line-number">443</span><br><span class="line-number">444</span><br><span class="line-number">445</span><br><span class="line-number">446</span><br><span class="line-number">447</span><br><span class="line-number">448</span><br><span class="line-number">449</span><br><span class="line-number">450</span><br><span class="line-number">451</span><br><span class="line-number">452</span><br><span class="line-number">453</span><br><span class="line-number">454</span><br><span class="line-number">455</span><br><span class="line-number">456</span><br><span class="line-number">457</span><br><span class="line-number">458</span><br><span class="line-number">459</span><br><span class="line-number">460</span><br><span class="line-number">461</span><br><span class="line-number">462</span><br><span class="line-number">463</span><br><span class="line-number">464</span><br><span class="line-number">465</span><br><span class="line-number">466</span><br><span class="line-number">467</span><br><span class="line-number">468</span><br><span class="line-number">469</span><br><span class="line-number">470</span><br><span class="line-number">471</span><br><span class="line-number">472</span><br><span class="line-number">473</span><br><span class="line-number">474</span><br><span class="line-number">475</span><br><span class="line-number">476</span><br><span class="line-number">477</span><br><span class="line-number">478</span><br><span class="line-number">479</span><br><span class="line-number">480</span><br><span class="line-number">481</span><br><span class="line-number">482</span><br><span class="line-number">483</span><br><span class="line-number">484</span><br><span class="line-number">485</span><br><span class="line-number">486</span><br><span class="line-number">487</span><br><span class="line-number">488</span><br><span class="line-number">489</span><br><span class="line-number">490</span><br><span class="line-number">491</span><br><span class="line-number">492</span><br><span class="line-number">493</span><br><span class="line-number">494</span><br><span class="line-number">495</span><br><span class="line-number">496</span><br><span class="line-number">497</span><br><span class="line-number">498</span><br><span class="line-number">499</span><br><span class="line-number">500</span><br><span class="line-number">501</span><br><span class="line-number">502</span><br><span class="line-number">503</span><br><span class="line-number">504</span><br><span class="line-number">505</span><br><span class="line-number">506</span><br><span class="line-number">507</span><br><span class="line-number">508</span><br><span class="line-number">509</span><br><span class="line-number">510</span><br><span class="line-number">511</span><br><span class="line-number">512</span><br><span class="line-number">513</span><br><span class="line-number">514</span><br><span class="line-number">515</span><br><span class="line-number">516</span><br><span class="line-number">517</span><br><span class="line-number">518</span><br><span class="line-number">519</span><br><span class="line-number">520</span><br><span class="line-number">521</span><br><span class="line-number">522</span><br><span class="line-number">523</span><br><span class="line-number">524</span><br><span class="line-number">525</span><br><span class="line-number">526</span><br><span class="line-number">527</span><br><span class="line-number">528</span><br><span class="line-number">529</span><br><span class="line-number">530</span><br><span class="line-number">531</span><br><span class="line-number">532</span><br><span class="line-number">533</span><br><span class="line-number">534</span><br><span class="line-number">535</span><br><span class="line-number">536</span><br><span class="line-number">537</span><br><span class="line-number">538</span><br><span class="line-number">539</span><br><span class="line-number">540</span><br><span class="line-number">541</span><br><span class="line-number">542</span><br><span class="line-number">543</span><br><span class="line-number">544</span><br><span class="line-number">545</span><br><span class="line-number">546</span><br><span class="line-number">547</span><br><span class="line-number">548</span><br><span class="line-number">549</span><br><span class="line-number">550</span><br><span class="line-number">551</span><br><span class="line-number">552</span><br><span class="line-number">553</span><br><span class="line-number">554</span><br></div></div><h4 id="rediså„ç§æ•°æ®ç»“æ„ä½¿ç”¨åœºæ™¯æ€»ç»“"><a href="#rediså„ç§æ•°æ®ç»“æ„ä½¿ç”¨åœºæ™¯æ€»ç»“" class="header-anchor">#</a> rediså„ç§æ•°æ®ç»“æ„ä½¿ç”¨åœºæ™¯æ€»ç»“</h4> <ol><li>Stringï¼švalueé™¤äº†å¯ä»¥æ˜¯å­—ç¬¦ä¸²è¿˜èƒ½æ˜¯æ•°å­—
<ul><li>è®¡æ•°å™¨ï¼šincr</li> <li>ç»Ÿè®¡å¤šå•ä½çš„æ•°é‡</li> <li>ç²‰ä¸æ•°</li> <li>å¯¹è±¡ç¼“å­˜å­˜å‚¨</li></ul></li> <li>Listï¼š
<ul><li>æ¶ˆæ¯æ’é˜Ÿ</li> <li>æ¶ˆæ¯é˜Ÿåˆ—(Lpush,Rpop)</li> <li>æ ˆ(Lpush,Lpop)</li></ul></li> <li>Setï¼š
<ul><li>å°†æ¯ä¸ªç”¨æˆ·å…³æ³¨çš„äººæ”¾å…¥ä¸€ä¸ªsetï¼Œç²‰ä¸æ”¾å…¥ä¸€ä¸ªsetï¼Œå¯ä»¥ä½¿ç”¨sinterè·å–ä»–ä»¬çš„å…±åŒå…³æ³¨</li> <li>å…±åŒçˆ±å¥½</li></ul></li> <li>hash
<ul><li>æ›´é€‚åˆå‚¨å­˜å¯¹è±¡(æ˜“å˜æ›´çš„æ•°æ®)</li></ul></li> <li>zset
<ul><li>setæ’åº</li> <li>å‚¨å­˜ç­çº§æˆç»©è¡¨ã€å·¥èµ„è¡¨æ’åº</li> <li>æ¶ˆæ¯æ’åºï¼Œç”¨æƒé‡åˆ¤æ–­æ˜¯å¦é‡è¦</li> <li>æ’è¡Œæ¦œåº”ç”¨å®ç°ï¼Œå–TopNæµ‹è¯•</li></ul></li> <li>Geospatial
<ul><li>åœ°ç†ä½ç½®</li> <li>é™„è¿‘çš„äºº</li></ul></li> <li>bitmap
<ul><li>ç½‘ç«™ã€æ¸¸æˆç­¾åˆ°</li> <li>ç½‘ç«™æ¯å¤©è®¿é—®äººæ•°ç»Ÿè®¡</li> <li>æŒ‡å®šç”¨æˆ·æ˜¯å¦åœ¨æŸä¸€å¤©è®¿é—®äº†</li></ul></li></ol> <h4 id="redisæŒä¹…åŒ–"><a href="#redisæŒä¹…åŒ–" class="header-anchor">#</a> redisæŒä¹…åŒ–</h4> <ol><li><p>RDB(Redis DataBase)</p> <p><img src="https://images.zaiolos.top/images/image-20211101133513460.png" alt="image-20211101133513460"></p> <blockquote><p>åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œä¹Ÿå°±æ˜¯Snapshotå¿«ç…§ï¼Œå®ƒæ¢å¤æ—¶æ˜¯å°†å¿«ç…§æ–‡ä»¶ç›´æ¥è¯»åˆ°å†…å­˜é‡Œã€‚</p> <p>Redisä¼šå•ç‹¬åˆ›å»º ( fork )ä¸€ä¸ªå­è¿›ç¨‹æ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œä¼šå…ˆå°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¾…æŒä¹…åŒ–è¿‡ç¨‹éƒ½ç»“æŸäº†ï¼Œå†ç”¨è¿™ä¸ªä¸´æ—¶æ–‡ä»¶æ›¿æ¢ä¸Šæ¬¡æŒä¹…åŒ–å¥½çš„æ–‡ä»¶ã€‚</p> <p>æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»è¿›ç¨‹æ˜¯ä¸è¿›è¡Œä»»ä½•I0æ“ä½œçš„ã€‚è¿™å°±ç¡®ä¿äº†æé«˜çš„æ€§èƒ½ã€‚å¦‚æœéœ€è¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ¢å¤ï¼Œä¸”å¯¹äºæ•°æ®æ¢å¤çš„å®Œæ•´æ€§ä¸æ˜¯éå¸¸æ•æ„Ÿï¼Œé‚£RDBæ–¹å¼è¦æ¯”AOFæ–¹å¼æ›´åŠ çš„é«˜æ•ˆã€‚RDBçš„ç¼ºç‚¹æ˜¯æœ€åä¸€æ¬¡æŒä¹…åŒ–åçš„æ•°æ®å¯èƒ½ä¸¢å¤±ã€‚</p></blockquote> <span class="badge tip" style="vertical-align:top;" data-v-d5affa18>RDBä¿å­˜çš„æ–‡ä»¶æ˜¯dump.rdb</span> <ul><li><p>è§¦å‘è§„åˆ™ï¼š</p> <ol><li>saveçš„è§„åˆ™æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨è§¦å‘rdbè§„åˆ™</li> <li>æ‰§è¡Œflushallå‘½ä»¤ï¼Œä¹Ÿä¼šè§¦å‘rdb</li> <li>é€€å‡ºredisæœåŠ¡ï¼Œä¹Ÿä¼šäº§ç”Ÿrdbæ–‡ä»¶</li></ol> <p>å¤‡ä»½å°±è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªdump.rdb</p></li> <li><p>å¦‚ä½•æ¢å¤æ•°æ®ï¼š</p> <ol><li><p>åªéœ€å°†rdbæ–‡ä»¶æ”¾åœ¨rediså¯åŠ¨ç›®å½•ä¸‹ï¼Œredisä¼šè‡ªåŠ¨æ£€æŸ¥æ¢å¤dump.rdbä¸­çš„æ•°æ®</p></li> <li><p>æŸ¥çœ‹éœ€è¦å­˜åœ¨çš„ä½ç½®</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> config get <span class="token function">dir</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;dir&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;/usr/local/redis/bin&quot;</span> <span class="token comment">#å¦‚æœåœ¨æ­¤ç›®å½•ä¸‹å­˜åœ¨dump.rdbæ–‡ä»¶ï¼Œredisä¼šè‡ªåŠ¨æ¢å¤å…¶ä¸­çš„æ•°æ®</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol></li></ul> <p>ä¼˜ç‚¹ï¼š</p> <ul><li>é€‚åˆå¤§è§„æ¨¡çš„æ•°æ®æ¢å¤</li> <li>é€‚ç”¨äºå¯¹æ•°æ®å®Œæ•´æ€§è¦æ±‚ä¸é«˜çš„æƒ…å†µ</li></ul> <p>ç¼ºç‚¹ï¼š</p> <ul><li>éœ€è¦ä¸€å®šçš„æ—¶é—´é—´éš”è¿›è¡Œæ“ä½œã€‚å¦‚æœredisæ„å¤–å®•æœºï¼Œæœ€åä¸€æ¬¡ä¿®æ”¹çš„æ•°æ®å°±æ²¡äº†</li> <li>forkè¿›ç¨‹çš„æ—¶å€™ï¼Œä¼šå ç”¨ä¸€å®šçš„å†…å­˜</li></ul></li> <li><p>AOF(Append Only File)</p> <blockquote><p>å°†æ‰€æœ‰å†™å…¥çš„å‘½ä»¤éƒ½è®°å½•ä¸‹æ¥ï¼Œå‚¨å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œæ¢å¤çš„æ—¶å€™å°±æŠŠæ–‡ä»¶ä¸­çš„å‘½ä»¤å…¨éƒ¨æ‰§è¡Œä¸€æ¬¡ã€‚
ä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œå°†Redisæ‰§è¡Œè¿‡çš„æ‰€æœ‰æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼Œrediså¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼Œredisé‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œã€‚</p></blockquote> <p><img src="https://images.zaiolos.top/images/image-20211101133519677.png" alt="image-20211101133519677"></p> <p><strong>AOFä¿å­˜çš„æ˜¯appendonly.aofæ–‡ä»¶</strong></p> <p>AOFåœ¨redis.confä¸­çš„é…ç½®</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>appendonly no <span class="token comment">#é»˜è®¤æ˜¯ä¸å¼€å¯çš„</span>
<span class="token comment"># The name of the append only file (default: &quot;appendonly.aof&quot;)</span>
appendfilename <span class="token string">&quot;appendonly.aof&quot;</span> <span class="token comment">#ä¿å­˜çš„æ–‡ä»¶å</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#AOFæŒä¹…åŒ–ç­–ç•¥</span>

appendfsync always <span class="token comment">#æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡syncï¼Œä¼šæ¶ˆè€—æ›´å¤šæ€§èƒ½</span>
appendfsync everysec <span class="token comment">#æ¯ä¸€ç§’æ‰§è¡Œä¸€æ¬¡syncï¼Œå¯èƒ½ä¼šä¸¢å¤±è¿™ä¸€ç§’çš„æ•°æ®</span>
appendfsync no <span class="token comment">#ä¸æ‰§è¡Œsyncï¼Œè¿™æ—¶æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#è‡ªåŠ¨é‡å†™çš„è§„åˆ™</span>
no-appendfsync-on-rewrite no  <span class="token comment">#æ˜¯å¦å¼€å¯æ–‡ä»¶é‡å†™</span>
auto-aof-rewrite-percentage <span class="token number">100</span> <span class="token comment">#é‡å†™çš„ç²¾ç¡®å€¼</span>

<span class="token comment">#é‡å†™çš„æ–‡ä»¶æœ€å°å€¼ï¼Œå¦‚æœæ–‡ä»¶è¶…è¿‡è¿™ä¸ªå€¼ï¼Œå°±ä¼šforkä¸€ä¸ªæ–°çš„è¿›ç¨‹æ¥å°†æ–‡ä»¶è¿›è¡Œé‡å†™</span>
auto-aof-rewrite-min-size 64mb 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>å¼€å¯appendonly yesåé‡å¯rediså³å¯ç”Ÿæ•ˆï¼Œé‡å¯æ—¶å¦‚æœæ²¡æœ‰appendonly.aofæ–‡ä»¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª

å¦‚æœåŸæ¥çš„aofæ–‡ä»¶æœ‰é”™è¯¯ï¼Œæ­¤æ—¶redisæ˜¯ä¸èƒ½å¯åŠ¨çš„ã€‚éœ€è¦è¿è¡Œ redis-check-aof <span class="token parameter variable">--fix</span> appendonly.aof
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ä¼˜ç‚¹ï¼š</p> <ul><li>æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šåŒæ­¥ï¼Œæ•°æ®çš„å®Œæ•´æ€§æ›´å¥½</li> <li>æ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼Œåªå¯èƒ½ä¼šä¸¢å¤±ä¸€ç§’çš„æ•°æ®</li> <li>ä»ä¸åŒæ­¥çš„è¯ï¼Œæ•ˆç‡æœ€é«˜</li></ul> <p>ç¼ºç‚¹ï¼š</p> <ul><li>aofæ–‡ä»¶è¿œå¤§äºrdbï¼Œä¿®å¤é€Ÿåº¦æ›´æ…¢</li> <li>aofæ˜¯ioæ“ä½œï¼Œè¿è¡Œæ•ˆç‡ä¹Ÿè¦æ¯”rdbæ…¢ï¼Œæ‰€ä»¥redisé»˜è®¤é…ç½®æ˜¯rdbè€Œä¸æ˜¯aof</li></ul> <p>æ‰©å±•ï¼š</p> <ol><li>RDBæŒä¹…åŒ–æ–¹å¼èƒ½å¤Ÿåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å¯¹ä½ çš„æ•°æ®è¿›è¡Œå¿«ç…§å­˜å‚¨</li> <li>AOFæŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨å†™çš„æ“ä½œï¼Œå½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹çš„æ•°æ®ï¼ŒAOFå‘½ä»¤ä»¥Redis åè®®è¿½åŠ ä¿å­˜æ¯æ¬¡å†™çš„æ“ä½œåˆ°æ–‡ä»¶æœ«å°¾ï¼ŒRedisè¿˜èƒ½å¯¹AOFæ–‡ä»¶è¿›è¡Œåå°é‡å†™ï¼Œä½¿å¾—AOFæ–‡ä»¶çš„ä½“ç§¯ä¸è‡³äºè¿‡å¤§ã€‚</li> <li><strong>åªåšç¼“å­˜ï¼Œå¦‚æœä½ åªå¸Œæœ›ä½ çš„æ•°æ®åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å­˜åœ¨ï¼Œä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–</strong></li> <li>åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–æ–¹å¼
<ul><li>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“redisé‡å¯çš„æ—¶å€™ä¼šä¼˜å…ˆè½½å…¥AOFæ–‡ä»¶æ¥æ¢å¤åŸå§‹çš„æ•°æ®ï¼Œå› ä¸ºåœ¨é€šå¸¸æƒ…å†µä¸‹AOFæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦æ¯”RDBæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦å®Œæ•´ã€‚</li> <li>RDBçš„æ•°æ®ä¸å®æ—¶ï¼ŒåŒæ—¶ä½¿ç”¨ä¸¤è€…æ—¶æœåŠ¡å™¨é‡å¯ä¹Ÿåªä¼šæ‰¾AOFæ–‡ä»¶ï¼Œé‚£è¦ä¸è¦åªä½¿ç”¨AOFå‘¢?ä½œè€…å»ºè®®ä¸è¦ï¼Œå› ä¸ºRDBæ›´é€‚åˆç”¨äºå¤‡ä»½æ•°æ®åº“(AOFåœ¨ä¸æ–­å˜åŒ–ä¸å¥½å¤‡ä»½ï¼‰ï¼Œå¿«é€Ÿé‡å¯ï¼Œè€Œä¸”ä¸ä¼šæœ‰AOFå¯èƒ½æ½œåœ¨çš„Bugï¼Œç•™ç€ä½œä¸ºä¸€ä¸ªä¸‡ä¸€çš„æ‰‹æ®µã€‚</li></ul></li> <li>æ€§èƒ½å»ºè®®
<ul><li>å› ä¸ºRDBæ–‡ä»¶åªç”¨ä½œåå¤‡ç”¨é€”ï¼Œå»ºè®®åªåœ¨Slaveä¸ŠæŒä¹…åŒ–RDBæ–‡ä»¶ï¼Œè€Œä¸”åªè¦15åˆ†é’Ÿå¤‡ä»½ä¸€æ¬¡å°±å¤Ÿäº†ï¼Œåªä¿ç•™save 900 1è¿™æ¡è§„åˆ™ã€‚</li> <li>å¦‚æœEnable AOFï¼Œå¥½å¤„æ˜¯åœ¨æœ€æ¶åŠ£æƒ…å†µä¸‹ä¹Ÿåªä¼šä¸¢å¤±ä¸è¶…è¿‡ä¸¤ç§’æ•°æ®ï¼Œå¯åŠ¨è„šæœ¬è¾ƒç®€å•åªloadè‡ªå·±çš„AOFæ–‡ä»¶å°±å¯ä»¥äº†ï¼Œä»£ä»·ä¸€æ˜¯å¸¦æ¥äº†æŒç»­çš„lOï¼ŒäºŒæ˜¯AOFrewriteçš„æœ€åå°†rewriteè¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ–°æ•°æ®å†™åˆ°æ–°æ–‡ä»¶é€ æˆçš„é˜»å¡å‡ ä¹æ˜¯ä¸å¯é¿å…çš„ã€‚åªè¦ç¡¬ç›˜è®¸å¯ï¼Œåº”è¯¥å°½é‡å‡å°‘AOF rewriteçš„é¢‘ç‡ï¼ŒAOFé‡å†™çš„åŸºç¡€å¤§å°é»˜è®¤å€¼64Må¤ªå°äº†ï¼Œå¯ä»¥è®¾åˆ°5Gä»¥ä¸Šï¼Œé»˜è®¤è¶…è¿‡åŸå¤§å°100%å¤§å°é‡å†™å¯ä»¥æ”¹åˆ°é€‚å½“çš„æ•°å€¼ã€‚</li> <li>å¦‚æœä¸Enable AOFï¼Œä»…é Master-Slave Repllcationå®ç°é«˜å¯ç”¨æ€§ä¹Ÿå¯ä»¥ï¼Œèƒ½çœæ‰ä¸€å¤§ç¬”IOï¼Œä¹Ÿå‡å°‘äº†rewriteæ—¶å¸¦æ¥çš„ç³»ç»Ÿæ³¢åŠ¨ã€‚ä»£ä»·æ˜¯å¦‚æœMaster/SlaveåŒæ—¶å€’æ‰ï¼Œä¼šä¸¢å¤±åå‡ åˆ†é’Ÿçš„æ•°æ®ï¼Œå¯åŠ¨è„šæœ¬ä¹Ÿè¦æ¯”è¾ƒä¸¤ä¸ªMaster/Slave ä¸­çš„ RDBæ–‡ä»¶ï¼Œè½½å…¥è¾ƒæ–°çš„é‚£ä¸ªï¼Œå¾®åšå°±æ˜¯è¿™ç§æ¶æ„ã€‚</li></ul></li></ol></li></ol> <h3 id="redisçš„å‘å¸ƒå’Œè®¢é˜…"><a href="#redisçš„å‘å¸ƒå’Œè®¢é˜…" class="header-anchor">#</a> Redisçš„å‘å¸ƒå’Œè®¢é˜…</h3> <h4 id="ä»€ä¹ˆæ˜¯å‘å¸ƒå’Œè®¢é˜…"><a href="#ä»€ä¹ˆæ˜¯å‘å¸ƒå’Œè®¢é˜…" class="header-anchor">#</a> ä»€ä¹ˆæ˜¯å‘å¸ƒå’Œè®¢é˜…</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Rediså‘å¸ƒè®¢é˜…<span class="token punctuation">(</span>pub/sub<span class="token punctuation">)</span>æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æ¨¡å¼ï¼šå‘é€è€…<span class="token punctuation">(</span>pub<span class="token punctuation">)</span>å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€…<span class="token punctuation">(</span>sub<span class="token punctuation">)</span>æ¥æ”¶æ¶ˆæ¯
Rediså®¢æˆ·ç«¯å¯ä»¥è®¢é˜…ä»»æ„æ•°é‡çš„é¢‘é“
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="å‘å¸ƒè®¢é˜…å‘½ä»¤è¡Œå®ç°-å¹¿å‘ç”¨äºæ„å»ºå³æ—¶é€šä¿¡åº”ç”¨-å¦‚ç½‘ç»œèŠå¤©å®¤-chatroom-å’Œå®æ—¶å¹¿æ’­ã€å®æ—¶æé†’ç­‰"><a href="#å‘å¸ƒè®¢é˜…å‘½ä»¤è¡Œå®ç°-å¹¿å‘ç”¨äºæ„å»ºå³æ—¶é€šä¿¡åº”ç”¨-å¦‚ç½‘ç»œèŠå¤©å®¤-chatroom-å’Œå®æ—¶å¹¿æ’­ã€å®æ—¶æé†’ç­‰" class="header-anchor">#</a> å‘å¸ƒè®¢é˜…å‘½ä»¤è¡Œå®ç°(å¹¿å‘ç”¨äºæ„å»ºå³æ—¶é€šä¿¡åº”ç”¨ï¼Œå¦‚ç½‘ç»œèŠå¤©å®¤(chatroom)å’Œå®æ—¶å¹¿æ’­ã€å®æ—¶æé†’ç­‰)</h4> <ul><li>PSUBSCRIBE pattern [pattern ...]ï¼šè®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªç¬¦åˆç»™å®šæ¨¡å¼çš„é¢‘é“</li> <li>PUBSUB subcommand [argument [argument ...]]ï¼šæŸ¥çœ‹è®¢é˜…å’Œå‘å¸ƒç³»ç»ŸçŠ¶æ€</li> <li>PUBLISH channel messageï¼šå°†æ¶ˆæ¯å‘é€åˆ°æŒ‡å®šçš„é¢‘é“</li> <li>PUNSUBSCRIBE [pattern [pattern ...]]ï¼šé€€è®¢æ‰€æœ‰ç»™å®šæ¨¡å¼çš„é¢‘é“</li> <li>SUBSCRIBE channel [channel...]ï¼šè®¢é˜…ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªé¢‘é“çš„ä¿¡æ¯</li> <li>UNSUBSCRIBE [channel [channel...]]ï¼šé€€è®¢ç»™å®šçš„é¢‘é“</li></ul> <ol><li><p>æ‰“å¼€ä¸€ä¸ªå®¢æˆ·ç«¯è®¢é˜…ä¸€ä¸ªé¢‘é“ä¸ºchannel1</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>SUBSCRIBE channel1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://images.zaiolos.top/images/image-20211101133528305.png" alt="image-20211101133528305"></p></li> <li><p>æ‰“å¼€å¦ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œç»™channel1å‘å¸ƒæ¶ˆæ¯hello</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>publish channel1 hello
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://images.zaiolos.top/images/image-20211101133533705.png" alt="image-20211101133533705"></p> <p>å‘å¸ƒæˆåŠŸè¿”å›çš„æ˜¯è®¢é˜…è€…çš„æ•°é‡</p></li> <li><p>è®¢é˜…äº†channel1çš„è®¢é˜…è€…æ”¶åˆ°æ¶ˆæ¯</p> <p><img src="https://images.zaiolos.top/images/image-20211101133538886.png" alt="image-20211101133538886"></p> <p>æ³¨ï¼šå‘å¸ƒçš„æ¶ˆæ¯æ²¡æœ‰æŒä¹…åŒ–ï¼Œæ²¡æœ‰è®¢é˜…çš„å®¢æˆ·ç«¯æ”¶ä¸åˆ°helloï¼Œåªèƒ½æ”¶åˆ°è®¢é˜…åchannel1å‘å¸ƒçš„æ¶ˆæ¯</p></li></ol> <p>å‘å¸ƒè®¢é˜…çš„åŸç†ï¼š</p> <div class="custom-block note"><p class="custom-block-title">ç¬”è®°</p> <p>Redisæ˜¯ä½¿ç”¨Cå®ç°çš„ï¼Œé€šè¿‡åˆ†æRedis æºç é‡Œçš„pubsub.cæ–‡ä»¶ï¼Œäº†è§£å‘å¸ƒå’Œè®¢é˜…æœºåˆ¶çš„åº•å±‚å®ç°ï¼Œç±æ­¤åŠ æ·±å¯¹Redisçš„ç†è§£ã€‚Redis é€šè¿‡PUBLISHã€SUBSCRIBEå’ŒPSUBSCRIBEç­‰å‘½ä»¤å®ç°å‘å¸ƒå’Œè®¢é˜…åŠŸèƒ½ã€‚
é€šè¿‡SUBSCRIBEå‘½ä»¤è®¢é˜…æŸé¢‘é“åï¼Œredis-serveré‡Œç»´æŠ¤äº†ä¸€ä¸ªå­—å…¸ï¼Œå­—å…¸çš„é”®å°±æ˜¯ä¸€ä¸ªä¸ªchannelï¼Œè€Œå­—å…¸çš„å€¼åˆ™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰è®¢é˜…è¿™ä¸ªchannelçš„å®¢æˆ·ç«¯ã€‚SUBSCRIBEå‘½ä»¤çš„å…³é”®ï¼Œå°±æ˜¯å°†å®¢æˆ·ç«¯æ·»åŠ åˆ°ç»™å®šchannelçš„è®¢é˜…é“¾è¡¨ä¸­ã€‚é€šè¿‡PUBLISHå‘½ä»¤å‘è®¢é˜…è€…å‘é€æ¶ˆæ¯ï¼Œredis-server ä¼šä½¿ç”¨ç»™å®šçš„é¢‘é“ä½œä¸ºé”®ï¼Œåœ¨å®ƒæ‰€ç»´æŠ¤çš„channelå­—å…¸ä¸­æŸ¥æ‰¾è®°å½•äº†è®¢é˜…è¿™ä¸ªé¢‘é“çš„æ‰€æœ‰å®¢æˆ·ç«¯çš„é“¾è¡¨ï¼Œéå†è¿™ä¸ªé“¾è¡¨ï¼Œå°†æ¶ˆæ¯å‘å¸ƒç»™æ‰€æœ‰è®¢é˜…è€…ã€‚
Pub/Subä»å­—é¢ä¸Šç†è§£å°±æ˜¯å‘å¸ƒ( Publish )ä¸è®¢é˜…(Subscribe )ï¼Œåœ¨Redisä¸­ï¼Œä½ å¯ä»¥è®¾å®šå¯¹æŸä¸€ä¸ªkeyå€¼è¿›è¡Œæ¶ˆæ¯å‘å¸ƒåŠæ¶ˆæ¯è®¢é˜…ï¼Œå½“ä¸€ä¸ªkeyå€¼ä¸Šè¿›è¡Œäº†æ¶ˆæ¯å‘å¸ƒåï¼Œæ‰€æœ‰è®¢é˜…å®ƒçš„å®¢æˆ·ç«¯éƒ½ä¼šæ”¶åˆ°ç›¸åº”çš„æ¶ˆæ¯ã€‚è¿™ä¸€åŠŸèƒ½æœ€æ˜æ˜¾çš„ç”¨æ³•å°±æ˜¯ç”¨ä½œå®æ—¶æ¶ˆæ¯ç³»ç»Ÿï¼Œæ¯”å¦‚æ™®é€šçš„å³æ—¶èŠå¤©ï¼Œç¾¤èŠç­‰åŠŸèƒ½ã€‚</p></div> <p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p> <ul><li>å®æ—¶æ¶ˆæ¯ç³»ç»Ÿ(ç½‘ç«™çš„æ¶ˆæ¯æ¨é€)</li> <li>å®æ—¶èŠå¤©(é¢‘é“å½“åšèŠå¤©å®¤ï¼Œå°†ä¿¡æ¯å›æ˜¾ç»™æ‰€æœ‰äºº)</li> <li>è®¢é˜…ï¼Œå…³æ³¨ç³»ç»Ÿ</li></ul> <p>æ›´å¤æ‚çš„åœºæ™¯å°±ä¼šä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶ï¼šMQ ç­‰</p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/hnistzdk/my-notes/edit/master/docs/03.æ•°æ®åº“/10.Redis/01.Rediså…¨ç¬”è®°.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/my-notes/tags/?tag=Redis" title="æ ‡ç­¾">#Redis</a></div> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°:</span> <span class="time">2022/10/04, 8:10:00</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/my-notes/redis/" class="page-nav-centre page-nav-centre-prev router-link-active"><div class="tooltip">Redis - çŸ¥è¯†ä½“ç³»</div></a> <a href="/my-notes/redis/1/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Redis - æ¦‚å¿µå’ŒåŸºç¡€</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/my-notes/redis/" class="prev router-link-active">Redis - çŸ¥è¯†ä½“ç³»</a></span> <span class="next"><a href="/my-notes/redis/1/">Redis - æ¦‚å¿µå’ŒåŸºç¡€</a>â†’
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:369365576@qq.com" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/hnistzdk" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/hnistzdk" title="GitHub" target="_blank" class="iconfont icon-gitee"></a><a href="http://music.163.com/playlist?id=936642760&amp;userid=604011130" title="æ™®é€šæ­Œå•" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2022-2023
    <span>zdk | notes <br><a href=http://beian.miit.gov.cn/>æ¹˜ICPå¤‡2022001117å·-1</a><br><img src=/img/ghs.png /><a href=http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=51142102511562>å·å…¬ç½‘å®‰å¤‡ 51142102511562å·</a><br><a href=https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referra><img src=/img/upyun.png align=absmiddle width=70px height=30px /></a> <span> æä¾›åŠ é€ŸæœåŠ¡ </span></span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div id="goTop" class="hide-cat" data-v-bf92849a></div><div></div><div></div></div></div>
    <script src="/my-notes/assets/js/app.7f931ee0.js" defer></script><script src="/my-notes/assets/js/2.e52a17f8.js" defer></script><script src="/my-notes/assets/js/77.61eb4f51.js" defer></script><script src="/my-notes/assets/js/8.c2fa6f68.js" defer></script><script src="/my-notes/assets/js/6.bcc16901.js" defer></script>
  </body>
</html>
