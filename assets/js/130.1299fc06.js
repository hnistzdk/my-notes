(window.webpackJsonp=window.webpackJsonp||[]).push([[130],{476:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("hr"),s._v(" "),t("p",[t("strong",[s._v("Table of Contents")]),s._v(" "),t("em",[s._v("generated with "),t("a",{attrs:{href:"https://github.com/thlorenz/doctoc",target:"_blank",rel:"noopener noreferrer"}},[s._v("DocToc"),t("OutboundLink")],1)])]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#zookeeper"}},[s._v("Zookeeper")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#provider%E6%B3%A8%E5%86%8C"}},[s._v("provider注册")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#%E6%96%B0%E5%BB%BApayment8004%E6%A8%A1%E5%9D%97"}},[s._v("新建payment8004模块")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%A2%9E%E5%8A%A0%E4%BE%9D%E8%B5%96"}},[s._v("增加依赖")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E4%BF%AE%E6%94%B9yaml"}},[s._v("修改yaml")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%A2%9E%E5%8A%A0%E9%AA%8C%E8%AF%81%E6%8E%A5%E5%8F%A3"}},[s._v("增加验证接口")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E9%AA%8C%E8%AF%81"}},[s._v("验证")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E4%B8%B4%E6%97%B6or%E6%8C%81%E4%B9%85%E8%8A%82%E7%82%B9"}},[s._v("临时or持久节点")])])])]),s._v(" "),t("li",[t("a",{attrs:{href:"#consumer%E6%B3%A8%E5%86%8C"}},[s._v("consumer注册")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#%E9%AA%8C%E8%AF%81-1"}},[s._v("验证")])])])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E9%9B%86%E7%BE%A4zookeeper%E9%85%8D%E7%BD%AE"}},[s._v("集群zookeeper配置")])])])]),s._v(" "),t("li",[t("a",{attrs:{href:"#consul"}},[s._v("Consul")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#consul%E8%83%BD%E5%B9%B2%E5%98%9B"}},[s._v("Consul能干嘛")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3"}},[s._v("中文文档")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85"}},[s._v("下载安装")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%90%AF%E5%8A%A8"}},[s._v("启动")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#provider%E6%B3%A8%E5%86%8C-1"}},[s._v("provider注册")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#pom"}},[s._v("pom")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#yaml"}},[s._v("yaml")])])])]),s._v(" "),t("li",[t("a",{attrs:{href:"#consumer%E6%B3%A8%E5%86%8C-1"}},[s._v("consumer注册")])])])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E4%B8%89%E4%B8%AA%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E7%9A%84%E5%BC%82%E5%90%8C%E7%82%B9"}},[s._v("三个注册中心的异同点")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#cap"}},[s._v("CAP")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#ap"}},[s._v("AP")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#cp"}},[s._v("CP")])])])])]),s._v(" "),t("hr"),s._v(" "),t("h2",{attrs:{id:"zookeeper"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper"}},[s._v("#")]),s._v(" Zookeeper")]),s._v(" "),t("blockquote",[t("p",[s._v("首先，使用zookeeper作为注册中心，肯定需要启动zookeeper的server，这里使用的zookeeper版本是3.5.10，springcloud的版本是2020.0.5")])]),s._v(" "),t("p",[s._v("zookeeper下载地址:https://cloud.zaiolos.top/s/oRF7")]),s._v(" "),t("ul",[t("li",[s._v("下载好后直接通过zkServer.cmd(我在win上)启动即可")])]),s._v(" "),t("h3",{attrs:{id:"provider注册"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#provider注册"}},[s._v("#")]),s._v(" provider注册")]),s._v(" "),t("h4",{attrs:{id:"新建payment8004模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#新建payment8004模块"}},[s._v("#")]),s._v(" 新建payment8004模块")]),s._v(" "),t("ul",[t("li",[s._v("和其他payment步骤一致，端口号修改即可")])]),s._v(" "),t("h4",{attrs:{id:"增加依赖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#增加依赖"}},[s._v("#")]),s._v(" 增加依赖")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!-- zookeeper添加的依赖(zk的版本是3.5.10) --\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.cloud"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-cloud-starter-zookeeper-discovery"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h4",{attrs:{id:"修改yaml"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改yaml"}},[s._v("#")]),s._v(" 修改yaml")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8004")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" cloud"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("payment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("zookeeper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connect-string")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h4",{attrs:{id:"增加验证接口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#增加验证接口"}},[s._v("#")]),s._v(" 增加验证接口")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Slf4j")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/payment"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PaymentController")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${server.port}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" serverPort"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/zk"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("paymentZk")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"springcloud with zookeeper: "')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("serverPort"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\t"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UUID")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("randomUUID")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h4",{attrs:{id:"验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证"}},[s._v("#")]),s._v(" 验证")]),s._v(" "),t("blockquote",[t("p",[s._v("启动项目，再启动zkCli.cmd，执行"),t("code",[s._v("ls /")]),s._v("命令后，可以看到新增了services节点，进入services节点即可发现注册进去的payment服务")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://images.zaiolos.top/images/202210251637872.png",alt:"image-20221025163747781"}})]),s._v(" "),t("blockquote",[t("p",[s._v("进入cloud-payment-service节点中我们发现有一串无规律编码的节点，这个节点就是我们真正注册进的服务所表示的节点(名为cloud-payment-service的服务，代表了其可以为多个)，")]),s._v(" "),t("p",[s._v("使用get命令，可以获得此节点的JSON串信息，其中就有ip port等等")]),s._v(" "),t("p",[t("code",[s._v("get /services/cloud-payment-service/0af6e3c5-57d4-4e52-97b9-b58c9fe719aa")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://images.zaiolos.top/images/202210251642354.png",alt:"image-20221025164227296"}})]),s._v(" "),t("h4",{attrs:{id:"临时or持久节点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#临时or持久节点"}},[s._v("#")]),s._v(" 临时or持久节点")]),s._v(" "),t("p",[t("code",[s._v("注册进去的服务节点在zookeeper中是临时节点还是持久节点？")])]),s._v(" "),t("blockquote",[t("p",[s._v("在关闭payment服务以后，zookeeper收不到心跳，是会将注册的服务节点进行移除的，所以是临时节点")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://images.zaiolos.top/images/202210251649749.png",alt:"image-20221025164927675"}})]),s._v(" "),t("h3",{attrs:{id:"consumer注册"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#consumer注册"}},[s._v("#")]),s._v(" consumer注册")]),s._v(" "),t("blockquote",[t("p",[s._v("基本步骤和provider注册一致，yaml和pom都一样，启动后可在zCli中看到对应的consumer服务及其节点信息")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://images.zaiolos.top/images/202210251707025.png",alt:"image-20221025170707982"}})]),s._v(" "),t("h4",{attrs:{id:"验证-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证-2"}},[s._v("#")]),s._v(" 验证")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Slf4j")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderZkController")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    public static final String PAYMENT_URL = "http://localhost:8001";')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 调用地址改为微服务的名称(yaml中的application.name,这样调用时就会去eureka中获取提供者)\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PAYMENT_URL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://cloud-payment-service"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RestTemplate")]),s._v(" restTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/consumer/payment/zk"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Payment")]),s._v(" payment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" restTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getForObject")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PAYMENT_URL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/payment/zk"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://images.zaiolos.top/images/202210251714587.png",alt:"image-20221025171443547"}})]),s._v(" "),t("h3",{attrs:{id:"集群zookeeper配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#集群zookeeper配置"}},[s._v("#")]),s._v(" 集群zookeeper配置")]),s._v(" "),t("blockquote",[t("p",[s._v("在yaml中")]),s._v(" "),t("p",[s._v("zookeeper:\nconnect-string: localhost:2181,xxx:xxx,xxx:xxx  这样即可")])]),s._v(" "),t("h2",{attrs:{id:"consul"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#consul"}},[s._v("#")]),s._v(" Consul")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("简介")]),s._v(" "),t("p",[s._v("Consul是一套开源的分布式服务发现和配置管理系统，由HashiCorp公司用"),t("code",[s._v("Go语言开发")])]),s._v(" "),t("br"),s._v(" "),t("p",[s._v("提供了微服务系统中的服务治理、配置中心、控制总线等功能。这些功能中的每一个都可以根据需要单独使用，也可以一起使用以构建全方位的服务网格，总之Consul提供了一种完整的服务网格解决方案")]),s._v(" "),t("br"),s._v(" "),t("p",[s._v("它具有很多优点。包括:基于raft协议，比较简洁；支持健康检查，同时支持HTTP和DNS协议；支持跨数据中心的WAN集群；提供图形界面；跨平台，支持Linux、Mac、Windows")])]),s._v(" "),t("h3",{attrs:{id:"consul能干嘛"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#consul能干嘛"}},[s._v("#")]),s._v(" Consul能干嘛")]),s._v(" "),t("ul",[t("li",[s._v("服务发现：提供HTTP和DNS两种发现方式")]),s._v(" "),t("li",[s._v("健康检测：支持多种方式，HTTP、TCP、Docker、Shell脚本定制化")]),s._v(" "),t("li",[s._v("KV存储：提供Key、Value键值对的存储方式")]),s._v(" "),t("li",[s._v("多数据中心：Consul支持多数据中心")]),s._v(" "),t("li",[s._v("可视化Web界面")])]),s._v(" "),t("h3",{attrs:{id:"中文文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#中文文档"}},[s._v("#")]),s._v(" 中文文档")]),s._v(" "),t("p",[s._v("https://www.springcloud.cc/spring-cloud-consul.html")]),s._v(" "),t("h3",{attrs:{id:"下载安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载安装"}},[s._v("#")]),s._v(" 下载安装")]),s._v(" "),t("p",[s._v("官网下载即可 https://www.consul.io/ win版本就是一个exe文件")]),s._v(" "),t("h3",{attrs:{id:"启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[s._v("#")]),s._v(" 启动")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("consul "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--version")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看版本")]),s._v("\nconsul agent "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-dev")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#以开发模式启动")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动后访问 http://localhost:8500")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("控制面板：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://images.zaiolos.top/images/202210251754835.png",alt:"image-20221025175445760"}})]),s._v(" "),t("h3",{attrs:{id:"provider注册-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#provider注册-2"}},[s._v("#")]),s._v(" provider注册")]),s._v(" "),t("h4",{attrs:{id:"pom"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pom"}},[s._v("#")]),s._v(" pom")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!-- consul依赖 --\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.cloud"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-cloud-starter-consul-discovery"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h4",{attrs:{id:"yaml"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#yaml"}},[s._v("#")]),s._v(" yaml")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### consul服务端口号")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8006")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" consul"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("provider"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("payment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##consul注册中心地址")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("consul")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("host")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" localhost\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8500")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("discovery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("service-name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("spring.application.name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        hostname: 127.0.0.1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("blockquote",[t("p",[s._v("然后添加主启动类，编写测试controller")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Slf4j")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsulPaymentController")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${server.port}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" serverPort"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payment/consul"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("paymentZk")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"springcloud with consul: "')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("serverPort"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\t"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UUID")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("randomUUID")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("启动服务可以发现consul控制台已显示成功")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://images.zaiolos.top/images/202210251812697.png",alt:"image-20221025181217633"}})]),s._v(" "),t("h3",{attrs:{id:"consumer注册-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#consumer注册-2"}},[s._v("#")]),s._v(" consumer注册")]),s._v(" "),t("blockquote",[t("p",[s._v("步骤基本一致，不赘述")])]),s._v(" "),t("p",[s._v("直接测试")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Slf4j")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderConsulController")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    public static final String PAYMENT_URL = "http://localhost:8001";')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 调用地址改为微服务的名称(yaml中的application.name,这样调用时就会去eureka中获取提供者)\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PAYMENT_URL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://consul-provider-payment-service"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RestTemplate")]),s._v(" restTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/consumer/payment/consul"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" restTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getForObject")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PAYMENT_URL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/payment/consul"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://images.zaiolos.top/images/202210251819206.png",alt:"image-20221025181923146"}})]),s._v(" "),t("h2",{attrs:{id:"三个注册中心的异同点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三个注册中心的异同点"}},[s._v("#")]),s._v(" 三个注册中心的异同点")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("组件名")]),s._v(" "),t("th",[s._v("语言")]),s._v(" "),t("th",[s._v("CAP")]),s._v(" "),t("th",[s._v("服务健康检查")]),s._v(" "),t("th",[s._v("对外暴露接口")]),s._v(" "),t("th",[s._v("Spring Cloud集成")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("Eureka")]),s._v(" "),t("td",[s._v("Java")]),s._v(" "),t("td",[s._v("AP")]),s._v(" "),t("td",[s._v("可配支持")]),s._v(" "),t("td",[s._v("HTTP")]),s._v(" "),t("td",[s._v("已集成")])]),s._v(" "),t("tr",[t("td",[s._v("Consul")]),s._v(" "),t("td",[s._v("Go")]),s._v(" "),t("td",[s._v("CP")]),s._v(" "),t("td",[s._v("支持")]),s._v(" "),t("td",[s._v("HTTP/DNS")]),s._v(" "),t("td",[s._v("已集成")])]),s._v(" "),t("tr",[t("td",[s._v("Zookeeper")]),s._v(" "),t("td",[s._v("Java")]),s._v(" "),t("td",[s._v("CP")]),s._v(" "),t("td",[s._v("支持")]),s._v(" "),t("td",[s._v("客户端")]),s._v(" "),t("td",[s._v("已集成")])])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://images.zaiolos.top/images/202210251824882.png",alt:"image-20221025182417815"}})]),s._v(" "),t("h3",{attrs:{id:"cap"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cap"}},[s._v("#")]),s._v(" CAP")]),s._v(" "),t("ul",[t("li",[s._v("C:Consistency(强一致性)")]),s._v(" "),t("li",[s._v("A:Availability(高可用性)")]),s._v(" "),t("li",[s._v("P:Partition tolerance(分区容错性)")])]),s._v(" "),t("p",[t("code",[s._v("CAP理论关注丽都是数据，而不是整体系统设计的策略")])]),s._v(" "),t("blockquote",[t("p",[t("strong",[s._v("最多只能同时较好的满足两个")])]),s._v(" "),t("p",[s._v("CAP理论的核心是:"),t("strong",[s._v("一个分布式系统不可能同时很好的满足一致性，可用性和分区容错性这三个需求")])]),s._v(" "),t("p",[s._v("因此，根据CAP原理将NoSQL数据库分成了满足CA原则、满足CP原则和满足AP原则三大类:")]),s._v(" "),t("p",[s._v("CA：单点集群，满足一致性，可用性的系统，通常在可扩展性上不太强大。\nCP：满足一致性，分区容错性的系统，通常性能不是特别高。\nAP：满足可用性，分区容错性的系统，通常可能对一致性要求低一些。")])]),s._v(" "),t("h3",{attrs:{id:"ap"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ap"}},[s._v("#")]),s._v(" AP")]),s._v(" "),t("blockquote",[t("p",[s._v("AP架构，当网络分区出现后，为了保证可用性，系统B"),t("code",[s._v("可以返回久值")]),s._v("，保证系统的可用性")]),s._v(" "),t("p",[t("strong",[s._v("结论：违背了一致性C的要求，只满足可用性和分区容错，即AP")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://images.zaiolos.top/images/202210251831191.png",alt:"image-20221025183157107"}})]),s._v(" "),t("h3",{attrs:{id:"cp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cp"}},[s._v("#")]),s._v(" CP")]),s._v(" "),t("blockquote",[t("p",[s._v("CP架构\n当网络分区出现后，为了保证一致性，就必须拒绝请求，否则无法保证一致性")]),s._v(" "),t("p",[t("strong",[s._v("结论:违背了可用性A的要求，只满足一致性和分区容错，即CP")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://images.zaiolos.top/images/202210251834073.png",alt:"image-20221025183440958"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);