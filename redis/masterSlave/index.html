<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redisé›†ç¾¤:ä¸»ä»æ¨¡å¼ | DK&#39;s Notes</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/my-notes/img/logo.jpg">
    <link rel="stylesheet" href="/my-notes//at.alicdn.com/t/font_3334662_k54hl9700p.css">
    <link rel="stylesheet" href="/my-notes//at.alicdn.com/t/font_3334662_k54hl9700p.css">
    <link rel="stylesheet" href="/my-notes//at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <link rel="stylesheet" href="/my-notes//at.alicdn.com/t/font_3334691_b03dsaqrwck.css">
    <meta name="description" content="æ—¶ä¸æˆ‘å¾…ï¼Œèˆæˆ‘å…¶è°">
    <meta name="keywords" content="Java">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/my-notes/assets/css/0.styles.565c6041.css" as="style"><link rel="preload" href="/my-notes/assets/js/app.7f931ee0.js" as="script"><link rel="preload" href="/my-notes/assets/js/2.e52a17f8.js" as="script"><link rel="preload" href="/my-notes/assets/js/85.73902eef.js" as="script"><link rel="preload" href="/my-notes/assets/js/6.bcc16901.js" as="script"><link rel="prefetch" href="/my-notes/assets/js/10.fee8f7ec.js"><link rel="prefetch" href="/my-notes/assets/js/100.9be19fac.js"><link rel="prefetch" href="/my-notes/assets/js/101.9aaae740.js"><link rel="prefetch" href="/my-notes/assets/js/102.a72c0165.js"><link rel="prefetch" href="/my-notes/assets/js/103.d47527c3.js"><link rel="prefetch" href="/my-notes/assets/js/104.d5bae560.js"><link rel="prefetch" href="/my-notes/assets/js/105.fdb07f67.js"><link rel="prefetch" href="/my-notes/assets/js/106.b89b7d37.js"><link rel="prefetch" href="/my-notes/assets/js/107.a9d142eb.js"><link rel="prefetch" href="/my-notes/assets/js/108.1b8c8817.js"><link rel="prefetch" href="/my-notes/assets/js/109.0cd465a0.js"><link rel="prefetch" href="/my-notes/assets/js/11.75b40e53.js"><link rel="prefetch" href="/my-notes/assets/js/110.4c56723c.js"><link rel="prefetch" href="/my-notes/assets/js/111.12b9cb85.js"><link rel="prefetch" href="/my-notes/assets/js/112.3f791546.js"><link rel="prefetch" href="/my-notes/assets/js/113.d9998b70.js"><link rel="prefetch" href="/my-notes/assets/js/114.faf0da70.js"><link rel="prefetch" href="/my-notes/assets/js/115.35d9b5f6.js"><link rel="prefetch" href="/my-notes/assets/js/116.13fbe1ab.js"><link rel="prefetch" href="/my-notes/assets/js/117.bffe4459.js"><link rel="prefetch" href="/my-notes/assets/js/118.eabefad3.js"><link rel="prefetch" href="/my-notes/assets/js/119.8593c8a5.js"><link rel="prefetch" href="/my-notes/assets/js/12.34db197a.js"><link rel="prefetch" href="/my-notes/assets/js/120.f5b73620.js"><link rel="prefetch" href="/my-notes/assets/js/121.d3137f51.js"><link rel="prefetch" href="/my-notes/assets/js/122.f47bca90.js"><link rel="prefetch" href="/my-notes/assets/js/123.6d846b88.js"><link rel="prefetch" href="/my-notes/assets/js/124.49825ebc.js"><link rel="prefetch" href="/my-notes/assets/js/125.6d3a9ce5.js"><link rel="prefetch" href="/my-notes/assets/js/126.eeef761b.js"><link rel="prefetch" href="/my-notes/assets/js/127.0f7e28c1.js"><link rel="prefetch" href="/my-notes/assets/js/128.4a35f42a.js"><link rel="prefetch" href="/my-notes/assets/js/129.e364bc33.js"><link rel="prefetch" href="/my-notes/assets/js/13.ab02aa59.js"><link rel="prefetch" href="/my-notes/assets/js/130.1299fc06.js"><link rel="prefetch" href="/my-notes/assets/js/131.61faa498.js"><link rel="prefetch" href="/my-notes/assets/js/132.9e46a3c4.js"><link rel="prefetch" href="/my-notes/assets/js/133.0b6e6f7f.js"><link rel="prefetch" href="/my-notes/assets/js/134.6724b7a7.js"><link rel="prefetch" href="/my-notes/assets/js/135.1d3daca0.js"><link rel="prefetch" href="/my-notes/assets/js/136.190f2a28.js"><link rel="prefetch" href="/my-notes/assets/js/137.5ce96397.js"><link rel="prefetch" href="/my-notes/assets/js/138.c0b55b02.js"><link rel="prefetch" href="/my-notes/assets/js/139.068ed7d7.js"><link rel="prefetch" href="/my-notes/assets/js/14.721e1994.js"><link rel="prefetch" href="/my-notes/assets/js/140.5226be4f.js"><link rel="prefetch" href="/my-notes/assets/js/141.196d1aa6.js"><link rel="prefetch" href="/my-notes/assets/js/142.11cbb52f.js"><link rel="prefetch" href="/my-notes/assets/js/143.509f8300.js"><link rel="prefetch" href="/my-notes/assets/js/144.436415bf.js"><link rel="prefetch" href="/my-notes/assets/js/145.a25cd8bc.js"><link rel="prefetch" href="/my-notes/assets/js/146.a2d1d780.js"><link rel="prefetch" href="/my-notes/assets/js/147.1cac4e0a.js"><link rel="prefetch" href="/my-notes/assets/js/148.5c361eba.js"><link rel="prefetch" href="/my-notes/assets/js/149.f62eacfa.js"><link rel="prefetch" href="/my-notes/assets/js/15.35ef567c.js"><link rel="prefetch" href="/my-notes/assets/js/150.80b0aa20.js"><link rel="prefetch" href="/my-notes/assets/js/151.6f0e31d8.js"><link rel="prefetch" href="/my-notes/assets/js/152.86efa86d.js"><link rel="prefetch" href="/my-notes/assets/js/153.d6605e26.js"><link rel="prefetch" href="/my-notes/assets/js/154.e5b33cc7.js"><link rel="prefetch" href="/my-notes/assets/js/155.5d3cf278.js"><link rel="prefetch" href="/my-notes/assets/js/156.bcb9784f.js"><link rel="prefetch" href="/my-notes/assets/js/157.ca3b8e8c.js"><link rel="prefetch" href="/my-notes/assets/js/158.eb0116b8.js"><link rel="prefetch" href="/my-notes/assets/js/159.309a26da.js"><link rel="prefetch" href="/my-notes/assets/js/16.ca698d39.js"><link rel="prefetch" href="/my-notes/assets/js/160.ce6e9321.js"><link rel="prefetch" href="/my-notes/assets/js/161.ac24f13a.js"><link rel="prefetch" href="/my-notes/assets/js/162.c3390211.js"><link rel="prefetch" href="/my-notes/assets/js/163.8267154f.js"><link rel="prefetch" href="/my-notes/assets/js/164.3ce822f9.js"><link rel="prefetch" href="/my-notes/assets/js/165.80836bd1.js"><link rel="prefetch" href="/my-notes/assets/js/166.7346e59a.js"><link rel="prefetch" href="/my-notes/assets/js/167.5577b6af.js"><link rel="prefetch" href="/my-notes/assets/js/168.23aca72c.js"><link rel="prefetch" href="/my-notes/assets/js/169.ce891665.js"><link rel="prefetch" href="/my-notes/assets/js/17.549cfc80.js"><link rel="prefetch" href="/my-notes/assets/js/170.b4aebdaf.js"><link rel="prefetch" href="/my-notes/assets/js/171.39cdd90b.js"><link rel="prefetch" href="/my-notes/assets/js/172.06cd5671.js"><link rel="prefetch" href="/my-notes/assets/js/173.44c7c161.js"><link rel="prefetch" href="/my-notes/assets/js/174.62d8a34f.js"><link rel="prefetch" href="/my-notes/assets/js/175.baa645ac.js"><link rel="prefetch" href="/my-notes/assets/js/176.8361f852.js"><link rel="prefetch" href="/my-notes/assets/js/177.4a8f2fec.js"><link rel="prefetch" href="/my-notes/assets/js/178.f594def6.js"><link rel="prefetch" href="/my-notes/assets/js/179.2338f129.js"><link rel="prefetch" href="/my-notes/assets/js/18.a8b4f826.js"><link rel="prefetch" href="/my-notes/assets/js/180.1b2f62df.js"><link rel="prefetch" href="/my-notes/assets/js/181.10759f41.js"><link rel="prefetch" href="/my-notes/assets/js/182.c0e1c3c5.js"><link rel="prefetch" href="/my-notes/assets/js/183.bdc8283f.js"><link rel="prefetch" href="/my-notes/assets/js/184.30a6f685.js"><link rel="prefetch" href="/my-notes/assets/js/185.1949079b.js"><link rel="prefetch" href="/my-notes/assets/js/186.bb7c7093.js"><link rel="prefetch" href="/my-notes/assets/js/187.1d02d132.js"><link rel="prefetch" href="/my-notes/assets/js/188.5230fbeb.js"><link rel="prefetch" href="/my-notes/assets/js/189.2931d469.js"><link rel="prefetch" href="/my-notes/assets/js/19.16e1a44c.js"><link rel="prefetch" href="/my-notes/assets/js/190.9bd3b616.js"><link rel="prefetch" href="/my-notes/assets/js/191.d75de9d3.js"><link rel="prefetch" href="/my-notes/assets/js/192.dacb160e.js"><link rel="prefetch" href="/my-notes/assets/js/193.660b4fce.js"><link rel="prefetch" href="/my-notes/assets/js/194.45f8499e.js"><link rel="prefetch" href="/my-notes/assets/js/195.e91d4663.js"><link rel="prefetch" href="/my-notes/assets/js/196.e94176ac.js"><link rel="prefetch" href="/my-notes/assets/js/197.5acbb43f.js"><link rel="prefetch" href="/my-notes/assets/js/198.dc1a1207.js"><link rel="prefetch" href="/my-notes/assets/js/199.288adcec.js"><link rel="prefetch" href="/my-notes/assets/js/20.b19ef4b2.js"><link rel="prefetch" href="/my-notes/assets/js/200.3d318d2e.js"><link rel="prefetch" href="/my-notes/assets/js/21.e3682738.js"><link rel="prefetch" href="/my-notes/assets/js/22.fafa8b54.js"><link rel="prefetch" href="/my-notes/assets/js/23.9d683b40.js"><link rel="prefetch" href="/my-notes/assets/js/24.02c0c08c.js"><link rel="prefetch" href="/my-notes/assets/js/25.af427f02.js"><link rel="prefetch" href="/my-notes/assets/js/26.50a41828.js"><link rel="prefetch" href="/my-notes/assets/js/27.8f1d2fe6.js"><link rel="prefetch" href="/my-notes/assets/js/28.7f820229.js"><link rel="prefetch" href="/my-notes/assets/js/29.208cdce3.js"><link rel="prefetch" href="/my-notes/assets/js/3.32ea0d41.js"><link rel="prefetch" href="/my-notes/assets/js/30.e7a171d3.js"><link rel="prefetch" href="/my-notes/assets/js/31.8ee9f363.js"><link rel="prefetch" href="/my-notes/assets/js/32.b33ae00e.js"><link rel="prefetch" href="/my-notes/assets/js/33.3a961845.js"><link rel="prefetch" href="/my-notes/assets/js/34.46f30eb6.js"><link rel="prefetch" href="/my-notes/assets/js/35.dedda1f7.js"><link rel="prefetch" href="/my-notes/assets/js/36.fb63ded5.js"><link rel="prefetch" href="/my-notes/assets/js/37.321340a9.js"><link rel="prefetch" href="/my-notes/assets/js/38.c21281dd.js"><link rel="prefetch" href="/my-notes/assets/js/39.01776b7e.js"><link rel="prefetch" href="/my-notes/assets/js/4.2466bf2a.js"><link rel="prefetch" href="/my-notes/assets/js/40.c6763f18.js"><link rel="prefetch" href="/my-notes/assets/js/41.afa4c2f3.js"><link rel="prefetch" href="/my-notes/assets/js/42.187357b5.js"><link rel="prefetch" href="/my-notes/assets/js/43.90030eae.js"><link rel="prefetch" href="/my-notes/assets/js/44.e11eff59.js"><link rel="prefetch" href="/my-notes/assets/js/45.760e3e3f.js"><link rel="prefetch" href="/my-notes/assets/js/46.0eccc1a4.js"><link rel="prefetch" href="/my-notes/assets/js/47.30e063f8.js"><link rel="prefetch" href="/my-notes/assets/js/48.5ab681d2.js"><link rel="prefetch" href="/my-notes/assets/js/49.5921c987.js"><link rel="prefetch" href="/my-notes/assets/js/5.56264475.js"><link rel="prefetch" href="/my-notes/assets/js/50.a53fa873.js"><link rel="prefetch" href="/my-notes/assets/js/51.5cded08c.js"><link rel="prefetch" href="/my-notes/assets/js/52.8960c473.js"><link rel="prefetch" href="/my-notes/assets/js/53.2ac21c0e.js"><link rel="prefetch" href="/my-notes/assets/js/54.361bc2f3.js"><link rel="prefetch" href="/my-notes/assets/js/55.3853b7f3.js"><link rel="prefetch" href="/my-notes/assets/js/56.754a3b4c.js"><link rel="prefetch" href="/my-notes/assets/js/57.1d9684e7.js"><link rel="prefetch" href="/my-notes/assets/js/58.0e7f2b60.js"><link rel="prefetch" href="/my-notes/assets/js/59.b37ab2f4.js"><link rel="prefetch" href="/my-notes/assets/js/60.f31d0aea.js"><link rel="prefetch" href="/my-notes/assets/js/61.5aebeb50.js"><link rel="prefetch" href="/my-notes/assets/js/62.cebf26d6.js"><link rel="prefetch" href="/my-notes/assets/js/63.6c7932ca.js"><link rel="prefetch" href="/my-notes/assets/js/64.cad8a013.js"><link rel="prefetch" href="/my-notes/assets/js/65.25e4c14e.js"><link rel="prefetch" href="/my-notes/assets/js/66.e9c81af6.js"><link rel="prefetch" href="/my-notes/assets/js/67.31cbef00.js"><link rel="prefetch" href="/my-notes/assets/js/68.edc93332.js"><link rel="prefetch" href="/my-notes/assets/js/69.5eaf1e4f.js"><link rel="prefetch" href="/my-notes/assets/js/7.5a6eeb6c.js"><link rel="prefetch" href="/my-notes/assets/js/70.7114cd64.js"><link rel="prefetch" href="/my-notes/assets/js/71.2066867c.js"><link rel="prefetch" href="/my-notes/assets/js/72.0f93cb73.js"><link rel="prefetch" href="/my-notes/assets/js/73.6c4d69ec.js"><link rel="prefetch" href="/my-notes/assets/js/74.0a91fc3c.js"><link rel="prefetch" href="/my-notes/assets/js/75.47e45f38.js"><link rel="prefetch" href="/my-notes/assets/js/76.99886a8d.js"><link rel="prefetch" href="/my-notes/assets/js/77.61eb4f51.js"><link rel="prefetch" href="/my-notes/assets/js/78.eff53df7.js"><link rel="prefetch" href="/my-notes/assets/js/79.e5d77573.js"><link rel="prefetch" href="/my-notes/assets/js/8.c2fa6f68.js"><link rel="prefetch" href="/my-notes/assets/js/80.8ac4e931.js"><link rel="prefetch" href="/my-notes/assets/js/81.82416621.js"><link rel="prefetch" href="/my-notes/assets/js/82.b7cea701.js"><link rel="prefetch" href="/my-notes/assets/js/83.eb0065f7.js"><link rel="prefetch" href="/my-notes/assets/js/84.45596ac9.js"><link rel="prefetch" href="/my-notes/assets/js/86.05a157f2.js"><link rel="prefetch" href="/my-notes/assets/js/87.83218f21.js"><link rel="prefetch" href="/my-notes/assets/js/88.bf05ee49.js"><link rel="prefetch" href="/my-notes/assets/js/89.089b5c96.js"><link rel="prefetch" href="/my-notes/assets/js/9.4a5b4024.js"><link rel="prefetch" href="/my-notes/assets/js/90.dc0b55a6.js"><link rel="prefetch" href="/my-notes/assets/js/91.ddc7da4f.js"><link rel="prefetch" href="/my-notes/assets/js/92.2b5c7d5f.js"><link rel="prefetch" href="/my-notes/assets/js/93.934a02e9.js"><link rel="prefetch" href="/my-notes/assets/js/94.3a6ede23.js"><link rel="prefetch" href="/my-notes/assets/js/95.0e946220.js"><link rel="prefetch" href="/my-notes/assets/js/96.3861fb05.js"><link rel="prefetch" href="/my-notes/assets/js/97.8627cefa.js"><link rel="prefetch" href="/my-notes/assets/js/98.6e0ee750.js"><link rel="prefetch" href="/my-notes/assets/js/99.5df99b25.js">
    <link rel="stylesheet" href="/my-notes/assets/css/0.styles.565c6041.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-notes/" class="home-link router-link-active"><img src="/my-notes/img/logo.jpg" alt="DK's Notes" class="logo"> <span class="site-name can-hide">DK's Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-notes/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/my-notes/about/website/tools/" class="nav-link">å¯¼èˆªç«™</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/my-notes/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java-Se</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/java/se/base/" class="nav-link">JavaåŸºç¡€</a></li></ul></li><li class="dropdown-item"><h4>Java-Seè¿›é˜¶-å¤šçº¿ç¨‹</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/java/se/thread/" class="nav-link">å¤šçº¿ç¨‹</a></li></ul></li><li class="dropdown-item"><h4>Java-Seè¿›é˜¶-java8æ–°ç‰¹æ€§</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/java/se/java8/" class="nav-link">java8æ–°ç‰¹æ€§</a></li></ul></li><li class="dropdown-item"><h4>Java-ee</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/javaweb/" class="nav-link">JavaWeb</a></li></ul></li><li class="dropdown-item"><h4>Javaè™šæ‹Ÿæœº</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/JVM/" class="nav-link">JVM</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ•°æ®åº“" class="dropdown-title"><a href="/my-notes/mysql/" class="link-title">æ•°æ®åº“</a> <span class="title" style="display:none;">æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>SQL æ•°æ®åº“</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/mysql/" class="nav-link">MySQL</a></li></ul></li><li class="dropdown-item"><h4>NoSQL æ•°æ®åº“</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/redis/" class="nav-link router-link-active">Redis</a></li><li class="dropdown-subitem"><a href="/my-notes/es/" class="nav-link">ElasticSearch</a></li><li class="dropdown-subitem"><a href="/my-notes/mongodb/" class="nav-link">MongoDB</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ¡†æ¶" class="dropdown-title"><a href="/my-notes/mybatis/study-note/" class="link-title">æ¡†æ¶</a> <span class="title" style="display:none;">æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>ORM</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/mybatis/study-note/" class="nav-link">MyBatis</a></li><li class="dropdown-subitem"><a href="/my-notes/mybatis-plus/study-note/" class="nav-link">MyBatis-Plus</a></li></ul></li><li class="dropdown-item"><h4>Spring</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/Spring/study-note/" class="nav-link">Spring</a></li></ul></li><li class="dropdown-item"><h4>SpringMVC</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/SpringMvc/study-note/1/" class="nav-link">SpringMVC1</a></li><li class="dropdown-subitem"><a href="/my-notes/SpringMvc/study-note/2/" class="nav-link">SpringMVC2</a></li></ul></li><li class="dropdown-item"><h4>SpringCloud</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/SpringCloud/" class="nav-link">SpringCloud</a></li></ul></li><li class="dropdown-item"><h4>ä¸­é—´ä»¶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/rabbitmq/" class="nav-link">RabbitMQ</a></li><li class="dropdown-subitem"><a href="/my-notes/dubbo/" class="nav-link">Dubbo</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¡¹ç›®" class="dropdown-title"><a href="/my-notes/project/seckill/" class="link-title">é¡¹ç›®</a> <span class="title" style="display:none;">é¡¹ç›®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-notes/project/seckill/" class="nav-link">ç§’æ€é¡¹ç›®</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å·¥å…·|éƒ¨ç½²" class="dropdown-title"><a href="/my-notes/git/" class="link-title">å·¥å…·|éƒ¨ç½²</a> <span class="title" style="display:none;">å·¥å…·|éƒ¨ç½²</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-notes/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/my-notes/Linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/my-notes/Docker/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/my-notes/JWT/note/" class="nav-link">JWT</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¢è¯•|åˆ·é¢˜" class="dropdown-title"><a href="/my-notes/work/interview/" class="link-title">é¢è¯•|åˆ·é¢˜</a> <span class="title" style="display:none;">é¢è¯•|åˆ·é¢˜</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-notes/work/interview/" class="nav-link">é¢è¯•</a></li><li class="dropdown-item"><!----> <a href="/my-notes/work/algorithm/" class="nav-link">åˆ·é¢˜</a></li></ul></div></div><div class="nav-item"><a href="/my-notes/dev/question/" class="nav-link">å¼€å‘é—®é¢˜ğŸ˜ˆ</a></div><div class="nav-item"><a href="/my-notes/designPattern/" class="nav-link">è®¾è®¡æ¨¡å¼</a></div><div class="nav-item"><a href="/my-notes/about/" class="nav-link">å…³äºğŸ’•</a></div><div class="nav-item"><a href="/my-notes/archives/" class="nav-link">å½’æ¡£ğŸ•›</a></div> <a href="https://github.com/hnistzdk/my-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.jpg"> <div class="blogger-info"><h3>é£</h3> <span>æ‘¸é±¼</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/my-notes/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/my-notes/about/website/tools/" class="nav-link">å¯¼èˆªç«™</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/my-notes/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java-Se</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/java/se/base/" class="nav-link">JavaåŸºç¡€</a></li></ul></li><li class="dropdown-item"><h4>Java-Seè¿›é˜¶-å¤šçº¿ç¨‹</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/java/se/thread/" class="nav-link">å¤šçº¿ç¨‹</a></li></ul></li><li class="dropdown-item"><h4>Java-Seè¿›é˜¶-java8æ–°ç‰¹æ€§</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/java/se/java8/" class="nav-link">java8æ–°ç‰¹æ€§</a></li></ul></li><li class="dropdown-item"><h4>Java-ee</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/javaweb/" class="nav-link">JavaWeb</a></li></ul></li><li class="dropdown-item"><h4>Javaè™šæ‹Ÿæœº</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/JVM/" class="nav-link">JVM</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ•°æ®åº“" class="dropdown-title"><a href="/my-notes/mysql/" class="link-title">æ•°æ®åº“</a> <span class="title" style="display:none;">æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>SQL æ•°æ®åº“</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/mysql/" class="nav-link">MySQL</a></li></ul></li><li class="dropdown-item"><h4>NoSQL æ•°æ®åº“</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/redis/" class="nav-link router-link-active">Redis</a></li><li class="dropdown-subitem"><a href="/my-notes/es/" class="nav-link">ElasticSearch</a></li><li class="dropdown-subitem"><a href="/my-notes/mongodb/" class="nav-link">MongoDB</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ¡†æ¶" class="dropdown-title"><a href="/my-notes/mybatis/study-note/" class="link-title">æ¡†æ¶</a> <span class="title" style="display:none;">æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>ORM</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/mybatis/study-note/" class="nav-link">MyBatis</a></li><li class="dropdown-subitem"><a href="/my-notes/mybatis-plus/study-note/" class="nav-link">MyBatis-Plus</a></li></ul></li><li class="dropdown-item"><h4>Spring</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/Spring/study-note/" class="nav-link">Spring</a></li></ul></li><li class="dropdown-item"><h4>SpringMVC</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/SpringMvc/study-note/1/" class="nav-link">SpringMVC1</a></li><li class="dropdown-subitem"><a href="/my-notes/SpringMvc/study-note/2/" class="nav-link">SpringMVC2</a></li></ul></li><li class="dropdown-item"><h4>SpringCloud</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/SpringCloud/" class="nav-link">SpringCloud</a></li></ul></li><li class="dropdown-item"><h4>ä¸­é—´ä»¶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-notes/rabbitmq/" class="nav-link">RabbitMQ</a></li><li class="dropdown-subitem"><a href="/my-notes/dubbo/" class="nav-link">Dubbo</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¡¹ç›®" class="dropdown-title"><a href="/my-notes/project/seckill/" class="link-title">é¡¹ç›®</a> <span class="title" style="display:none;">é¡¹ç›®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-notes/project/seckill/" class="nav-link">ç§’æ€é¡¹ç›®</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å·¥å…·|éƒ¨ç½²" class="dropdown-title"><a href="/my-notes/git/" class="link-title">å·¥å…·|éƒ¨ç½²</a> <span class="title" style="display:none;">å·¥å…·|éƒ¨ç½²</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-notes/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/my-notes/Linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/my-notes/Docker/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/my-notes/JWT/note/" class="nav-link">JWT</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¢è¯•|åˆ·é¢˜" class="dropdown-title"><a href="/my-notes/work/interview/" class="link-title">é¢è¯•|åˆ·é¢˜</a> <span class="title" style="display:none;">é¢è¯•|åˆ·é¢˜</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-notes/work/interview/" class="nav-link">é¢è¯•</a></li><li class="dropdown-item"><!----> <a href="/my-notes/work/algorithm/" class="nav-link">åˆ·é¢˜</a></li></ul></div></div><div class="nav-item"><a href="/my-notes/dev/question/" class="nav-link">å¼€å‘é—®é¢˜ğŸ˜ˆ</a></div><div class="nav-item"><a href="/my-notes/designPattern/" class="nav-link">è®¾è®¡æ¨¡å¼</a></div><div class="nav-item"><a href="/my-notes/about/" class="nav-link">å…³äºğŸ’•</a></div><div class="nav-item"><a href="/my-notes/archives/" class="nav-link">å½’æ¡£ğŸ•›</a></div> <a href="https://github.com/hnistzdk/my-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MySQL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Redis</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-notes/redis/" aria-current="page" class="sidebar-link">Redis - çŸ¥è¯†ä½“ç³»</a></li><li><a href="/my-notes/redis/7/" class="sidebar-link">Redis å…¨ç¬”è®°</a></li><li><a href="/my-notes/redis/1/" class="sidebar-link">Redis - æ¦‚å¿µå’ŒåŸºç¡€</a></li><li><a href="/my-notes/redis/2/" class="sidebar-link">Redis - äº”å¤§æ•°æ®ç±»å‹</a></li><li><a href="/my-notes/redis/3/" class="sidebar-link">Redis - ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹</a></li><li><a href="/my-notes/redis/4/" class="sidebar-link">Redis - äº‹åŠ¡</a></li><li><a href="/my-notes/redis/5/" class="sidebar-link">Redis - Java</a></li><li><a href="/my-notes/redis/6/" class="sidebar-link">Redis - é«˜çº§</a></li><li><a href="/my-notes/redis/persistence/" class="sidebar-link">RedisæŒä¹…åŒ–æœºåˆ¶</a></li><li><a href="/my-notes/redis/masterSlave/" aria-current="page" class="active sidebar-link">Redisé›†ç¾¤:ä¸»ä»æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/my-notes/redis/masterSlave/#ä¸»ä»æ¨¡å¼" class="sidebar-link">ä¸»ä»æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/my-notes/redis/masterSlave/#ä¸ºä»€ä¹ˆè¦é‡‡ç”¨è¯»å†™åˆ†ç¦»æ–¹å¼" class="sidebar-link">ä¸ºä»€ä¹ˆè¦é‡‡ç”¨è¯»å†™åˆ†ç¦»æ–¹å¼ï¼Ÿ</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/masterSlave/#ä¸»ä»åº“å¦‚ä½•è¿›è¡Œç¬¬ä¸€æ¬¡åŒæ­¥" class="sidebar-link">ä¸»ä»åº“å¦‚ä½•è¿›è¡Œç¬¬ä¸€æ¬¡åŒæ­¥</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/masterSlave/#ä»èŠ‚ç‚¹é…ç½®" class="sidebar-link">ä»èŠ‚ç‚¹é…ç½®</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/masterSlave/#ç¬¬ä¸€é˜¶æ®µ" class="sidebar-link">ç¬¬ä¸€é˜¶æ®µ</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/masterSlave/#ç¬¬äºŒé˜¶æ®µ" class="sidebar-link">ç¬¬äºŒé˜¶æ®µ</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/masterSlave/#ç¬¬ä¸‰é˜¶æ®µ" class="sidebar-link">ç¬¬ä¸‰é˜¶æ®µ</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/masterSlave/#psyn2-0" class="sidebar-link">PSYN2.0</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/masterSlave/#ã€Œä¸»ä»çº§è”æ¨¡å¼ã€åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›" class="sidebar-link">ã€Œä¸»ä»çº§è”æ¨¡å¼ã€åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/masterSlave/#ä¸»-ä»-ä»-æ¨¡å¼" class="sidebar-link">&quot;ä¸» - ä» - ä»&quot;æ¨¡å¼</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/masterSlave/#ä¸»ä»åº“é—´ç½‘ç»œæ–­äº†æ€ä¹ˆåŠ" class="sidebar-link">ä¸»ä»åº“é—´ç½‘ç»œæ–­äº†æ€ä¹ˆåŠ</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/masterSlave/#å¦‚ä½•é¿å…å¢é‡å¤åˆ¶å¤±æ•ˆ" class="sidebar-link">å¦‚ä½•é¿å…å¢é‡å¤åˆ¶å¤±æ•ˆ</a></li><li class="sidebar-sub-header level3"><a href="/my-notes/redis/masterSlave/#replication-buffer-ä¸replication-backlog-buffer" class="sidebar-link">replicationbuffer ä¸replicationbacklog_buffer</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/masterSlave/#replication-buffer" class="sidebar-link">replication_buffer</a></li><li class="sidebar-sub-header level4"><a href="/my-notes/redis/masterSlave/#replication-backlog-buffer" class="sidebar-link">replicationbacklogbuffer</a></li></ul></li></ul></li><li><a href="/my-notes/redis/sentinel/" class="sidebar-link">Redisé«˜å¯ç”¨-å“¨å…µæœºåˆ¶</a></li><li><a href="/my-notes/Redis/transaction/" class="sidebar-link">Redisäº‹åŠ¡æœºåˆ¶</a></li><li><a href="/my-notes/Redis/ttl-disuse-Strategy/" class="sidebar-link">Redisè¿‡æœŸæ¸…é™¤ç­–ç•¥å’Œå†…å­˜æ·˜æ±°æœºåˆ¶</a></li><li><a href="/my-notes/Redis/cacheConsistency/" class="sidebar-link">ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜</a></li><li><a href="/my-notes/Redis/distributedLock/" class="sidebar-link">rediså’Œzookeeperåˆ†å¸ƒå¼é”</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ElasticSearch</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MongoDB</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/my-notes/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/my-notes/categories/?category=%E6%95%B0%E6%8D%AE%E5%BA%93" title="åˆ†ç±»" data-v-06225672>æ•°æ®åº“</a></li><li data-v-06225672><a href="/my-notes/categories/?category=Redis" title="åˆ†ç±»" data-v-06225672>Redis</a></li></ul> <div class="info" data-v-06225672><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-06225672><a href="https://www.zaiolos.top/" target="_blank" title="ä½œè€…" class="beLink" data-v-06225672>zdk</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-08-02</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Redisé›†ç¾¤:ä¸»ä»æ¨¡å¼<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p><strong>Table of Contents</strong> <em>generated with <a href="https://github.com/thlorenz/doctoc" target="_blank" rel="noopener noreferrer">DocToc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></em></p> <ul><li><a href="#%E4%B8%BB%E4%BB%8E%E6%A8%A1%E5%BC%8F">ä¸»ä»æ¨¡å¼</a> <ul><li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E9%87%87%E7%94%A8%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E6%96%B9%E5%BC%8F">ä¸ºä»€ä¹ˆè¦é‡‡ç”¨è¯»å†™åˆ†ç¦»æ–¹å¼ï¼Ÿ</a></li> <li><a href="#%E4%B8%BB%E4%BB%8E%E5%BA%93%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%90%8C%E6%AD%A5">ä¸»ä»åº“å¦‚ä½•è¿›è¡Œç¬¬ä¸€æ¬¡åŒæ­¥</a> <ul><li><a href="#%E4%BB%8E%E8%8A%82%E7%82%B9%E9%85%8D%E7%BD%AE">ä»èŠ‚ç‚¹é…ç½®</a></li> <li><a href="#%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5">ç¬¬ä¸€é˜¶æ®µ</a></li> <li><a href="#%E7%AC%AC%E4%BA%8C%E9%98%B6%E6%AE%B5">ç¬¬äºŒé˜¶æ®µ</a></li> <li><a href="#%E7%AC%AC%E4%B8%89%E9%98%B6%E6%AE%B5">ç¬¬ä¸‰é˜¶æ®µ</a></li> <li><a href="#psyn20">PSYN2.0</a></li></ul></li> <li><a href="#%E4%B8%BB%E4%BB%8E%E7%BA%A7%E8%81%94%E6%A8%A1%E5%BC%8F%E5%88%86%E6%8B%85%E5%85%A8%E9%87%8F%E5%A4%8D%E5%88%B6%E6%97%B6%E7%9A%84%E4%B8%BB%E5%BA%93%E5%8E%8B%E5%8A%9B">ã€Œä¸»ä»çº§è”æ¨¡å¼ã€åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›</a> <ul><li><a href="#%E4%B8%BB---%E4%BB%8E---%E4%BB%8E%E6%A8%A1%E5%BC%8F"><strong>&quot;ä¸» - ä» - ä»&quot;æ¨¡å¼</strong></a></li></ul></li> <li><a href="#%E4%B8%BB%E4%BB%8E%E5%BA%93%E9%97%B4%E7%BD%91%E7%BB%9C%E6%96%AD%E4%BA%86%E6%80%8E%E4%B9%88%E5%8A%9E">ä¸»ä»åº“é—´ç½‘ç»œæ–­äº†æ€ä¹ˆåŠ</a> <ul><li><a href="#%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D%E5%A2%9E%E9%87%8F%E5%A4%8D%E5%88%B6%E5%A4%B1%E6%95%88">å¦‚ä½•é¿å…å¢é‡å¤åˆ¶å¤±æ•ˆ</a></li></ul></li> <li><a href="#replication_buffer-%E4%B8%8Ereplication_backlog_buffer">replication_buffer ä¸replication_backlog_buffer</a> <ul><li><a href="#replication_buffer">replication_buffer</a></li> <li><a href="#replication_backlog_buffer">replication_backlog_buffer</a></li></ul></li></ul></li></ul> <hr> <h2 id="ä¸»ä»æ¨¡å¼"><a href="#ä¸»ä»æ¨¡å¼" class="header-anchor">#</a> ä¸»ä»æ¨¡å¼</h2> <p>Redis æä¾›äº†ä¸»ä»åº“æ¨¡å¼ï¼Œä»¥ä¿è¯æ•°æ®å‰¯æœ¬çš„ä¸€è‡´ï¼Œä¸»ä»åº“ä¹‹é—´é‡‡ç”¨çš„æ˜¯ã€Œè¯»å†™åˆ†ç¦»ã€çš„æ–¹å¼ã€‚</p> <ul><li><strong>è¯»æ“ä½œ</strong>ï¼šä¸»åº“ã€ä»åº“éƒ½å¯ä»¥æ¥æ”¶ï¼›</li> <li><strong>å†™æ“ä½œ</strong>ï¼šé¦–å…ˆåˆ°ä¸»åº“æ‰§è¡Œï¼Œç„¶åï¼Œä¸»åº“å°†å†™æ“ä½œåŒæ­¥ç»™ä»åº“ã€‚</li></ul> <p><img src="https://images.zaiolos.top/images/202208021041581.png" alt="image.png"></p> <p><img src="https://images.zaiolos.top/images/202208021140736.png" alt="image-20220802114034611"></p> <h3 id="ä¸ºä»€ä¹ˆè¦é‡‡ç”¨è¯»å†™åˆ†ç¦»æ–¹å¼"><a href="#ä¸ºä»€ä¹ˆè¦é‡‡ç”¨è¯»å†™åˆ†ç¦»æ–¹å¼" class="header-anchor">#</a> ä¸ºä»€ä¹ˆè¦é‡‡ç”¨è¯»å†™åˆ†ç¦»æ–¹å¼ï¼Ÿ</h3> <div class="custom-block note"><p class="custom-block-title">ç¬”è®°</p> <p>å¦‚æœè¯´ä»åº“ä¹Ÿå¯ä»¥åƒä¸»åº“ä¸€æ ·ï¼Œå¯ä»¥æ¥æ”¶åˆ°å†™è¯·æ±‚çš„è¯ï¼Œä¸€ä¸ªç›´æ¥çš„é—®é¢˜å°±æ˜¯ã€Œæ•°æ®ä¸ä¸€è‡´ã€ã€‚</p> <p>ä¾‹å¦‚å®¢æˆ·ç«¯å¯¹åŒä¸€ä¸ª key è¿ç»­ä¿®æ”¹äº†ä¸‰æ¬¡ï¼Œè¿™ä¸‰æ¬¡è¯·æ±‚åˆ†åˆ«å‘é€åˆ°ä¸‰ä¸ªä¸åŒçš„å®ä¾‹ä¸Šã€‚ é‚£ä¹ˆï¼Œè¿™ä¸ªæ•°æ®åœ¨è¿™ä¸‰ä¸ªå®ä¾‹ä¸Šçš„å‰¯æœ¬å°±ä¸ä¸€è‡´äº†ï¼ˆåˆ†åˆ«æ˜¯ v1ã€v2 å’Œ v3ï¼‰ã€‚åç»­åœ¨è¯»å–è¿™ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œå°±å¯èƒ½è¯»å–åˆ°æ—§çš„å€¼ã€‚</p> <p>å¦‚æœè¦ä¿æŒè¿™ä¸ªæ•°æ®åœ¨ä¸‰ä¸ªå®ä¾‹ä¸Šä¸€è‡´ï¼Œå°±è¦æ¶‰åŠåˆ°åŠ é”ã€å®ä¾‹é—´åå•†æ˜¯å¦å®Œæˆä¿®æ”¹ç­‰ä¸€ç³»åˆ—æ“ä½œï¼Œ ä½†è¿™ä¼šå¸¦æ¥å·¨é¢çš„å¼€é”€ï¼Œæ˜¾ç„¶æ˜¯ä¸å¤ªèƒ½æ¥å—çš„ã€‚
é‡‡ç”¨ã€Œè¯»å†™åˆ†ç¦»ã€ï¼Œæ‰€æœ‰æ•°æ®çš„ä¿®æ”¹åªä¼šåœ¨ä¸»åº“ä¸Šè¿›è¡Œï¼Œä¸ç”¨åè°ƒä¸‰ä¸ªå®ä¾‹ã€‚ ä¸»åº“æœ‰äº†æœ€æ–°çš„æ•°æ®åï¼Œä¼šåŒæ­¥ç»™ä»åº“ï¼Œè¿™æ ·ï¼Œä¸»ä»åº“çš„æ•°æ®å°±æ˜¯ä¸€è‡´çš„ã€‚</p> <p>åˆ†æä¸»ä»åŒæ­¥ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å¼„æ¸…æ¥šä¸‰ä¸ªé—®é¢˜ï¼š</p> <p>ä¸»ä»åº“åŒæ­¥æ˜¯å¦‚ä½•å®Œæˆçš„å‘¢ï¼Ÿ</p> <p>ä¸»åº“æ•°æ®æ˜¯ä¸€æ¬¡æ€§ä¼ ç»™ä»åº“ï¼Œè¿˜æ˜¯åˆ†æ‰¹åŒæ­¥ï¼Ÿ</p> <p>ä¸»ä»åº“é—´çš„ç½‘ç»œæ–­è¿äº†ï¼Œæ•°æ®è¿˜èƒ½ä¿æŒä¸€è‡´å—ï¼Ÿ</p> <p>æ¥ä¸‹æ¥ï¼Œé¦–å…ˆåˆ†æä¸»ä»åº“é—´çš„ç¬¬ä¸€æ¬¡åŒæ­¥æ˜¯å¦‚ä½•è¿›è¡Œçš„ï¼Ÿè¿™ä¹Ÿæ˜¯Redis å®ä¾‹å»ºç«‹ä¸»ä»åº“æ¨¡å¼åçš„è§„å®šåŠ¨ä½œã€‚</p></div> <h3 id="ä¸»ä»åº“å¦‚ä½•è¿›è¡Œç¬¬ä¸€æ¬¡åŒæ­¥"><a href="#ä¸»ä»åº“å¦‚ä½•è¿›è¡Œç¬¬ä¸€æ¬¡åŒæ­¥" class="header-anchor">#</a> ä¸»ä»åº“å¦‚ä½•è¿›è¡Œç¬¬ä¸€æ¬¡åŒæ­¥</h3> <h4 id="ä»èŠ‚ç‚¹é…ç½®"><a href="#ä»èŠ‚ç‚¹é…ç½®" class="header-anchor">#</a> ä»èŠ‚ç‚¹é…ç½®</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>################################# REPLICATION #################################

# Master-Replica replication. Use replicaof to make a Redis instance a copy of
# another Redis server. A few things to understand ASAP about Redis replication.
#
#   +------------------+      +---------------+
#   |      Master      | ---&gt; |    Replica    |
#   | (receive writes) |      |  (exact copy) |
#   +------------------+      +---------------+
#
# 1) Redis replication is asynchronous, but you can configure a master to
#    stop accepting writes if it appears to be not connected with at least
#    a given number of replicas.
# 2) Redis replicas are able to perform a partial resynchronization with the
#    master if the replication link is lost for a relatively small amount of
#    time. You may want to configure the replication backlog size (see the next
#    sections of this file) with a sensible value depending on your needs.
# 3) Replication is automatic and does not need user intervention. After a
#    network partition replicas automatically try to reconnect to masters
#    and resynchronize with them.
#
# replicaof &lt;masterip&gt; &lt;masterport&gt;

# If the master is password protected (using the &quot;requirepass&quot; configuration
# directive below) it is possible to tell the replica to authenticate before
# starting the replication synchronization process, otherwise the master will
# refuse the replica request.
#
# masterauth &lt;master-password&gt;
#
# However this is not enough if you are using Redis ACLs (for Redis version
# 6 or greater), and the default user is not capable of running the PSYNC
# command and/or other commands needed for replication. In this case it's
# better to configure a special user to use with replication, and specify the
# masteruser configuration as such:
#
# masteruser &lt;username&gt;
#
# When masteruser is specified, the replica will authenticate against its
# master using the new AUTH form: AUTH &lt;username&gt; &lt;password&gt;.

# When a replica loses its connection with the master, or when the replication
# is still in progress, the replica can act in two different ways:
#
# 1) if replica-serve-stale-data is set to 'yes' (the default) the replica will
#    still reply to client requests, possibly with out of date data, or the
#    data set may just be empty if this is the first synchronization.
#
# 2) If replica-serve-stale-data is set to 'no' the replica will reply with
#    an error &quot;SYNC with master in progress&quot; to all commands except:
#    INFO, REPLICAOF, AUTH, PING, SHUTDOWN, REPLCONF, ROLE, CONFIG, SUBSCRIBE,
#    UNSUBSCRIBE, PSUBSCRIBE, PUNSUBSCRIBE, PUBLISH, PUBSUB, COMMAND, POST,
#    HOST and LATENCY.
#
replica-serve-stale-data yes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><p>ä½¿ç”¨é»˜è®¤çš„é…ç½®å¯åŠ¨æœºå™¨ï¼Œæœºå™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ã€‚å¦‚æœæƒ³è¦è®©æœºå™¨å˜æˆä»èŠ‚ç‚¹ï¼Œéœ€è¦åœ¨ conf æ–‡ä»¶ä¸Šé…ç½®ä¸»ä»å¤åˆ¶çš„ç›¸å…³å‚æ•°ã€‚</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># é…ç½®ä¸»èŠ‚ç‚¹çš„ipå’Œç«¯å£
slaveof 192.168.1.1 6379
# ä»redis2.6å¼€å§‹ï¼Œä»èŠ‚ç‚¹é»˜è®¤æ˜¯åªè¯»çš„
slave-read-only yes
# å‡è®¾ä¸»èŠ‚ç‚¹æœ‰ç™»å½•å¯†ç ï¼Œæ˜¯123456
masterauth 123456
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>ä¸»ä»åº“é—´æ•°æ®ç¬¬ä¸€æ¬¡åŒæ­¥åŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼š
<img src="https://images.zaiolos.top/images/202208021042939.png" alt="image.png"></p> <h4 id="ç¬¬ä¸€é˜¶æ®µ"><a href="#ç¬¬ä¸€é˜¶æ®µ" class="header-anchor">#</a> ç¬¬ä¸€é˜¶æ®µ</h4> <p>ç¬¬ä¸€é˜¶æ®µæ˜¯ä¸»ä»åº“é—´å»ºç«‹è¿æ¥ã€åå•†åŒæ­¥çš„è¿‡ç¨‹ï¼Œä¸»è¦æ˜¯ä¸ºå…¨é‡å¤åˆ¶åšå‡†å¤‡ã€‚
å‘½ä»¤æ ¼å¼ï¼š
<code>PSYNC &lt;runid&gt; &lt;offset&gt;</code>
å…·ä½“æ¥è¯´ï¼Œä»åº“ç»™ä¸»åº“å‘é€ <code>psync</code> å‘½ä»¤ï¼Œè¡¨ç¤ºè¦è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œä¸»åº“æ ¹æ®è¿™ä¸ªå‘½ä»¤çš„å‚æ•°æ¥å¯åŠ¨å¤åˆ¶ã€‚ <code>psync</code> å‘½ä»¤åŒ…å«äº†ä¸»åº“çš„ <code>runID</code> å’Œå¤åˆ¶è¿›åº¦ <code>offset</code>ä¸¤ä¸ªå‚æ•°ã€‚</p> <blockquote><p><code>psync</code> æ˜¯ Redis 2.8 ç‰ˆæœ¬æä¾›çš„å‘½ä»¤ï¼Œç”¨äºè§£å†³ sync ã€Œ<strong>æ–­çº¿åé‡å¤åˆ¶</strong>ã€çš„ä½æ•ˆé—®é¢˜ã€‚</p></blockquote> <ul><li>runIDï¼šæ˜¯æ¯ä¸ª Redis å®ä¾‹å¯åŠ¨æ—¶éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªéšæœº IDï¼Œç”¨æ¥å”¯ä¸€æ ‡è®°è¿™ä¸ªå®ä¾‹ã€‚ å½“ä»åº“å’Œä¸»åº“ç¬¬ä¸€æ¬¡å¤åˆ¶æ—¶ï¼Œå› ä¸ºä¸çŸ¥é“ä¸»åº“çš„ runIDï¼Œæ‰€ä»¥å°† runID è®¾ä¸ºâ€œï¼Ÿâ€ã€‚</li> <li>offsetï¼šå¤åˆ¶åç§»é‡ï¼Œæ­¤æ—¶è®¾ä¸º -1ï¼Œè¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶ã€‚</li></ul> <blockquote><p><code>PSYNC ? -1</code> è¡¨ç¤ºå…¨é‡å¤åˆ¶ã€‚</p></blockquote> <p>ä¸»åº“æ”¶åˆ° <code>psync</code> å‘½ä»¤åï¼Œä¼šç”¨ <code>FULLRESYNC</code> å“åº”å‘½ä»¤å¸¦ä¸Šä¸¤ä¸ªå‚æ•°ï¼šã€Œä¸»åº“ runIDã€ å’Œä¸»åº“ç›®å‰çš„ã€Œå¤åˆ¶è¿›åº¦ offsetã€ï¼Œè¿”å›ç»™ä»åº“ã€‚ ä»åº“æ”¶åˆ°å“åº”åï¼Œä¼šè®°å½•ä¸‹è¿™ä¸¤ä¸ªå‚æ•°ï¼Œåœ¨ä¸‹ä¸€æ¬¡å‘é€<code>psync</code> å‘½ä»¤æ—¶ä½¿ç”¨ã€‚</p> <blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>FULLRESYNC</code> å“åº”è¡¨ç¤ºã€Œ<strong>ç¬¬ä¸€æ¬¡å¤åˆ¶é‡‡ç”¨çš„å…¨é‡å¤åˆ¶</strong>ã€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸»åº“ä¼šæŠŠå½“å‰æ‰€æœ‰çš„æ•°æ®éƒ½å¤åˆ¶ç»™ä»åº“ã€‚
å¦‚æœä¸»æœåŠ¡å™¨è¿”å›çš„æ˜¯ <code>+CONTINUE</code> åˆ™è¡¨ç¤ºéœ€è¦è¿›è¡Œã€Œéƒ¨åˆ†åŒæ­¥ã€ã€‚</p></blockquote> <h4 id="ç¬¬äºŒé˜¶æ®µ"><a href="#ç¬¬äºŒé˜¶æ®µ" class="header-anchor">#</a> ç¬¬äºŒé˜¶æ®µ</h4> <p>åœ¨ç¬¬äºŒé˜¶æ®µï¼Œä¸»åº“å°†æ‰€æœ‰æ•°æ®åŒæ­¥ç»™ä»åº“ã€‚ä»åº“æ”¶åˆ°æ•°æ®åï¼Œåœ¨æœ¬åœ°å®Œæˆæ•°æ®åŠ è½½ã€‚
å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p> <ol><li>ä¸»åº“æ”¶åˆ°å®Œæ•´é‡åŒæ­¥è¯·æ±‚åï¼Œä¼šåœ¨åå°æ‰§è¡Œ bgsave å‘½ä»¤ï¼Œç”Ÿæˆ RDB æ–‡ä»¶ï¼Œ<strong>å¹¶ä½¿ç”¨ä¸€ä¸ªã€Œç¼“å†²åŒºï¼šreplication bufferã€è®°å½•ã€Œä»ç°åœ¨å¼€å§‹æ‰€æœ‰çš„å†™å‘½ä»¤ã€</strong>ã€‚</li> <li>å½“<code>bgsave</code> å‘½ä»¤æ‰§è¡Œå®Œæ¯•ï¼Œä¸»æœåŠ¡ä¼šå°† RDB æ–‡ä»¶å‘ç»™ä»åº“ã€‚ä»åº“æ¥æ”¶åˆ° RDB æ–‡ä»¶åï¼Œä¼šå…ˆæ¸…ç©ºå½“å‰æ•°æ®åº“ï¼Œç„¶ååŠ è½½ RDB æ–‡ä»¶ã€‚</li></ol> <blockquote><p>ä¸ºä»€ä¹ˆè¦æœ‰æ¸…ç©ºçš„åŠ¨ä½œï¼Ÿ
è¿™æ˜¯å› ä¸ºä»åº“åœ¨é€šè¿‡ slaveof å‘½ä»¤å¼€å§‹å’Œä¸»åº“åŒæ­¥å‰ï¼Œå¯èƒ½ä¿å­˜äº†å…¶ä»–æ•°æ®ã€‚ä¸ºäº†é¿å…ä¹‹å‰æ•°æ®çš„å½±å“ï¼Œä»åº“éœ€è¦å…ˆæŠŠå½“å‰æ•°æ®åº“æ¸…ç©ºã€‚</p></blockquote> <p><strong>åœ¨ä¸»åº“å°†æ•°æ®åŒæ­¥ç»™ä»åº“çš„è¿‡ç¨‹ä¸­ï¼Œä¸»åº“ä¸ä¼šè¢«é˜»å¡ï¼Œä»ç„¶å¯ä»¥æ­£å¸¸æ¥æ”¶è¯·æ±‚ã€‚</strong> å¦åˆ™ï¼ŒRedis çš„æœåŠ¡å°±è¢«ä¸­æ–­äº†ã€‚ä½†æ˜¯ï¼Œè¿™äº›è¯·æ±‚ä¸­çš„å†™æ“ä½œå¹¶æ²¡æœ‰è®°å½•åˆ°åˆšåˆšç”Ÿæˆçš„ RDB æ–‡ä»¶ä¸­ã€‚ä¸ºäº†ä¿è¯ä¸»ä»åº“çš„æ•°æ®ä¸€è‡´æ€§ï¼Œä¸»åº“ä¼šåœ¨å†…å­˜ä¸­ç”¨ä¸“é—¨çš„ <code>replication buffer</code> ï¼ˆ <strong>å¤åˆ¶ç¼“å†²åŒº</strong>ï¼‰ï¼Œè®°å½• RDB æ–‡ä»¶ç”Ÿæˆåæ”¶åˆ°çš„æ‰€æœ‰å†™æ“ä½œã€‚</p> <h4 id="ç¬¬ä¸‰é˜¶æ®µ"><a href="#ç¬¬ä¸‰é˜¶æ®µ" class="header-anchor">#</a> ç¬¬ä¸‰é˜¶æ®µ</h4> <p>æœ€åï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸‰ä¸ªé˜¶æ®µï¼Œä¸»åº“ä¼šæŠŠç¬¬äºŒé˜¶æ®µæ‰§è¡Œè¿‡ç¨‹ä¸­æ–°æ”¶åˆ°çš„å†™å‘½ä»¤ï¼Œå†å‘é€ç»™ä»åº“ã€‚
å…·ä½“çš„æ“ä½œæ˜¯ï¼Œå½“ä¸»åº“å®Œæˆ RDB æ–‡ä»¶å‘é€åï¼Œå°±ä¼šæŠŠæ­¤æ—¶ <code>replication buffer</code> ä¸­çš„ä¿®æ”¹æ“ä½œå‘ç»™ä»åº“ï¼Œä»åº“å†é‡æ–°æ‰§è¡Œè¿™äº›æ“ä½œã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸»ä»åº“å°±å®ç°åŒæ­¥äº†ã€‚</p> <h4 id="psyn2-0"><a href="#psyn2-0" class="header-anchor">#</a> PSYN2.0</h4> <p><code>PSYN2.0</code> æ˜¯ Redis 4.0 çš„ å…¶ä¸­ä¸€ä¸ªæ–°ç‰¹æ€§ã€‚ç›¸æ¯”åŸæ¥çš„ PSYN åŠŸèƒ½ï¼Œæœ€å¤§çš„å˜åŒ–å°±æ˜¯æ”¯æŒä¸¤ç§åœºæ™¯ä¸‹çš„éƒ¨åˆ†é‡åŒæ­¥ã€‚</p> <ul><li>slave èŠ‚ç‚¹æå‡ä¸º master èŠ‚ç‚¹åï¼Œå…¶ä»– slave èŠ‚ç‚¹å¯ä»¥ä»æ–°æå‡çš„ master è¿›è¡Œéƒ¨åˆ†é‡åŒæ­¥ï¼›</li> <li>å¦å¤–ä¸€ä¸ªåœºæ™¯å°±æ˜¯slaveé‡å¯åï¼Œå¯ä»¥è¿›è¡Œéƒ¨åˆ†é‡åŒæ­¥ã€‚</li></ul> <h3 id="ã€Œä¸»ä»çº§è”æ¨¡å¼ã€åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›"><a href="#ã€Œä¸»ä»çº§è”æ¨¡å¼ã€åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›" class="header-anchor">#</a> ã€Œä¸»ä»çº§è”æ¨¡å¼ã€åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›</h3> <p>é€šè¿‡ä¸Šé¢åˆ†æã€Œä¸»ä»åº“é—´ç¬¬ä¸€æ¬¡æ•°æ®åŒæ­¥ã€çš„è¿‡ç¨‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä¸€æ¬¡å…¨é‡å¤åˆ¶ï¼Œå¯¹äºä¸»åº“æ¥è¯´æœ‰ä¸¤ä¸ªè€—æ—¶çš„æ“ä½œï¼š</p> <ul><li>ç”Ÿæˆ RDBæ–‡ä»¶ï¼›</li> <li>ä¼ è¾“ RDB æ–‡ä»¶ã€‚</li></ul> <p>å¦‚æœè¯´ä»åº“æ•°é‡å¾ˆå¤šï¼Œè€Œä¸”éƒ½è¦å’Œä¸»åº“è¿›è¡Œå…¨é‡å¤åˆ¶çš„è¯ï¼Œå°±ä¼šå¯¼è‡´ä¸¤ä¸ªé—®é¢˜ï¼š</p> <ul><li>ä¸»åº“å¿™äº fork å­è¿›ç¨‹ç”Ÿæˆ RDB æ–‡ä»¶ï¼Œè¿›è¡Œæ•°æ®å…¨é‡åŒæ­¥ï¼Œ<strong>fork è¿™ä¸ªæ“ä½œä¼šé˜»å¡ä¸»çº¿ç¨‹å¤„ç†æ­£å¸¸è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ä¸»åº“å“åº”åº”ç”¨ç¨‹åºçš„è¯·æ±‚é€Ÿåº¦å˜æ…¢ã€‚</strong></li> <li>ç”Ÿæˆ RDB æ–‡ä»¶ éœ€è¦è€—è´¹ä¸»æœåŠ¡å™¨å¤§é‡çš„CPUï¼Œå†…å­˜å’Œç£ç›˜I/Oèµ„æºã€‚ä¼ è¾“ RDB æ–‡ä»¶ä¹Ÿä¼šå ç”¨ä¸»åº“çš„ç½‘ç»œå¸¦å®½ï¼Œå¹¶å¯¹ä¸»æœåŠ¡å™¨å“åº”å‘½ä»¤è¯·æ±‚çš„æ—¶é—´äº§ç”Ÿå½±å“ã€‚</li></ul> <p>é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰å¥½çš„è§£å†³æ–¹æ³•å¯ä»¥åˆ†æ‹…ä¸»åº“å‹åŠ›å‘¢ï¼Ÿ</p> <p>å…¶å®æ˜¯æœ‰çš„ï¼Œè¿™å°±æ˜¯ <strong>ã€Œ&quot;ä¸» - ä» - ä»&quot;æ¨¡å¼ã€</strong>ã€‚</p> <h4 id="ä¸»-ä»-ä»-æ¨¡å¼"><a href="#ä¸»-ä»-ä»-æ¨¡å¼" class="header-anchor">#</a> <strong>&quot;ä¸» - ä» - ä»&quot;æ¨¡å¼</strong></h4> <p>ä¸Šé¢ä»‹ç»çš„ä¸»ä»åº“æ¨¡å¼ï¼Œæ˜¯æ‰€æœ‰çš„ä»åº“éƒ½æ˜¯å’Œä¸»åº“è¿æ¥ï¼Œæ‰€æœ‰çš„å…¨é‡å¤åˆ¶ä¹Ÿéƒ½æ˜¯å’Œä¸»åº“è¿›è¡Œçš„ã€‚
ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ã€Œâ€œä¸» - ä» - ä»â€æ¨¡å¼ã€å°†ä¸»åº“ç”Ÿæˆ RDB å’Œä¼ è¾“ RDB çš„å‹åŠ›ï¼Œä»¥çº§è”çš„æ–¹å¼åˆ†æ•£åˆ°ä»åº“ä¸Šã€‚</p> <p>ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨éƒ¨ç½²ä¸»ä»é›†ç¾¤çš„æ—¶å€™ï¼Œå¯ä»¥æ‰‹åŠ¨é€‰æ‹©ä¸€ä¸ªä»åº“ï¼ˆæ¯”å¦‚é€‰æ‹©å†…å­˜èµ„æºé…ç½®è¾ƒé«˜çš„ä»åº“ï¼‰ï¼Œç”¨äºçº§è”å…¶ä»–çš„ä»åº“ã€‚ ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å†é€‰æ‹©ä¸€äº›ä»åº“ï¼ˆä¾‹å¦‚ä¸‰åˆ†ä¹‹ä¸€çš„ä»åº“ï¼‰ï¼Œåœ¨è¿™äº›ä»åº“ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œè®©å®ƒä»¬å’Œåˆšæ‰æ‰€é€‰çš„ä»åº“ï¼Œå»ºç«‹èµ·ä¸»ä»å…³ç³»ã€‚</p> <p><code>salveof æ‰€é€‰ä»åº“çš„IP 6379</code>å‘½ä»¤</p> <p>è¿™æ ·ä¸€æ¥ï¼Œè¿™äº›ä»åº“å°±ä¼šçŸ¥é“ï¼Œåœ¨è¿›è¡ŒåŒæ­¥æ—¶ï¼Œä¸ç”¨å†å’Œä¸»åº“è¿›è¡Œäº¤äº’äº†ï¼Œåªè¦å’Œçº§è”çš„ä»åº“è¿›è¡Œå†™æ“ä½œåŒæ­¥å°±è¡Œäº†ï¼Œè¿™å°±å¯ä»¥å‡è½»ä¸»åº“ä¸Šçš„å‹åŠ›ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> <p><img src="https://images.zaiolos.top/images/202208021042531.png" alt="image.png"></p> <p>é‚£ä¹ˆï¼Œä¸€æ—¦ä¸»ä»åº“å®Œæˆäº†å…¨é‡å¤åˆ¶ï¼Œå®ƒä»¬ä¹‹é—´å°±ä¼šä¸€ç›´ç»´æŠ¤ä¸€ä¸ªç½‘ç»œè¿æ¥ï¼Œä¸»åº“ä¼šé€šè¿‡è¿™ä¸ªè¿æ¥å°†åç»­é™†ç»­æ”¶åˆ°çš„å‘½ä»¤æ“ä½œå†åŒæ­¥ç»™ä»åº“ï¼Œ è¿™ä¸ªè¿‡ç¨‹ä¹Ÿç§°ä¸ºåŸºäºé•¿è¿æ¥çš„å‘½ä»¤ä¼ æ’­ï¼Œå¯ä»¥é¿å…é¢‘ç¹å»ºç«‹è¿æ¥çš„å¼€é”€ã€‚</p> <p>å¬ä¸Šå»å¥½åƒå¾ˆç®€å•ï¼Œä½†ä¸å¯å¿½è§†çš„æ˜¯ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å­˜åœ¨ç€é£é™©ç‚¹ï¼Œæœ€å¸¸è§çš„å°±æ˜¯ç½‘ç»œæ–­è¿æˆ–é˜»å¡ã€‚å¦‚æœç½‘ç»œæ–­è¿ï¼Œä¸»ä»åº“ä¹‹é—´å°±æ— æ³•è¿›è¡Œå‘½ä»¤ä¼ æ’­äº†ï¼Œ ä»åº“çš„æ•°æ®è‡ªç„¶ä¹Ÿå°±æ²¡åŠæ³•å’Œä¸»åº“ä¿æŒä¸€è‡´äº†ï¼Œå®¢æˆ·ç«¯å°±å¯èƒ½ä»ä»åº“è¯»åˆ°æ—§æ•°æ®ã€‚</p> <p>æ¥ä¸‹æ¥ï¼Œçœ‹çœ‹ç½‘ç»œæ–­è¿åçš„è§£å†³åŠæ³•ã€‚</p> <h3 id="ä¸»ä»åº“é—´ç½‘ç»œæ–­äº†æ€ä¹ˆåŠ"><a href="#ä¸»ä»åº“é—´ç½‘ç»œæ–­äº†æ€ä¹ˆåŠ" class="header-anchor">#</a> ä¸»ä»åº“é—´ç½‘ç»œæ–­äº†æ€ä¹ˆåŠ</h3> <p>åœ¨ Redis 2.8 ä¹‹å‰ï¼Œä¸»ä»åº“æ˜¯ä½¿ç”¨ sync å‘½ä»¤è¿›è¡ŒåŒæ­¥ã€‚å¦‚æœåœ¨å‘½ä»¤ä¼ æ’­æ—¶å‡ºç°äº†ç½‘ç»œé—ªæ–­ï¼Œé‚£ä¹ˆï¼Œä»åº“å°±ä¼šå’Œä¸»åº“é‡æ–°è¿›è¡Œä¸€æ¬¡å…¨é‡å¤åˆ¶ï¼Œå¼€é”€éå¸¸å¤§ã€‚
æˆ‘ä»¬ä¸Šé¢é¡µæåˆ°äº†å…¨é‡å¤åˆ¶çš„å½±å“ï¼š</p> <ul><li>ç”Ÿæˆ RDBæ–‡ä»¶ï¼šéœ€è¦è€—è´¹ä¸»æœåŠ¡å™¨å¤§é‡çš„CPUï¼Œå†…å­˜å’Œç£ç›˜I/Oèµ„æºï¼›</li> <li>ä¼ è¾“ RDB æ–‡ä»¶ï¼šå ç”¨ä¸»åº“çš„ç½‘ç»œå¸¦å®½ï¼Œå¹¶å¯¹ä¸»æœåŠ¡å™¨å“åº”å‘½ä»¤è¯·æ±‚çš„æ—¶é—´äº§ç”Ÿå½±å“ã€‚</li></ul> <p>ä» Redis 2.8 å¼€å§‹ï¼Œç½‘ç»œæ–­äº†ä¹‹åï¼Œä¸»ä»åº“ä¼šé‡‡ç”¨ã€Œå¢é‡å¤åˆ¶ã€çš„æ–¹å¼ç»§ç»­åŒæ­¥ã€‚ å¬åå­—å¤§æ¦‚å°±å¯ä»¥çŒœåˆ°å®ƒå’Œå…¨é‡å¤åˆ¶çš„ä¸åŒï¼šå…¨é‡å¤åˆ¶æ˜¯åŒæ­¥æ‰€æœ‰æ•°æ®ï¼Œè€Œ<strong>å¢é‡å¤åˆ¶åªä¼šæŠŠä¸»ä»åº“ç½‘ç»œæ–­è¿æœŸé—´ä¸»åº“æ”¶åˆ°çš„å‘½ä»¤ï¼ŒåŒæ­¥ç»™ä»åº“</strong>ã€‚</p> <p>é‚£ä¹ˆï¼Œå¢é‡å¤åˆ¶æ—¶ï¼Œä¸»ä»åº“ä¹‹é—´å…·ä½“æ˜¯æ€ä¹ˆä¿æŒåŒæ­¥çš„å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆå’Œ <code>repl_backlog_buffer</code> ï¼ˆå¤åˆ¶ç§¯å‹ç¼“å†²åŒºï¼‰æœ‰å…³ã€‚</p> <blockquote><p>å¤åˆ¶ç§¯å‹ç¼“å†²åŒºï¼šæ˜¯ä¸»åº“ç»´æŠ¤çš„ä¸€ä¸ªå›ºå®šé•¿åº¦çš„é˜Ÿåˆ—ï¼Œé»˜è®¤å¤§å°æ˜¯1MBã€‚</p></blockquote> <p>æˆ‘ä»¬å…ˆæ¥åˆ†æä¸‹ä¸»ä»åº“å¢é‡åŒæ­¥çš„æµç¨‹ã€‚</p> <p>1ï¼‰ã€å½“ä¸»ä»åº“è¿›è¡Œæ•°æ®åŒæ­¥æ—¶ï¼Œä¸»åº“ä¼šæŠŠ RDB é€šä¿¡æœŸé—´æ”¶åˆ°æ–°çš„æ“ä½œå‘½ä»¤å†™å…¥ <code>replication buffer</code>ï¼ŒåŒæ—¶ä¹Ÿä¼šæŠŠè¿™äº›æ“ä½œå‘½ä»¤ä¹Ÿå†™å…¥ <code>repl_backlog_buffer</code> è¿™ä¸ªç¼“å†²åŒºã€‚</p> <p><code>repl_backlog_buffer</code> æ˜¯ä¸€ä¸ªç¯å½¢ç¼“å†²åŒºï¼Œä¸»åº“ä¼šè®°å½•è‡ªå·±å†™åˆ°çš„ä½ç½®ï¼Œä»åº“åˆ™ä¼šè®°å½•è‡ªå·±å·²ç»è¯»åˆ°çš„ä½ç½®ã€‚</p> <p>2ï¼‰ã€åˆšå¼€å§‹çš„æ—¶å€™ï¼Œä¸»åº“å’Œä»åº“çš„å†™è¯»ä½ç½®åœ¨ä¸€èµ·ï¼Œä¹Ÿå°±æ˜¯ã€Œå¤åˆ¶åç§»é‡ã€ç›¸åŒï¼Œè¿™ç®—æ˜¯å®ƒä»¬çš„èµ·å§‹ä½ç½®ã€‚ éšç€ä¸»åº“ä¸æ–­æ¥æ”¶æ–°çš„å†™æ“ä½œï¼Œå®ƒåœ¨ç¼“å†²åŒºä¸­çš„å†™ä½ç½®ä¼šé€æ­¥åç¦»èµ·å§‹ä½ç½®ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨åç§»é‡æ¥è¡¡é‡è¿™ä¸ªåç§»è·ç¦»çš„å¤§å°ï¼Œå¯¹ä¸»åº“æ¥è¯´ï¼Œå¯¹åº”çš„åç§»é‡å°±æ˜¯ <code>master_repl_offset</code>ã€‚ ä¸»åº“æ¥æ”¶çš„æ–°å†™æ“ä½œè¶Šå¤šï¼Œè¿™ä¸ªå€¼å°±ä¼šè¶Šå¤§ã€‚</p> <p>åŒæ ·ï¼Œä»åº“åœ¨å¤åˆ¶å®Œå†™æ“ä½œå‘½ä»¤åï¼Œå®ƒåœ¨ç¼“å†²åŒºä¸­çš„è¯»ä½ç½®ä¹Ÿå¼€å§‹é€æ­¥åç§»åˆšæ‰çš„èµ·å§‹ä½ç½®ï¼Œ æ­¤æ—¶ï¼Œä»åº“å·²å¤åˆ¶çš„åç§»é‡ slave_repl_offset ä¹Ÿåœ¨ä¸æ–­å¢åŠ ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¿™ä¸¤ä¸ªåç§»é‡åŸºæœ¬ç›¸ç­‰ã€‚</p> <p>3ï¼‰ã€å¦‚æœå‘ç”Ÿä»åº“æ–­çº¿ï¼Œåœ¨é‡å¯ä¹‹åï¼Œä¸»ä»åº“çš„è¿æ¥æ¢å¤ï¼Œä»åº“é¦–å…ˆä¼šç»™ä¸»åº“å‘é€ <code>psync</code> å‘½ä»¤ï¼Œå¹¶æŠŠè‡ªå·±å½“å‰çš„<code>slave_repl_offset</code> å‘ç»™ä¸»åº“ï¼Œ ä¸»åº“ä¼šåˆ¤æ–­è‡ªå·±çš„<code>master_repl_offset</code> å’Œ <code>slave_repl_offset</code> ä¹‹é—´çš„å·®è·ã€‚å¦‚æœå‘ç°åœ¨<code>slave_repl_offset</code> ä¹‹åçš„æ•°æ®ä»ç„¶å­˜åœ¨äºå¤åˆ¶ç§¯å‹ç¼“å†²åŒºé‡Œé¢ï¼Œä¸»åº“å‘é€ <code>+CONTINUE</code> å›å¤ï¼Œè¡¨ç¤ºè¿›è¡Œå¢é‡å¤åˆ¶ã€‚</p> <p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> <p><img src="https://images.zaiolos.top/images/202208021043937.png" alt="image.png"></p> <p>è¿™é‡Œæœ‰ä¸€ä¸ªåœ°æ–¹éœ€è¦é‡ç‚¹è€ƒè™‘ã€‚</p> <p>å› ä¸º <code>repl_backlog_buffer</code> æ˜¯ä¸€ä¸ªç¯å½¢ç¼“å†²åŒºï¼Œæ‰€ä»¥åœ¨ç¼“å†²åŒºå†™æ»¡åï¼Œä¸»åº“ä¼šç»§ç»­å†™å…¥ï¼Œæ­¤æ—¶ï¼Œå°±ä¼šè¦†ç›–æ‰ä¹‹å‰å†™å…¥çš„æ“ä½œã€‚ å¦‚æœä»åº“çš„è¯»å–é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œå°±æœ‰</p> <p>å¯èƒ½å¯¼è‡´ä»åº“è¿˜æœªè¯»å–çš„æ“ä½œè¢«ä¸»åº“æ–°å†™çš„æ“ä½œè¦†ç›–äº†ï¼Œè¿™ä¼šå¯¼è‡´ä¸èƒ½è¿›è¡Œå¢é‡å¤åˆ¶ï¼Œå¿…é¡»é‡‡ç”¨å…¨é‡å¤åˆ¶ã€‚</p> <p>å› æ­¤è¦æƒ³åŠæ³•é¿å…è¿™ä¸€æƒ…å†µï¼Œä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒæ•´é…ç½®æ–‡ä»¶ä¸­ repl-backlog-size è¿™ä¸ªå‚æ•°ã€‚</p> <h4 id="å¦‚ä½•é¿å…å¢é‡å¤åˆ¶å¤±æ•ˆ"><a href="#å¦‚ä½•é¿å…å¢é‡å¤åˆ¶å¤±æ•ˆ" class="header-anchor">#</a> å¦‚ä½•é¿å…å¢é‡å¤åˆ¶å¤±æ•ˆ</h4> <p>Redis ä¸ºå¤åˆ¶ç§¯å‹ç¼“å†²åŒºè®¾ç½®çš„é»˜è®¤å¤§å°æ˜¯ 1MBã€‚å¦‚æœä¸»åº“éœ€è¦æ‰§è¡Œå¤§é‡çš„å†™å‘½ä»¤ï¼Œåˆæˆ–è€…æ–­çº¿åéœ€è¦é‡è¿çš„æ—¶é—´æ¯”è¾ƒé•¿ï¼Œè¿™ä¸ªå¤§å°æ˜¾ç„¶ä¸åˆé€‚ã€‚</p> <p>æˆ‘ä»¬å¯ä»¥æ ¹æ®ï¼š second * <code>write_size_per_second</code> å…¬å¼æ¥ä¼°ç®—ç¼“å†²åŒºçš„ã€Œæœ€å°ã€å¤§å°ã€‚</p> <ul><li>second ï¼šä»åº“æ–­çº¿åé‡æ–°è¿ä¸Šä¸»åº“æ‰€éœ€çš„å¹³å‡æ—¶é—´ï¼Œå•ä½ï¼šç§’ï¼›</li> <li><code>write_size_per_second</code>ï¼šä¸»åº“å¹³å‡æ¯ç§’äº§ç”Ÿçš„å†™å‘½ä»¤æ•°æ®é‡ã€‚</li></ul> <p>æˆ‘ä»¬åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè€ƒè™‘åˆ°å¯èƒ½å­˜åœ¨ä¸€äº›çªå‘çš„è¯·æ±‚å‹åŠ›ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦æŠŠè¿™ä¸ªç¼“å†²ç©ºé—´æ‰©å¤§ä¸€å€ï¼Œå³ <code>repl-backlog-size</code> = second * <code>write_size_per_second</code> * 2ã€‚</p> <p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä¸»åº“æ¯ç§’äº§ç”Ÿ1 MBçš„å†™æ•°æ®ï¼Œä»åº“æ–­çº¿åå¹³å‡è¦ 5 ç§’æ‰èƒ½é‡æ–°è¿ä¸Šä¸»åº“ã€‚è¿™å°±è‡³å°‘éœ€è¦ 5 MB çš„ç¼“å†²ç©ºé—´ã€‚ å¦åˆ™ï¼Œæ–°å†™çš„å‘½ä»¤å°±ä¼šè¦†ç›–æ‰æ—§æ“ä½œäº†ã€‚ä¸ºäº†åº”å¯¹å¯èƒ½çš„çªå‘å‹åŠ›ï¼Œæˆ‘ä»¬æœ€ç»ˆæŠŠ <code>repl-backlog-size</code> è®¾ä¸º 10 MBã€‚</p> <p>è¿™æ ·ä¸€æ¥ï¼Œå¢é‡å¤åˆ¶æ—¶ä¸»ä»åº“çš„æ•°æ®ä¸ä¸€è‡´é£é™©å°±é™ä½äº†ã€‚ä¸è¿‡ï¼Œå¦‚æœå¹¶å‘è¯·æ±‚é‡éå¸¸å¤§ï¼Œè¿ä¸¤å€çš„ç¼“å†²ç©ºé—´éƒ½å­˜ä¸ä¸‹æ–°æ“ä½œè¯·æ±‚çš„è¯ï¼Œæ­¤æ—¶ï¼Œä¸»ä»åº“æ•°æ®ä»ç„¶å¯èƒ½ä¸ä¸€è‡´ã€‚</p> <blockquote><p>é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œä¸€æ–¹é¢ï¼Œå¯ä»¥æ ¹æ® Redis æ‰€åœ¨æœåŠ¡å™¨çš„å†…å­˜èµ„æºå†é€‚å½“å¢åŠ  repl-backlog-size å€¼ï¼Œæ¯”å¦‚è¯´è®¾ç½®æˆç¼“å†²ç©ºé—´å¤§å°çš„ 4 å€</p> <p>å¦ä¸€æ–¹é¢ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨<strong>åˆ‡ç‰‡é›†ç¾¤</strong>æ¥åˆ†æ‹…å•ä¸ªä¸»åº“çš„è¯·æ±‚å‹åŠ›ã€‚</p></blockquote> <h3 id="replication-buffer-ä¸replication-backlog-buffer"><a href="#replication-buffer-ä¸replication-backlog-buffer" class="header-anchor">#</a> replication_buffer ä¸replication_backlog_buffer</h3> <h4 id="replication-buffer"><a href="#replication-buffer" class="header-anchor">#</a> replication_buffer</h4> <ul><li><p>å¯¹äºå®¢æˆ·ç«¯æˆ–ä»åº“ä¸ Redis é€šä¿¡ï¼ŒRedis éƒ½ä¼šåˆ†é…ä¸€ä¸ªå†…å­˜ buffer è¿›è¡Œæ•°æ®äº¤äº’ã€‚æ‰€æœ‰æ•°æ®äº¤äº’éƒ½æ˜¯é€šè¿‡è¿™ä¸ªbufferè¿›è¡Œçš„ã€‚Rediså…ˆæŠŠæ•°æ®å†™å…¥è¿™ä¸ªbufferä¸­ï¼Œç„¶åå†æŠŠbufferä¸­çš„æ•°æ®å‘åˆ° <code>client socket</code> ä¸­å†é€šè¿‡ç½‘ç»œå‘é€å‡ºå»ï¼Œè¿™æ ·å°±å®Œæˆäº†æ•°æ®äº¤äº’ã€‚</p></li> <li><p>æ‰€ä»¥ä¸»ä»åœ¨å¢é‡åŒæ­¥æ—¶ï¼Œä»åº“ä½œä¸ºä¸€ä¸ªclientï¼Œä¹Ÿä¼šåˆ†é…ä¸€ä¸ªbufferï¼Œåªä¸è¿‡è¿™ä¸ªbufferä¸“é—¨ç”¨æ¥ä¼ æ’­ç”¨æˆ·çš„å†™å‘½ä»¤åˆ°ä»åº“ï¼Œä¿è¯ä¸»ä»æ•°æ®ä¸€è‡´ã€‚æˆ‘ä»¬é€šå¸¸æŠŠå®ƒå«åš <code>Replication Buffer</code>ã€‚</p></li> <li><p>Redis é€šè¿‡<code>client-output-buffer-limit</code> å‚æ•°è®¾ç½®è¿™ä¸ªbufferçš„å¤§å°ã€‚ä¸»åº“ä¼šç»™æ¯ä¸ªä»åº“å»ºç«‹ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œæ‰€ä»¥ <code>replication buffer</code> ä¸æ˜¯å…±äº«çš„ï¼Œè€Œæ˜¯æ¯ä¸ªä»åº“éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„å®¢æˆ·ç«¯ã€‚</p></li></ul> <blockquote><p>å¦‚æœä¸»ä»åœ¨ä¼ æ’­å‘½ä»¤æ—¶ï¼Œå› ä¸ºæŸäº›åŸå› ä»åº“å¤„ç†å¾—éå¸¸æ…¢ï¼Œé‚£ä¹ˆä¸»åº“ä¸Šçš„è¿™ä¸ªbufferå°±ä¼šæŒç»­å¢é•¿ï¼Œæ¶ˆè€—å¤§é‡çš„å†…å­˜èµ„æºï¼Œç”šè‡³OOMã€‚</p> <p>æ‰€ä»¥Redisæä¾›äº†<code>client-output-buffer-limit</code>å‚æ•°é™åˆ¶è¿™ä¸ªbufferçš„å¤§å°ï¼Œå¦‚æœè¶…è¿‡é™åˆ¶ï¼Œä¸»åº“ä¼šå¼ºåˆ¶æ–­å¼€è¿™ä¸ªclientçš„è¿æ¥ï¼Œ</p> <p>ä¹Ÿå°±æ˜¯è¯´ä»åº“å¤„ç†æ…¢å¯¼è‡´ä¸»åº“å†…å­˜bufferçš„ç§¯å‹è¾¾åˆ°é™åˆ¶åï¼Œä¸»åº“ä¼šå¼ºåˆ¶æ–­å¼€ä»åº“çš„è¿æ¥ï¼Œ</p> <p>æ­¤æ—¶ä¸»ä»å¤åˆ¶ä¼šä¸­æ–­ï¼Œä¸­æ–­åå¦‚æœä»åº“å†æ¬¡å‘èµ·å¤åˆ¶è¯·æ±‚ï¼Œé‚£ä¹ˆæ­¤æ—¶å¯èƒ½ä¼šå¯¼è‡´æ¶æ€§å¾ªç¯ï¼Œå¼•å‘å¤åˆ¶é£æš´ï¼Œè¿™ç§æƒ…å†µéœ€è¦æ ¼å¤–æ³¨æ„ã€‚</p></blockquote> <h4 id="replication-backlog-buffer"><a href="#replication-backlog-buffer" class="header-anchor">#</a> replication_backlog_buffer</h4> <p>å’Œ <code>replication_buffer</code> ä¸ä¸€æ ·ï¼Œ<code>repl_backlog_buffer</code> æ˜¯æ‰€æœ‰ä»åº“å…±äº«çš„ï¼Œ<code>slave_repl_offset</code> ç”±ä»åº“è‡ªå·±è®°å½•çš„ï¼Œè¿™ä¹Ÿæ˜¯å› ä¸ºæ¯ä¸ªä»åº“çš„å¤åˆ¶è¿›åº¦ä¸ä¸€å®šç›¸åŒã€‚ä»åº“æ–­è¿åå†æ¢å¤æ—¶ï¼Œä¼šç»™ä¸»åº“å‘é€ <code>psync</code> å‘½ä»¤ï¼Œå¹¶æŠŠè‡ªå·±å½“å‰çš„<code>slave_repl_offset</code> å‘ç»™ä¸»åº“ã€‚<code>slave_repl_offset</code> æŒ‡å‘çš„æ•°æ®æ²¡æœ‰è¢«è¦†ç›–ï¼Œå°±èƒ½ç»§ç»­æ¢å¤ã€‚å¦‚æœä»åº“æ–­å¼€æ—¶é—´è¿‡é•¿ï¼Œ<code>repl_backlog_buffer</code>ç¯å½¢ç¼“å†²åŒºä¼šè¢«ä¸»åº“çš„å†™å‘½ä»¤è¦†ç›–ï¼Œé‚£ä¹ˆä»åº“é‡è¿ååªèƒ½å…¨é‡åŒæ­¥ã€‚</p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/hnistzdk/my-notes/edit/master/docs/03.æ•°æ®åº“/10.Redis/09.Redisé›†ç¾¤-ä¸»ä»æ¨¡å¼.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/my-notes/tags/?tag=Redis" title="æ ‡ç­¾">#Redis</a><a href="/my-notes/tags/?tag=Redis%E4%B8%BB%E4%BB%8E" title="æ ‡ç­¾">#Redisä¸»ä»</a><a href="/my-notes/tags/?tag=Redis%E9%9B%86%E7%BE%A4" title="æ ‡ç­¾">#Redisé›†ç¾¤</a></div> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°:</span> <span class="time">2022/10/04, 8:10:00</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/my-notes/redis/persistence/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">RedisæŒä¹…åŒ–æœºåˆ¶</div></a> <a href="/my-notes/redis/sentinel/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Redisé«˜å¯ç”¨-å“¨å…µæœºåˆ¶</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/my-notes/redis/persistence/" class="prev">RedisæŒä¹…åŒ–æœºåˆ¶</a></span> <span class="next"><a href="/my-notes/redis/sentinel/">Redisé«˜å¯ç”¨-å“¨å…µæœºåˆ¶</a>â†’
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:369365576@qq.com" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/hnistzdk" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/hnistzdk" title="GitHub" target="_blank" class="iconfont icon-gitee"></a><a href="http://music.163.com/playlist?id=936642760&amp;userid=604011130" title="æ™®é€šæ­Œå•" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2022-2023
    <span>zdk | notes <br><a href=http://beian.miit.gov.cn/>æ¹˜ICPå¤‡2022001117å·-1</a><br><img src=/img/ghs.png /><a href=http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=51142102511562>å·å…¬ç½‘å®‰å¤‡ 51142102511562å·</a><br><a href=https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referra><img src=/img/upyun.png align=absmiddle width=70px height=30px /></a> <span> æä¾›åŠ é€ŸæœåŠ¡ </span></span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div id="goTop" class="hide-cat" data-v-bf92849a></div><div></div><div></div></div></div>
    <script src="/my-notes/assets/js/app.7f931ee0.js" defer></script><script src="/my-notes/assets/js/2.e52a17f8.js" defer></script><script src="/my-notes/assets/js/85.73902eef.js" defer></script><script src="/my-notes/assets/js/6.bcc16901.js" defer></script>
  </body>
</html>
